<!DOCTYPE html>
<!-- saved from url=(0052)https://juejin.cn/post/6844904119723884551#heading-9 -->
<html lang="zh"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>iOS内存二三事 - 掘金</title><meta data-n-head="ssr" name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, viewport-fit=cover"><meta data-n-head="ssr" name="apple-itunes-app" content="app-id=987739104"><meta data-n-head="ssr" name="theme-color" content="#ffffff"><meta data-n-head="ssr" name="msapplication-TileColor" content="#da532c"><meta data-n-head="ssr" vmid="description" name="description" content="Page In/Out和 Swap In/Out 概念类似，只不过Page In/Out是将某些页的数据写到内存/从内存写回磁盘交互区；而Swap In/Out是将整个地址空间的数据写到内存/从内存写回磁盘交互区；本质都是交互机制。 通用的计算机（大型机和专用计算机不在此范围）…"><meta data-n-head="ssr" vmid="keywords" name="keywords" content="iOS"><link data-n-head="ssr" rel="preconnect" href="https://unpkg.byted-static.com/" crossorigin="anonymous"><link data-n-head="ssr" rel="preconnect" href="https://lf3-cdn-tos.bytescm.com/" crossorigin="anonymous"><link data-n-head="ssr" rel="preconnect" href="https://mcs.snssdk.com/" crossorigin="anonymous"><link data-n-head="ssr" rel="preconnect" href="https://i.snssdk.com/" crossorigin="anonymous"><link data-n-head="ssr" rel="dns-prefetch" href="https://lf3-short.ibytedapm.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://lf3-cdn-tos.bytescm.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://api.juejin.cn/"><link data-n-head="ssr" rel="dns-prefetch" href="https://lf-cdn-tos.bytescm.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://unpkg.byted-static.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p1-juejin.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p3-juejin.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p6-juejin.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p9-juejin.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p1-jj.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p2-jj.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p6-jj.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p9-jj.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://mcs.snssdk.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://i.snssdk.com/"><link data-n-head="ssr" rel="apple-touch-icon" sizes="180x180" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/favicons/apple-touch-icon.png"><link data-n-head="ssr" rel="icon" type="image/png" sizes="32x32" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/favicons/favicon-32x32.png"><link data-n-head="ssr" rel="icon" type="image/png" sizes="16x16" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/favicons/favicon-16x16.png"><link data-n-head="ssr" rel="mask-icon" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/favicons/safari-pinned-tab.svg" color="#1E80FF"><link data-n-head="ssr" rel="manifest" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/favicons/site.webmanifest"><link data-n-head="ssr" rel="search" title="掘金" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/search.xml" type="application/opensearchdescription+xml"><link data-n-head="ssr" rel="stylesheet" href="./iOS内存二三事 - 掘金_files/bytedesign.min.css"><link data-n-head="ssr" rel="canonical" href="https://juejin.cn/post/6844904119723884551"><script data-n-head="ssr" type="text/javascript" src="./iOS内存二三事 - 掘金_files/acrawler.js"></script><script data-n-head="ssr" vmid="slardar" type="text/javascript" crossorigin="anonymous">;(function (w, d, u, b, n, pc, ga, ae, po, s, p, e, t, pp) {pc = 'precollect';ga = 'getAttribute';ae = 'addEventListener';po = 'PerformanceObserver';s = function (m) {p = [].slice.call(arguments);p.push(Date.now(), location.href);(m == pc ? s.p.a : s.q).push(p)};s.q = [];s.p = { a: [] };w[n] = s;e = document.createElement('script');e.src = u + '?bid=' + b + '&globalName=' + n;e.crossOrigin = u.indexOf('sdk-web') > 0 ? 'anonymous' : 'use-credentials';d.getElementsByTagName('head')[0].appendChild(e);if (ae in w) {s.pcErr = function (e) {e = e || w.event;t = e.target || e.srcElement;if (t instanceof Element || t instanceof HTMLElement) {if (t[ga]('integrity')) {w[n](pc, 'sri', t[ga]('href') || t[ga]('src'))} else {w[n](pc, 'st', { tagName: t.tagName, url: t[ga]('href') || t[ga]('src') })}} else {w[n](pc, 'err', e.error || e.message)}};s.pcRej = function (e) {e = e || w.event;w[n](pc, 'err', e.reason || (e.detail && e.detail.reason))};w[ae]('error', s.pcErr, true);w[ae]('unhandledrejection', s.pcRej, true);};if('PerformanceLongTaskTiming' in w) {pp = s.pp = { entries: [] };pp.observer = new PerformanceObserver(function (l) {pp.entries = pp.entries.concat(l.getEntries())});pp.observer.observe({ entryTypes: ['longtask', 'largest-contentful-paint','layout-shift'] })}})(window,document,'https://lf3-short.ibytedapm.com/slardar/fe/sdk-web/browser.cn.js','2608','SlardarWeb')</script><script src="./iOS内存二三事 - 掘金_files/browser.cn.js" crossorigin="anonymous"></script><script data-n-head="ssr" type="text/javascript" src="./iOS内存二三事 - 掘金_files/imageReport.js"></script><script data-n-head="ssr" type="application/ld+json">[{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://juejin.cn/post/6844904119723884551"},"headline":"iOS内存二三事","description":"Page In/Out和 Swap In/Out 概念类似，只不过Page In/Out是将某些页的数据写到内存/从内存写回磁盘交互区；而Swap In/Out是将整个地址空间的数据写到内存/从内存写回磁盘交互区；本质都是交互机制。 通用的计算机（大型机和专用计算机不在此范围）…","image":[],"author":{"@type":"Organization","name":"南华Coder"},"publisher":{"@type":"Organization","name":"掘金","logo":{"@type":"ImageObject","url":"//lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web/e08da34488b114bd4c665ba2fa520a31.svg"}},"datePublished":"2020年04月09日","dateModified":"2020年08月31日"},{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","name":"稀土掘金","position":1,"item":"https://juejin.cn"},{"@type":"ListItem","name":"iOS","position":2,"item":"https://juejin.cn/ios"},{"@type":"ListItem","name":"文章","position":3}]}]</script><link rel="preload" href="./iOS内存二三事 - 掘金_files/6ccc1bf.js" as="script"><link rel="preload" href="./iOS内存二三事 - 掘金_files/83d184c.js" as="script"><link rel="preload" href="./iOS内存二三事 - 掘金_files/6a0af43.js" as="script"><link rel="preload" href="./iOS内存二三事 - 掘金_files/app.c95707c.css" as="style"><link rel="preload" href="./iOS内存二三事 - 掘金_files/6e787e2.js" as="script"><link rel="preload" href="./iOS内存二三事 - 掘金_files/default.c3d25dd.css" as="style"><link rel="preload" href="./iOS内存二三事 - 掘金_files/c68ae6a.js" as="script"><link rel="preload" href="./iOS内存二三事 - 掘金_files/52.39cb9d6.css" as="style"><link rel="preload" href="./iOS内存二三事 - 掘金_files/607e9aa.js" as="script"><link rel="preload" href="./iOS内存二三事 - 掘金_files/197.8de3951.css" as="style"><link rel="preload" href="./iOS内存二三事 - 掘金_files/fe8610f.js" as="script"><link rel="preload" href="./iOS内存二三事 - 掘金_files/198.adcadde.css" as="style"><link rel="preload" href="./iOS内存二三事 - 掘金_files/37aab1f.js" as="script"><link rel="stylesheet" href="./iOS内存二三事 - 掘金_files/app.c95707c.css"><link rel="stylesheet" href="./iOS内存二三事 - 掘金_files/default.c3d25dd.css"><link rel="stylesheet" href="./iOS内存二三事 - 掘金_files/52.39cb9d6.css"><link rel="stylesheet" href="./iOS内存二三事 - 掘金_files/197.8de3951.css"><link rel="stylesheet" href="./iOS内存二三事 - 掘金_files/198.adcadde.css">
  <script charset="utf-8" src="./iOS内存二三事 - 掘金_files/3f2c049.js"></script><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/e5d3ec2.js"></script><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/41b8609.js"></script><link rel="preload" as="style" href="./iOS内存二三事 - 掘金_files/4.4ebc7e8.css"><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/929f319.js"></script><link rel="preload" as="style" href="./iOS内存二三事 - 掘金_files/139.9ccface.css"><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/45c0ab1.js"></script><link rel="preload" as="style" href="./iOS内存二三事 - 掘金_files/181.1b801b1.css"><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/37ac484.js"></script><link rel="preload" as="style" href="./iOS内存二三事 - 掘金_files/192.1dc0908.css"><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/7745e43.js"></script><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/452761f.js"></script><link rel="preload" as="style" href="./iOS内存二三事 - 掘金_files/158.cb7fed2.css"><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/a217112.js"></script><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/228a585.js"></script><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/16a9736.js"></script><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/7183dda.js"></script><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/e0132cd.js"></script><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/fea69cf.js"></script><style type="text/css">.code-editor-container{display:block;position:relative;overflow:hidden;box-sizing:border-box;}iframe.code-editor-frame{width:100%;height:100%;border:none;border-radius:8px;box-sizing:border-box;border:0.5px solid rgba(128,128,128,0.4);}</style><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/25dbe16.js"></script><style type="text/css">.medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}</style><script src="./iOS内存二三事 - 掘金_files/common-monitors.1.5.1.js" crossorigin="anonymous"></script><link rel="preload" as="style" href="./iOS内存二三事 - 掘金_files/100.b5554a0.css"><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/c51d9f0.js"></script><link rel="preload" as="style" href="./iOS内存二三事 - 掘金_files/155.cc4a86e.css"><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/385b17a.js"></script><link rel="preload" as="style" href="./iOS内存二三事 - 掘金_files/9.b3ecb8a.css"><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/5a9f17f.js"></script><link rel="preload" as="style" href="./iOS内存二三事 - 掘金_files/88.9843b4c.css"><script charset="utf-8" src="./iOS内存二三事 - 掘金_files/9ba0270.js"></script></head>
  <body data-new-gr-c-s-check-loaded="14.1098.0" data-gr-ext-installed="">
    <div id="__nuxt"><div id="__layout"><div id="juejin"><!----> <div class="view-container" data-v-4b9f9746="" data-v-1c9ebbff=""><div class="main-header-box" data-v-4b9f9746=""><header data-fetch-key="0" class="main-header main-header visible" data-v-ec958a82="" data-v-4b9f9746="" visible="visible"><div class="container" data-v-ec958a82=""><a href="https://juejin.cn/" class="logo" data-v-ec958a82=""><img src="./iOS内存二三事 - 掘金_files/e08da34488b114bd4c665ba2fa520a31.svg" alt="稀土掘金" class="logo-img" data-v-ec958a82=""> <img src="./iOS内存二三事 - 掘金_files/6c61ae65d1c41ae8221a670fa32d05aa.svg" alt="稀土掘金" class="mobile" data-v-ec958a82=""></a> <!----> <!----> <nav role="navigation" class="main-nav" data-v-ec958a82=""><ul class="nav-list" data-v-ec958a82=""><!----> <li class="main-nav-list" data-v-ec958a82=""><div class="phone-show-menu isResourceVisible" data-v-ec958a82=""><span data-v-ec958a82="">首页</span> <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" class="unfold16-icon" data-v-ec958a82=""><path d="M2.45025 4.82431C2.17422 4.49957 2.40501 4.00049 2.83122 4.00049H9.16878C9.59498 4.00049 9.82578 4.49957 9.54975 4.82431L6.38097 8.55229C6.1813 8.78719 5.8187 8.78719 5.61903 8.55229L2.45025 4.82431Z" data-v-ec958a82=""></path></svg></div> <ul class="phone-hide isResourceVisible" data-v-ec958a82=""><li class="nav-item link-item route-active" data-v-ec958a82=""><a href="https://juejin.cn/" data-v-ec958a82="">首页</a></li> <li class="nav-item link-item activities" data-v-ec958a82=""><a href="https://juejin.cn/pins" data-v-ec958a82=""><span class="text" data-v-ec958a82="">
                  沸点
                  </span></a></li> <li class="nav-item link-item book" data-v-ec958a82=""><a href="https://juejin.cn/course" data-v-ec958a82="">
                课程
                <span data-v-ec958a82="" class="tablead">
                    上新
                  </span></a></li> <li class="nav-item link-item" data-v-ec958a82=""><a href="https://juejin.cn/live" data-v-ec958a82="">直播</a></li> <li class="nav-item link-item" data-v-ec958a82=""><a href="https://juejin.cn/events/all" data-v-ec958a82="">活动</a></li> <li class="nav-item link-item" data-v-ec958a82=""><a href="https://juejin.cn/challenge" data-v-ec958a82="">
                竞赛
                </a></li> <nav class="nav-item link-item" data-v-ec958a82=""><a href="https://detail.youzan.com/show/goods/newest?kdt_id=104340304" target="_blank" rel="nofollow noopener noreferrer" class="nav-item link-item no-border" data-v-ec958a82=""><span data-v-ec958a82="">商城</span></a> <!----></nav> <nav class="nav-item link-item download-icon isResourceVisible" data-v-ec958a82=""><a href="https://juejin.cn/app?utm_source=jj_nav" target="_blank" class="download-app no-border" data-v-ec958a82="">
                APP
              </a> <span data-v-ec958a82="" class="tablead">邀请有礼</span></nav> <nav class="nav-item link-item extension-icon" data-v-ec958a82=""><a href="https://juejin.cn/extension?utm_source=jj_nav" target="_blank" rel="nofollow noopener noreferrer" class="broswer-extension no-border isResourceVisible" data-v-ec958a82=""><span data-v-ec958a82="">插件</span></a></nav> <li tag="li" class="nav-item link-item" data-v-ec958a82=""><a target="_blank" href="https://juejin.cn/vip?utm_source=web_nav" class="activity no-hover special-activity" data-v-ec958a82=""><img data-v-248050e4="" data-v-ec958a82="" src="./iOS内存二三事 - 掘金_files/7482b3ad2cd14edda31f05399c2ae759_tplv-k3u1fbpfcp-no-mark_288_288_288_0.awebp" alt="image" class="lazy" loading="lazy" style="max-width: 115px; vertical-align: middle;"></a></li></ul></li> <ul class="right-side-nav" data-v-ec958a82=""><li class="search-add" data-v-ec958a82=""><ul class="search-add-ul isResourceVisible" data-v-ec958a82=""><li class="nav-item search" data-v-ec958a82=""><form role="search" class="search-form isResourceVisible" data-v-ec958a82=""><input type="search" maxlength="32" placeholder="探索稀土掘金" value="" class="search-input isResourceVisible" data-v-ec958a82=""> <div class="seach-icon-container" data-v-ec958a82=""><img src="./iOS内存二三事 - 掘金_files/1e8ab9a22f0ddc36349f60b38900d0bd.svg" alt="搜索" class="search-icon" data-v-ec958a82=""></div> <div class="typehead" style="display:none;" data-v-ec958a82=""><!----> <div class="title" data-v-ec958a82=""><span data-v-ec958a82="">搜索历史</span> <span class="clear" data-v-ec958a82="">
                        清空
                      </span></div> <div class="list" data-v-ec958a82=""><div data-v-ec958a82="">
                        iOS 图片的优化
                      </div><div data-v-ec958a82="">
                        图片的优化
                      </div></div></div></form></li> <li class="nav-item add creator-item" data-v-ec958a82=""><div class="add-group" data-v-0a54c80a="" data-v-ec958a82=""><svg data-v-0a54c80a="" width="38" height="20" viewBox="0 0 38 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="update-icon"><rect data-v-0a54c80a="" y="1" width="38" height="16" rx="8" fill="#F53F3F"></rect><path data-v-0a54c80a="" d="M7.5 7.93H11.47V9.02H7.5V7.93ZM11.47 9.65V10.71H7.5V9.65H11.47ZM11.47 11.34V12.48C11.47 12.72 11.34 12.84 11.08 12.84C10.75 12.84 10.39 12.82 10.01 12.8L10.19 13.46H11.31C11.87 13.44 12.15 13.19 12.15 12.7V7.3H7.51C7.75 6.93 7.96 6.54 8.16 6.14H13.43V5.44H8.46C8.6 5.09 8.72 4.73 8.84 4.36L8.11 4.27C7.99 4.66 7.84 5.05 7.67 5.44H4.69V6.14H7.34C6.65 7.43 5.68 8.57 4.42 9.57L4.89 10.18C5.61 9.6 6.26 8.95 6.82 8.25V13.48H7.5V11.34H11.47ZM14.72 4.73V5.4H18.64V6.27H15.58V10.23H18.51C18.41 10.75 18.23 11.18 17.99 11.52C17.43 11.23 16.91 10.89 16.44 10.5L15.89 10.88C16.38 11.3 16.92 11.67 17.5 11.99C16.86 12.45 15.84 12.73 14.45 12.84L14.76 13.5C16.35 13.32 17.5 12.94 18.2 12.34C19.69 13.02 21.44 13.41 23.45 13.49L23.63 12.8C21.71 12.74 20.05 12.41 18.65 11.82C18.93 11.42 19.12 10.89 19.24 10.23H22.46V6.27H19.36V5.4H23.29V4.73H14.72ZM21.75 9.6H19.33L19.36 8.89V8.54H21.75V9.6ZM18.61 9.6H16.29V8.54H18.64V8.89C18.64 9.13 18.63 9.37 18.61 9.6ZM16.29 7.94V6.89H18.64V7.94H16.29ZM19.36 6.89H21.75V7.94H19.36V6.89ZM32.94 4.43C31.97 4.85 30.88 5.08 29.67 5.1V9.38C29.62 10.9 29.3 12.09 28.71 12.95L29.22 13.49C29.94 12.47 30.32 11.1 30.37 9.38V8.19H31.85V13.53H32.56V8.19H33.6V7.5H30.37V5.68C31.45 5.62 32.42 5.41 33.3 5.07L32.94 4.43ZM24.61 5.2V5.86H29.12V5.2H27.23C27.09 4.84 26.95 4.51 26.8 4.21L26.06 4.33C26.23 4.59 26.38 4.88 26.52 5.2H24.61ZM24.51 7.47V8.12H26.53V9.24H24.67V9.9H26.53V12.56C26.53 12.8 26.4 12.92 26.14 12.92C26 12.92 25.85 12.9 25.69 12.87L25.84 13.54H26.38C26.96 13.54 27.25 13.27 27.25 12.73V9.9H29.01V9.24H27.25V8.12H29.18V7.47H28.05C28.24 7.13 28.41 6.74 28.57 6.31L27.92 6.09C27.77 6.57 27.6 7.03 27.4 7.47H26.3C26.14 6.93 25.96 6.48 25.77 6.11L25.13 6.34C25.33 6.69 25.51 7.07 25.66 7.47H24.51ZM25.37 10.44C25.15 11.32 24.81 12.12 24.34 12.84L24.94 13.22C25.4 12.47 25.77 11.59 26.03 10.58L25.37 10.44ZM28.24 10.37L27.64 10.53C27.92 11.13 28.15 11.75 28.34 12.38L28.94 12.15C28.78 11.61 28.54 11.02 28.24 10.37Z" fill="white"></path><path data-v-0a54c80a="" d="M18.8284 14L21.6568 16.8284L19.1112 19.374C18.955 19.5302 18.7017 19.5302 18.5455 19.374L15.9999 16.8284L18.8284 14Z" fill="#F53F3F"></path></svg> <button class="add-btn" data-v-0a54c80a="">
    创作者中心
  </button> <div class="more" data-v-0a54c80a=""><svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" class="unfold12-icon" data-v-0a54c80a=""><path d="M2.45025 4.82383C2.17422 4.49908 2.40501 4 2.83122 4H9.16878C9.59499 4 9.82578 4.49908 9.54975 4.82382L6.38097 8.5518C6.1813 8.7867 5.8187 8.7867 5.61903 8.5518L2.45025 4.82383Z" fill="white" data-v-0a54c80a=""></path></svg></div> <ul class="more-list" data-v-0a54c80a=""><li class="item" data-v-0a54c80a=""><span class="icon write-article" data-v-0a54c80a="">写文章</span></li><li class="item" data-v-0a54c80a=""><span class="icon issue-points" data-v-0a54c80a="">发沸点</span></li><li class="item" data-v-0a54c80a=""><span class="icon write-note" data-v-0a54c80a="">写笔记</span></li><li class="item" data-v-0a54c80a=""><span class="icon create-jcode" data-v-0a54c80a="">写代码</span></li><li class="item" data-v-0a54c80a=""><span class="icon drafts" data-v-0a54c80a="">草稿箱</span></li></ul> <!----></div></li></ul></li> <!----> <li class="nav-item vip-entry" data-v-ec958a82=""><div class="vip-title" data-v-ec958a82=""><div class="vip-entry-img" data-v-ec958a82=""><img src="./iOS内存二三事 - 掘金_files/24127194d5b158d7eaf8f09a256c5d01.svg" alt="vip" class="vip-img" data-v-ec958a82=""> </div> <div class="vip-words" data-v-ec958a82="">会员</div></div></li> <li class="nav-item notification" data-v-ec958a82=""><a class="app-link notification-a" data-v-ec958a82="" href="https://juejin.cn/notification"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="notification-icon" data-v-ec958a82=""><path d="M6.01132 10.2856C6.28115 6.54234 8.68619 4.28564 11.9999 4.28564C15.3136 4.28564 17.7186 6.54234 17.9885 10.2856C18.1219 12.1363 18.4093 13.708 19.9473 15.8848C20.1889 16.2267 19.953 16.7142 19.5343 16.7142H4.46546C4.04679 16.7142 3.81092 16.2267 4.05252 15.8848C5.59053 13.708 5.87793 12.1363 6.01132 10.2856Z" stroke-width="1.5" stroke-linecap="round" data-v-ec958a82=""></path><path d="M11.9573 3.21436V4.28578" stroke-width="3" stroke-linecap="round" data-v-ec958a82=""></path><path d="M9.57495 18.8569C9.92795 19.8557 10.8804 20.5712 12.0001 20.5712C13.1197 20.5712 14.0722 19.8557 14.4252 18.8569H9.57495Z" stroke-linecap="round" stroke-linejoin="round" data-v-ec958a82=""></path></svg> <!----></a> <ul class="menu-list notification-dropdown-menu" data-v-4e288a04="" data-v-ec958a82=""><li class="menu-item" data-v-4e288a04=""><a href="https://juejin.cn/notification" class="item-link" data-v-4e288a04=""><span class="item-name" data-v-4e288a04="">评论</span> <!----></a></li><li class="menu-item" data-v-4e288a04=""><a href="https://juejin.cn/notification/digg" class="item-link" data-v-4e288a04=""><span class="item-name" data-v-4e288a04="">点赞</span> <!----></a></li><li class="menu-item" data-v-4e288a04=""><a href="https://juejin.cn/notification/follow" class="item-link" data-v-4e288a04=""><span class="item-name" data-v-4e288a04="">关注</span> <!----></a></li><li class="menu-item" data-v-4e288a04=""><a href="https://juejin.cn/notification/im" class="item-link" data-v-4e288a04=""><span class="item-name" data-v-4e288a04="">私信</span> <!----></a></li><li class="menu-item" data-v-4e288a04=""><a href="https://juejin.cn/notification/system" class="item-link" data-v-4e288a04=""><span class="item-name" data-v-4e288a04="">系统消息</span> <!----></a></li></ul></li>  <li class="nav-item menu" data-v-ec958a82=""><div class="avatar-wrapper" data-v-ec958a82=""><img src="./iOS内存二三事 - 掘金_files/3044413937_100x100.awebp" alt="Leon0206的头像" class="lazy avatar avatar immediate" data-v-248050e4="" data-v-0b45085c="" data-v-ec958a82="" loading="lazy"> <!----></div> <!----></li> <!----></ul></ul></nav></div> <!----></header></div>  <main class="container main-container" style="max-width:1140px;" data-v-4b9f9746=""><div class="view column-view" data-v-4b9f9746="" data-v-1c9ebbff=""><div class="main-area article-area" data-v-4b9f9746="" data-v-1c9ebbff=""><article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="6844904119723884551" data-draft-id="6845076719783641095" data-original-type="0" class="article" data-v-1c9ebbff="" data-v-4b9f9746=""><meta itemprop="url" content="https://juejin.im/post/6844904119723884551"> <meta itemprop="headline" content="iOS内存二三事"> <meta itemprop="keywords" content="iOS"> <meta itemprop="datePublished" content="2020-04-09T15:03:58.000Z"> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="南华Coder"> <meta itemprop="url" content="https://juejin.cn/user/3016715633959592"></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"> <meta itemprop="width" content="180"> <meta itemprop="height" content="180"></div></div> <h1 class="article-title" data-v-1c9ebbff="">
            iOS内存二三事
            <!----></h1> <div class="author-info-block" data-v-1c9ebbff=""><a href="https://juejin.cn/user/3016715633959592" target="_blank" rel="" class="avatar-link" data-v-1c9ebbff=""><img loading="eager" src="./iOS内存二三事 - 掘金_files/1627085161a3210c_tplv-t2oaga2asx-no-mark_100_100_100_100.awebp" alt="" class="lazy avatar avatar" data-v-248050e4="" data-v-0b45085c="" data-v-1c9ebbff=""></a> <div class="author-info-box" data-v-1c9ebbff=""><div class="author-name" data-v-1c9ebbff=""><a href="https://juejin.cn/user/3016715633959592" target="_blank" rel="" class="username username ellipsis" data-v-68a20f0a="" data-v-1c9ebbff=""><span class="name" style="max-width:128px;" data-v-68a20f0a="">
    南华Coder
  </span> <span blank="true" class="rank" data-v-3c1a13dc="" data-v-68a20f0a=""><img src="./iOS内存二三事 - 掘金_files/05be64d75fee4dbdb290ba23afd21fcf_tplv-k3u1fbpfcp-no-mark_0_0_0_0.awebp" alt="lv-4" title="创作等级" class="lazy" style="aspect-ratio:NaN;" data-v-248050e4="" data-v-3c1a13dc="" loading="lazy"></span> <!----> <!----> </a> <!----></div> <div class="meta-box" data-v-1c9ebbff=""><time datetime="2020-04-09T15:03:58.000Z" title="Thu Apr 09 2020 23:03:58 GMT+0800 (China Standard Time)" class="time" data-v-1c9ebbff="">
                    2020年04月09日 23:03
                  </time> <span class="views-count" data-v-1c9ebbff="">
                    ·&nbsp;&nbsp;阅读 6956
                  </span> <!----></div></div> <button class="follow-button follow" data-v-0ed911bc="" data-v-1c9ebbff=""><span class="icon icon-follow" data-v-0ed911bc=""></span> <span data-text="取消关注" class="text" data-v-0ed911bc="">关注</span></button></div> <!----> <!----> <!----> <!----> <div itemprop="articleBody" class="article-content" data-v-1c9ebbff=""><div class="markdown-body cache html"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;margin-bottom:5px}.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{font-size:20px}.markdown-body h2{padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre>code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote>p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><p>简单总结下iOS内存方面的一些知识</p>
<h3 data-id="heading-0">一、内存基础概念</h3>
<h4 data-id="heading-1">1、物理内存 &amp; 虚拟内存</h4>
<ul>
<li><strong>物理内存（Physical Memory）</strong>: 指通过物理内存条而获得的内存空间，和虚拟内存对应；主要作用是：设备运行时为操作系统和各种程序提供临时储存空间；iPhone 6 和 6 Plus 及之前都是1G 内存，目前比较新的iPhone XS和XS Max是4GB内存；</li>
<li><strong>虚拟内存(Virtual Memory)</strong>：是计算机系统内存管理的一种技术，为每一个进程提供了一个<strong>一致的、私有的地址空间</strong>；其主要作用是：保护了每个进程的地址空间不会被其他进程破坏，降低内存管理的复杂性；32位设备虚拟内存大小是4GB，64位设备（5s以后的设备）是 4GB * 4GB；</li>
<li>虚拟内存是进程运行时所有内存空间的总和，并且可能有一部分不在物理内存中；</li>
</ul>
<h4 data-id="heading-2">2、段页式存储</h4>
<ul>
<li>目前，大部分通用的计算机的内存管理使用<strong>段页式存储结构</strong>；用户程序先分段，每个段内再分页；而<strong>页是存储的最基本单位</strong>，iOS设备的arm64架构后，页大小是16KB；</li>
<li>利用<strong>逻辑地址</strong>(段号 + 段内页号 + 页内地址) 进行地址变化，获得物理地址；这样的话，在段页式结构中，须<strong>三次访问</strong>内存才能获取数据或指令；</li>
<li>当进程访问一个虚拟内存的页时，而对应的物理内存却不存在时，会触发一次<strong>Page Fault</strong>（<strong>缺页中断</strong>），将需要的数据 or 指令从磁盘加载到物理内存页中，建立映射关系，然后再恢复现场，程序本身是无感知的；</li>
</ul>
<h4 data-id="heading-3">3、Swap In/Out &amp; Page In/Out</h4>
<ul>
<li>
<p>磁盘内部有一个区域叫做<strong>交换空间</strong>(Swap Space)，MMU(内存管理单元) 会将<strong>暂时不用的内存块内容</strong>写在交互空间上(硬盘)，这就是<strong>Swap Out</strong>；当需要时候再从Swap Space中读取到内存中，这就是<strong>Swap In</strong>；Swap in和swap out的操作都是比较耗时的, 频繁的Swap in和Swap out操作非常影响系统性能；</p>
</li>
<li>
<p><strong>Page In/Out</strong>和 <strong>Swap In/Out</strong> 概念类似，只不过Page In/Out是将<strong>某些页</strong>的数据写到内存/从内存写回磁盘交互区；而Swap In/Out是将<strong>整个地址空间</strong>的数据写到内存/从内存写回磁盘交互区；本质都是交互机制。</p>
</li>
<li>
<p>macOS支持这类交换机制，但是iOS不支持；主要有两方面考虑吧：</p>
<ul>
<li>移动设备的闪存读写次数有限，频繁写会降低寿命；</li>
<li>相比PC机，移动设备闪存空间有限(15年6s最小存储空间16GB、最大128GB；19年XS Max最小64GB，最大521GB)</li>
</ul>
</li>
</ul>
<h4 data-id="heading-4">4、to be continued</h4>
<ul>
<li>通用的计算机（<em>大型机和专用计算机不在此范围</em>）的存储器一般设置为多层，从最靠近CPU的Cache一直到磁盘，速度越来越慢，价格也越来越便宜。</li>
<li>为了充分利用好硬件资源，Cache和Swap机制应运而生，Cache机制是一种用空间换时间的机制；而Swap机制是使用时间换空间的；</li>
<li>但是，iOS系统舍弃交换机制，取而代之的是<strong>压缩内存（Compressed memory）机制</strong>；</li>
</ul>
<h3 data-id="heading-5">二、iOS内存管理基础概念</h3>
<h4 data-id="heading-6">1、iOS的内存分区</h4>
<p>从高地址到低地址各区域如下：</p>
<ul>
<li><strong>栈区(stack)</strong>： 由编译器⾃动分配，存放函数的参数值，局部变量的值等，作用域执行完毕之后，就会被系统收回；(栈区的地址从高到低分配)</li>
<li><strong>堆区(heap)</strong>：一般由程序员分配和释放，用于存放程序运行中被动态分配的内存段；iOS中的Objective-C对象存放在这里，由ARC管理；（堆区的地址是从低到高分配）</li>
<li><strong>全局区静态区</strong>：由编译器分配，主要是存放全局变量 和 静态变量，程序结束后由系统释放；主要分两个区：
<ul>
<li><strong>BSS区</strong>：<strong>未初始化</strong>的全局变量 和 静态变量；</li>
<li><strong>数据区</strong>：<strong>已初始化</strong>的全局变量 和 静态变量；</li>
</ul>
</li>
<li><strong>常量区：</strong> 存放的是常量，如常量字符串，程序结束后由系统释放；</li>
<li><strong>代码区</strong>：存放函数体的二进制代码，程序结束后由系统释放；</li>
</ul>
<p></p><figure><img alt="内存分区示意" src="./iOS内存二三事 - 掘金_files/1715e3aff4615a4d_tplv-t2oaga2asx-zoom-in-crop-mark_4536_0_0_0.image" loading="lazy" class="medium-zoom-image"><figcaption></figcaption></figure><p></p>
<h4 data-id="heading-7">2、内存页类型：Clean和Dirty</h4>
<ul>
<li>
<p>内存页按照各自的<strong>分配和使用</strong>状态，分为 <code>Clean</code> 和 <code>Dirty</code> 两类。其中<code>Clean Page</code>是可以被回收的，<code>Dirty Page</code>不能；</p>
<pre><code lang="c" class="hljs language-c copyable"><span class="hljs-type">int</span> *<span class="hljs-built_in">array</span> = <span class="hljs-built_in">malloc</span>(<span class="hljs-number">20000</span> * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>)); <span class="hljs-comment">// 第1步</span>
<span class="hljs-built_in">array</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">32</span>                             <span class="hljs-comment">// 第2步</span>
<span class="hljs-built_in">array</span>[<span class="hljs-number">19999</span>] = <span class="hljs-number">64</span>                         <span class="hljs-comment">// 第3步</span>
<span class="copy-code-btn">复制代码</span></code></pre></li>
<li>
<p>第一步，申请一块长度为80000 字节的内存空间，按照一页 16KB 来计算，就需要 6 页内存来存储。当这些内存页开辟出来的时候，它们都是 Clean 的；</p>
</li>
<li>
<p>第二步，向处于第一页的内存写入数据时，第一页内存会变成 Dirty；</p>
</li>
<li>
<p>第三步，当向处于最后一页的内存写入数据时，这一页也会变成 Dirty；</p>
</li>
</ul>
<h4 data-id="heading-8">3、VM Region</h4>
<ul>
<li>
<p>iOS进程中所有内存就是由许许多多的<code>VM Region</code>组成的；</p>
</li>
<li>
<p><code>VM Region</code>指<strong>一段连续的内存页（在虚拟地址空间里）</strong>，<a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fopensource.apple.com%2Fsource%2Fxnu%2Fxnu-792%2Fosfmk%2Fmach%2Fvm_region.h" title="https://opensource.apple.com/source/xnu/xnu-792/osfmk/mach/vm_region.h" ref="nofollow noopener noreferrer">VM Region</a>的结构如下</p>
<pre><code lang="arduino" class="hljs language-arduino copyable"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">vm_region_submap_info_64</span> {
	<span class="hljs-type">vm_prot_t</span>		protection;     <span class="hljs-comment">/* present access protection */</span>
	<span class="hljs-type">vm_prot_t</span>		max_protection; <span class="hljs-comment">/* max avail through vm_prot */</span>
	<span class="hljs-type">vm_inherit_t</span>		inheritance;<span class="hljs-comment">/* behavior of map/obj on fork */</span>
	<span class="hljs-type">memory_object_offset_t</span>	offset;		<span class="hljs-comment">/* offset into object/map */</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>            user_tag;	<span class="hljs-comment">/* user tag on map entry */</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>            pages_resident;	<span class="hljs-comment">/* only valid for objects */</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>            pages_shared_now_private; <span class="hljs-comment">/* only for objects */</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>            pages_swapped_out; <span class="hljs-comment">/* only for objects */</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>            pages_dirtied;   <span class="hljs-comment">/* only for objects */</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>            ref_count;	 <span class="hljs-comment">/* obj/map mappers, etc */</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span>          shadow_depth; 	<span class="hljs-comment">/* only for obj */</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>           external_pager;  <span class="hljs-comment">/* only for obj */</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>           share_mode;	<span class="hljs-comment">/* see enumeration */</span>
	<span class="hljs-type">boolean_t</span>		is_submap;	<span class="hljs-comment">/* submap vs obj */</span>
	<span class="hljs-type">vm_behavior_t</span>		behavior;	<span class="hljs-comment">/* access behavior hint */</span>
	<span class="hljs-type">vm_offset_t</span>		object_id;	<span class="hljs-comment">/* obj/map name, not a handle */</span>
	<span class="hljs-type">unsigned</span> <span class="hljs-type">short</span>		user_wired_count; 
};
<span class="copy-code-btn">复制代码</span></code></pre></li>
<li>
<p>VM Region包含的重要信息有：</p>
<ul>
<li><strong>pages_resident</strong>：在用的物理内存页数</li>
<li><strong>pages_dirtied</strong>：Dirty的内存页数</li>
<li><strong>pages_swapped_out</strong>：Swapped的内存页数（<strong>实际指的是被Compressed Memory页数</strong>）</li>
</ul>
</li>
<li>
<p>可以通过了解<strong>pages_dirtied</strong>和<strong>pages_swapped_out</strong>来了解<code>VM Region</code>的真实物理内存使用。</p>
</li>
</ul>
<h3 data-id="heading-9">三、iOS内存管理机制</h3>
<h4 data-id="heading-10">1、OC的内存管理</h4>
<ul>
<li>Objective-C提供两种方式的内存管理方式：<strong>MRC</strong>（手动管理引用计数）和  <strong>ARC</strong>（自动引用计数）</li>
<li>Objective-C内存管理的基本原则：谁创建，谁释放，谁引用，谁管理；</li>
<li>iOS 5之后提出的ARC被广泛接收，毕竟不需要管理引用计数是个很爽的事情；有了ARC，开开心心写OC；但是<strong>ARC只管理Objective-C对象的内存</strong>，CoreFoundation对象、CoreGraphics对象、还有C/C++的内存分配还是需要开发者自己管理。</li>
</ul>
<p></p><figure><img alt="OC的内存管理图" src="./iOS内存二三事 - 掘金_files/1715e39230e29f4a_tplv-t2oaga2asx-zoom-in-crop-mark_4536_0_0_0.image" loading="lazy" class="medium-zoom-image"><figcaption></figcaption></figure><p></p>
<h4 data-id="heading-11">2、系统内存分类</h4>
<p>​	从 iOS7 开始，系统开始采用<code>Compressed Memory</code>机制优化内存使用，内存类型可以分为三类：</p>
<ul>
<li>
<p><code>Clean Memory</code>：可以被释放或重建的，主要包括：</p>
<ul>
<li>Code</li>
<li>framework，每个 framework都有 <code>_DATA_CONST</code> 段，当 App 在运行时使用到了某个 framework，它所对应的 <code>_DATA_CONST</code> 的内存就会由 Clean 变为 Dirty。</li>
<li>memory-mapped files（已被加载到内存中的文件）</li>
</ul>
</li>
<li>
<p><code>Dirty Memory</code>：指那些被写入过数据的内存，主要包括：</p>
<ul>
<li>所有堆区中的对象（Heap allocations）</li>
<li>图像解码缓冲区（Decoded image buffers）</li>
<li>frameworks（framework中 <code>_DATA</code> 段和 <code>_DATA_DIRTY</code> 段）</li>
</ul>
<pre><code lang="arduino" class="hljs language-arduino copyable">	在使用 framework 的过程中会产生Dirty Memory，使用单例或者全局初始化方法是减少Dirty Memory；这是因为单例一旦创建就不会销毁，全局初始化方法会在 <span class="hljs-keyword">class</span> 加载时执行。
<span class="copy-code-btn">复制代码</span></code></pre></li>
<li>
<p><code>Compressed Memory</code>：</p>
<ul>
<li>
<p>在内存吃紧时，系统会将不使用的内存进行压缩(Compresses unaccessed pages)</p>
</li>
<li>
<p>在需要的时候，进行解压 （Decompresses pages upon access）</p>
</li>
<li>
<p>优势：减少了不活跃内存占用；减少磁盘IO带来的损耗；压缩/解压十分迅速，能够尽可能减少 CPU 的时间开销；支持多核操作。</p>
</li>
<li>
<p><strong>举例</strong>：当我们使用 <code>NSDictionary</code> 去缓存数据的时候，假设现在已经使用了 3 页内存，当不访问的时候可能会被压缩为 1 页，再次使用到时候又会解压成 3 页。</p>
</li>
</ul>
</li>
<li>
<p>介绍<code>Clear Memory</code>和 <code>Dirty Memory</code> 的Code如下：</p>
<pre><code lang="ini" class="hljs language-ini copyable">//堆分配的内存 Dirty Memory
NSString *<span class="hljs-attr">str1</span> = [NSString stringWithString:@<span class="hljs-string">"Welcome!"</span>]<span class="hljs-comment">; </span>
//常量字符串, 存放在一个只读数据段里面,这段内存释放后,还可以在读取重建 Clear Memory
NSString *<span class="hljs-attr">str2</span> = @<span class="hljs-string">"Welcome!"</span><span class="hljs-comment">; </span>
//分配100M虚拟内存,当没有用时没有建立映射,Clear Memory
char *<span class="hljs-attr">buf</span> = malloc(<span class="hljs-number">100</span> * <span class="hljs-number">1024</span> *<span class="hljs-number">1024</span>)<span class="hljs-comment">; 关系</span>
for (int <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; 3 * 1024 * 1024; ++i) {</span>
    //写入数据了,Dirty Memory
		buf<span class="hljs-section">[i]</span> = rand()<span class="hljs-comment">;									</span>
}
<span class="copy-code-btn">复制代码</span></code></pre></li>
<li>
<p><strong>说明</strong>：在内存吃紧的情况下，释放<code>Clean Memory</code>，不能释放<code>Dirty Memory</code> ，所以<code>Dirty Memory</code> 的内存越多，App的稳定性越差。</p>
</li>
</ul>
<h4 data-id="heading-12">3、<code>Jetsam</code>机制</h4>
<ul>
<li>
<p>Jetsam机制是操作系统为了控制内存资源过度使用而采用的一种管理机制；Jetsam是一个独立运行的进程，会把一些<strong>优先级不高或者占用内存过大的</strong>App杀掉；在杀掉App后会记录一些数据信息并保存到日志。</p>
</li>
<li>
<p>App优先级可以这么简单理解：前台App &gt; 后台App; 占用内存少 &gt; 占用内存多；</p>
</li>
<li>
<p>Jetsam产生的这些日志可以在<strong>手机设置-&gt;隐私-&gt;分析</strong>中找到，日志是以<code>JetsamEvent</code>开头，日志中有内存页大小(pageSize)，CPU时间(cpuTime)等字段。</p>
</li>
<li>
<p>查看<code>设置-&gt;隐私-&gt;分析</code>中以JetsamEvent开头的系统日志，关注两个重要的信息；</p>
<pre><code lang="json" class="hljs language-json copyable"><span class="hljs-attr">"pageSize"</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">16384</span><span class="hljs-punctuation">,</span>
<span class="hljs-comment">//内存页达到上限</span>
<span class="hljs-attr">"rpages"</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">948</span><span class="hljs-punctuation">,</span>      <span class="hljs-comment">//App 占用的内存页数量</span>
<span class="hljs-attr">"reason"</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">"per-process-limit"</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">//App 占用的内存超过了系统对单个 App 的内存限制。</span>
<span class="copy-code-btn">复制代码</span></code></pre><ul>
<li><strong>说明</strong>：该内存“上限”计算：pageSize <em>rpages = 16384</em> 948 /1024/1014 = 14.8MB，这个App应该是因优先级不高而被强杀，毕竟App内存使用上限不可能不到15MB。</li>
</ul>
</li>
</ul>
<h4 data-id="heading-13">4、内存警告</h4>
<ul>
<li>内存警告（Memory Warning）三种通知方式:
<ul>
<li><strong>UIApplicationDelegate</strong>的<code>applicationDidReceiveMemoryWarning:</code></li>
<li>视图控制器<strong>UIViewController</strong>的<code>didReceiveMemoryWarning</code></li>
<li><strong>UIApplicationDidReceiveMemoryWarningNotification</strong>通知</li>
</ul>
</li>
<li>出现OOM前不一定出现内存警告；有可能是瞬间申请了大量内存，而恰好此时主线程在忙于其他事情，导致可能没有经历过Memory Warning就发生了OOM；也可能即便出现了多次Memory Warning后，也不见得会在最后一次Memory Warning的几秒钟后出现OOM(可能是1-2分钟后)；</li>
<li>并非所有内存警告都是由 App 造成的，例如在内存较小的设备上，当你接听电话的时候也有可能发生内存警告。</li>
</ul>
<h3 data-id="heading-14">四、常见的内存类问题</h3>
<h4 data-id="heading-15">1、FOOM</h4>
<ul>
<li>
<p>FOOM（Foreground Out Of Memory），是指App<strong>在前台</strong>因消耗内存过多引起系统强杀。对用户而言，表现跟Crash一样。</p>
</li>
<li>
<p>Facebook早在2015年8月提出FOOM检测办法，大致原理是排除各种情况后，剩余的情况是FOOM；Facebook如何判定上一次启动是否出现FOOM方法：</p>
<ul>
<li>1.App没有升级</li>
<li>2.App没有调用exit()或abort()退出</li>
<li>3.App没有出现Crash (依赖于自身CrashReport组件的Crash回调)</li>
<li>4.用户没有强退App</li>
<li>5.系统没有升级/重启</li>
<li>6.App当时没有后台运行（依赖于ApplicationState和前后台切换通知）</li>
<li>7.App出现FOOM （依赖于ApplicationState和前后台切换通知）</li>
</ul>
</li>
<li>
<p>排查法有误报的可能，因为有些被系统强杀case，但是我们捕获不到信息，也可能被归类到OOM；已知被系统强杀的case是：OOM和watchdog(Code 0x8badf00d)。</p>
</li>
<li>
<p>发现FOOM问题的关键：监控App使用内存增长，在收到内存警告通知时，dump 内存信息，获取对象名称、对象个数、各对象的内存值，并在合适的时机上报到服务器；加强对大内存的分配监控。</p>
</li>
</ul>
<h4 data-id="heading-16">2、内存泄露</h4>
<ul>
<li>
<p>内存泄露(Memory Leak)：指申请的内存空间使用完毕之后<strong>未回收</strong>，内存泄露问题多的话，对App质量影响很大；</p>
</li>
<li>
<p>目前引起内存泄露的主要原因是循环引用(堆内存中对象相互引用，彼此都得不到释放的机会)，目前，调试阶段使用Instrument的Leaks工具发现，线上利用MLeaksFinder发现后上报；</p>
</li>
<li>
<p>如何避免内存泄露在后面有介绍</p>
</li>
</ul>
<h4 data-id="heading-17">3、WKWebview白屏</h4>
<ul>
<li>
<p>WKWebview白屏问题，严格来说，是一种内存方面的问题；之前的UIWebview因为内存使用过大会Crash，而WKWebview不会Crash，会白屏；</p>
</li>
<li>
<p>WKWebView是一个多进程组件，<code>Network Loading</code>以及<code>UI Rendering</code>在其它进程中执行，当WKWebView总体的内存占用比较大时，<code>WebContent Process</code>会Crash，从而出现白屏现象。</p>
</li>
<li>
<p><strong>解决办法</strong>：</p>
<ul>
<li>
<p>KVO监听URL, 当URL为nil，重新reload</p>
</li>
<li>
<p>在进程被终止回调中，重新reload</p>
<pre><code lang="javascript" class="hljs language-javascript copyable"><span class="hljs-comment">// 此方法适用iOS9.0以上 </span>
- (<span class="hljs-keyword">void</span>)<span class="hljs-attr">webViewWebContentProcessDidTerminate</span>:(<span class="hljs-title class_">WKWebView</span> *)webView <span class="hljs-title function_">NS_AVAILABLE</span>(<span class="hljs-params"><span class="hljs-number">10_11</span>, <span class="hljs-number">9_0</span></span>){
		<span class="hljs-comment">//reload</span>
}
<span class="copy-code-btn">复制代码</span></code></pre></li>
</ul>
</li>
</ul>
<h4 data-id="heading-18">4、野指针问题</h4>
<ul>
<li>
<p><strong>野指针</strong>：指向一个已删除的对象 或 受限内存区域的指针；目前此类问题很少了，主要来自两个方面</p>
<ul>
<li>MRC时代 到 ARC时代，OC对象管理极大方便了，ARC解决大部分野指针问题</li>
<li>iOS 9开始，系统库中部分遗留的被<code>assign(unsafe_unretain)</code>修饰的 <code>delegate</code>和<code>target-action</code>修改成了weak，内存被回收的时候，这些指针设为nil，这也大幅度减少了野指针的出现。</li>
</ul>
</li>
<li>
<p>目前绝大部分App都是iOS 9起步，野指针少了很多，但是工程中依然会有野指针问题，本质还是内存使用不当；</p>
</li>
<li>
<p><code>Mach Exception</code>大多数都是野指针的问题，崩溃日志里最多见<code>objc_msgSend</code>和<code>unrecognized selector sent to</code>等等。</p>
</li>
<li>
<p>对于野指针问题，最好能复现，使用<code>Zombie Object</code> 帮助调试，<code>Zombie Object</code> 实现原理就是 hook 住了对象的<code>dealloc</code>方法，通过调用自己的<code>__dealloc_zombie</code>方法来把对象进行僵尸化，当这个对象再次收到消息,<code>objc_msgsend</code>的时候，调用abort()崩溃并打印出调用的方法。。</p>
</li>
</ul>
<blockquote>
<p><strong>iOS 9以后NSNotificationCenter不需要手动移除观察者</strong></p>
<ul>
<li>在iOS9之前，通知中心使用 <strong>unsafe_unretained</strong>修饰引用观察者，如果观察者被回收时，若不手动移除，指针会指向被回收的内存区域，变为野指针，如果再发送消息会造成Crash；</li>
<li>而iOS 9之后，通知中心使用<strong>weak</strong>修饰引用观察者 ，即使不手动移除观察者，weak指针也会在观察者被回收后自动置nil。之后发送消息，是不会有问题的。</li>
</ul>
</blockquote>
<h4 data-id="heading-19">5、iOS 10 nano_free Crash</h4>
<ul>
<li>
<p>在iOS 10.0 - 10.1，苹果bug引入nano_free Crash问题，这些Crash发生<code>libsystem_malloc.dylib</code>中的 <code>nano zone</code>内的；</p>
</li>
<li>
<p><code>libsystem_malloc.dylib</code>中，对内存的管理有两个实现：<code>nano zone</code>和<code>scalable zone</code>。他们分别管理不同大小的内存块：</p>
<ul>
<li>内存分配函数malloc和calloc等默认使用的是nano_zone，nao_zone是 256B 以下小内存的分配，</li>
<li>大于 256B 的时候会使用 <strong>scalable_zone</strong> 来分配。</li>
</ul>
</li>
<li>
<p>当时微信团队提出的几种解决思路，最后给的解决方案是<strong>不使用nano zone</strong>，具体描述</p>
<ul>
<li>创建一个自己的zone，命名为<code>guard zone</code>。</li>
<li>修改nano zone的函数指针，重定向到guard zone(通过<code>malloc_zone_create</code>创建的)。
<ul>
<li>对于没有传入指针的函数，直接重定向到guard zone</li>
<li>对于有传入指针的函数，先用size判断所属的zone，再进行分发。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>更多见：</p>
<ul>
<li><a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fcloud.tencent.com%2Fdeveloper%2Farticle%2F1031006" title="https://cloud.tencent.com/developer/article/1031006" ref="nofollow noopener noreferrer">聊聊苹果的Bug - iOS 10 nano_free Crash</a></li>
<li><a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fopensource.apple.com%2Ftarballs%2Flibmalloc%2F" title="https://opensource.apple.com/tarballs/libmalloc/" ref="nofollow noopener noreferrer">libsystem_malloc.dylib 源码</a></li>
</ul>
</li>
</ul>
<h4 data-id="heading-20">6、to be continued</h4>
<ul>
<li>内存类问题排查难度大，复杂。需要对内存有更深入的理解</li>
<li>为了避免内存问题：根本上是优化内存使用，主要表现在：减少大块内存使用，降低内存峰值，避免内存泄露，处理内存警告;</li>
</ul>
<h3 data-id="heading-21">五、优化内存使用</h3>
<h4 data-id="heading-22">1、降低图片解码和渲染开销</h4>
<ul>
<li>将图片渲染显示在屏幕上，需要先将其解码成位图；而位图大小：<strong>像素高 * 像素宽 * 4字节</strong>(<em>4字节对应一个像素点，4个通道的大小</em>)；图片解码会造成内存使用上升，尤其是高分辨率图解码可能导致内存暴涨；</li>
<li><strong>代码优化建议</strong>：
<ul>
<li>
<p>善待"大"图（位图大小大于60MB）解码：将原图裁剪成多个小图，然后依次绘制到目标位图context中，具体可见SDWebImage中和关于**decodedAndScaledDownImageWithImage:**的实现；</p>
</li>
<li>
<p>限制并发解码图片的个数；</p>
<ul>
<li>图片大小调整和显示大小一样，以此避免重采样(重采样也很消耗资源，放大图像称为上采样/插值（upsamping），缩小图像为小采样（downsampling));</li>
<li>使用 ImageIO直接读取图像大小和元数据信息，减少内存开销。</li>
<li>iOS10后使用 <code>UIGraphicsImageRenderer</code> 创建 image 上下文，而不是<code>UIGraphicsBeginImageContextWithOptions</code>，因为前者的性能更好、更高效，并且支持广色域；</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-23">2、其他降低内存峰值办法</h4>
<ul>
<li>
<p>合理使用<code>autorealsepool</code>，降低内存峰值，避免 OOM</p>
<ul>
<li>基于引用计数,Pool执行drain方法会release所有该Pool中的autorelease对象</li>
<li>可以嵌套多个AutoReleasePool</li>
<li>每个线程并没有设置默认的AutoReleasePool,需要手动创建,避免内存泄露</li>
<li>在一段内存分配频繁的代码中嵌套AutoReleasePool有利于降低整体内存峰值</li>
</ul>
</li>
<li>
<p>复用大内存对象，如UITableViewCell对象；懒加载大的内存对象</p>
</li>
<li>
<p>imageNamed 和 imageWithContentOfFile 的选择</p>
<ul>
<li>imageNamed使用系统缓存，适用于频繁使用的小图片</li>
<li>imageWithContentOfFile不带缓存机制,适用于大图片,使用完就释放</li>
</ul>
</li>
<li>
<p>建议NSData读取文件方式</p>
<ul>
<li>建议使用<code>[NSData dataWithContentsOfFile:path options:NSDataReadingMappedIfSafe error:&amp;error]</code>;</li>
<li>该API映射文件到虚拟内存, 只有读取操作的时候才会读取相应页的内容到物理内存页中；</li>
</ul>
</li>
<li>
<p>用 <code>NSCache</code> 代替 <code>NSMutableDictionary</code>， 因为 <code>NSCache</code> 可以自动清理内存，在内存吃紧的时候会更加合理。</p>
<ul>
<li>NSCache有2种界限条件:totalCostLimt &amp; countLimit，超过这两种界限后系统会去释放一些旧的资源.</li>
<li>监听到内存警告消息后移除所有Cache</li>
</ul>
</li>
<li>
<p>使用 NSPurgableData 代替NSData，主要原因如下：</p>
<ul>
<li>当系统处于低内存的时候会自动移除</li>
<li>适用于大数据</li>
</ul>
</li>
<li>
<p><strong>栈内存分配</strong>：<code>alloca(size_t)</code></p>
<ul>
<li>栈分配仅仅修改栈指针寄存器，比malloc遍历并修改空闲列表要快得多</li>
<li>栈内存一般都已经在物理内存中，不用担心页错误</li>
<li>函数返回的时候栈分配的空间都会自动释放</li>
<li>但仅适合小空间的分配,并且函数嵌套不宜过深</li>
</ul>
</li>
<li>
<p><strong>堆内存分配</strong>：<strong>calloc</strong> <strong>VS</strong> <strong>malloc + memset</strong></p>
<ul>
<li><code>calloc(size_t num,size_t size)</code>分配内存时是虚拟内存，只有在访问的时候才会发生物理页的映射关系；</li>
<li><code>malloc + memset</code> 会产生<code>Dirty Memory</code></li>
<li><code>calloc</code>函数得到的内存空间是经过初始化的，其内容全为0，而<code>malloc</code>函数得到的内存空间是未初始化的，必须使用memset函数来初始化；</li>
</ul>
</li>
</ul>
<h4 data-id="heading-24">3、避免循环引用，减少内存泄露</h4>
<ul>
<li><strong>代码优化建议</strong>
<ul>
<li>申明代理(delegate)为weak；</li>
<li>使用 <code>weak strong dance</code> 来解决 block 中的循环引用问题；</li>
<li>实现NSProxy(虚拟类)的子类，然后在子类中定义weak修饰的target，然后实现消息转发方法，使target处理业务逻辑；一般用于解决NSTimer、CADisplayLink的循环引用；</li>
<li>CoreFoundation对象、CoreGraphics对象、还有C/C++的内存分配需要管理好，有malloc就要有free</li>
</ul>
</li>
<li>善用工具：<strong>MLeaksFinder + Instrument</strong> 或 <strong>FBMemoryProfiler + Instrument</strong>组合使用。通过MLeaksFinder/FBMemoryProfiler发现后。然后使用Instrument再验证；</li>
</ul>
<h4 data-id="heading-25">4、处理内存警告</h4>
<ul>
<li>Memory Warning时，尽可能释放多资源，尤其图片等占内存多的资源，等需要用的时候再重建；</li>
<li>Memory Warning时，部分单例对象可考虑释放掉；</li>
<li><strong>Memory Warning时，不建议self.view = nil</strong>：iOS 6之后，系统发出 Memory Warning 时，<strong>系统会自动回收CALayer的CABackingStore对象(bitmap 内容)</strong>；虽然没有回收 UIView 和 CALayer 类，但是也回收了大部分内存，在需要 bitmap 类时，通过调用 UIView 的 drawRect: 方法重建。</li>
<li>最佳的实践还是<strong>减少大块内存使用，降低内存峰值，避免内存泄露</strong>。</li>
</ul>
<h3 data-id="heading-26">历史文章</h3>
<p><strong>之前对内存问题一些整理</strong></p>
<ul>
<li>
<p><a target="_blank" href="https://link.juejin.cn/?target=http%3A%2F%2Fnanhuacoder.top%2F2018%2F01%2F30%2FiOS-iOSMemory" title="http://nanhuacoder.top/2018/01/30/iOS-iOSMemory" ref="nofollow noopener noreferrer">OC对象内存小记</a></p>
</li>
<li>
<p><a target="_blank" href="https://link.juejin.cn/?target=http%3A%2F%2Fnanhuacoder.top%2F2019%2F04%2F17%2FiOS-OOM%2F" title="http://nanhuacoder.top/2019/04/17/iOS-OOM/" ref="nofollow noopener noreferrer">OOM问题小记</a></p>
</li>
</ul>
<p><strong>之前对图片解码和图片优化一些总结</strong></p>
<ul>
<li><a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2F728f71b9fe28" title="https://www.jianshu.com/p/728f71b9fe28" ref="nofollow noopener noreferrer">篇1：SDWebImage源码看图片解码</a></li>
<li><a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2Fa38a7c7bccbb" title="https://www.jianshu.com/p/a38a7c7bccbb" ref="nofollow noopener noreferrer">iOS实录17：网络图片的优化显示</a></li>
<li><a target="_blank" href="https://link.juejin.cn/?target=http%3A%2F%2Fnanhuacoder.top%2F2019%2F03%2F13%2FiOS-PicDecode" title="http://nanhuacoder.top/2019/03/13/iOS-PicDecode" ref="nofollow noopener noreferrer">图片解码小记</a></li>
</ul>
<h3 data-id="heading-27">参考文章</h3>
<p><a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fblog.csdn.net%2FTuGeLe%2Farticle%2Fdetails%2F104004692" title="https://blog.csdn.net/TuGeLe/article/details/104004692" ref="nofollow noopener noreferrer">深入了解iOS中的OOM(低内存崩溃)</a></p>
<p><a target="_blank" href="https://juejin.cn/post/6844903621276991502#heading-3" title="https://juejin.cn/post/6844903621276991502#heading-3">WWDC 2018：iOS 内存深入研究</a></p>
<p><a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fyq.aliyun.com%2Farticles%2F55820" title="https://yq.aliyun.com/articles/55820" ref="nofollow noopener noreferrer">page fault带来的性能问题</a></p>
<p><a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fwetest.qq.com%2Flab%2Fview%2F367.html" title="https://wetest.qq.com/lab/view/367.html" ref="nofollow noopener noreferrer">iOS微信内存监控</a></p>
<p><a target="_blank" href="https://juejin.cn/post/6844903747538141191" title="https://juejin.cn/post/6844903747538141191">iOS野指针定位总结</a></p>
<p><a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2F8e764d05275b" title="https://www.jianshu.com/p/8e764d05275b" ref="nofollow noopener noreferrer">iOS中的内存管理</a></p>
<p><a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F49829766" title="https://zhuanlan.zhihu.com/p/49829766" ref="nofollow noopener noreferrer">iOS 内存管理研究</a></p>
<p><a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2Ff9b8c139c2ed" title="https://www.jianshu.com/p/f9b8c139c2ed" ref="nofollow noopener noreferrer">Linux对内存的管理, 以及page fault的概念</a></p>
<p><a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fyq.aliyun.com%2Farticles%2F3065" title="https://yq.aliyun.com/articles/3065" ref="nofollow noopener noreferrer">iOS内存管理和malloc源码解读</a></p>
<p><a target="_blank" href="https://link.juejin.cn/?target=https%3A%2F%2Fturingh.github.io%2F2016%2F06%2F28%2Flibmalloc%25E6%25BA%2590%25E7%25A0%2581%25E5%2588%2586%25E6%259E%2590%25E4%25B9%258B%25E5%2588%259D%25E5%25A7%258B%25E5%258C%2596%2F" title="https://turingh.github.io/2016/06/28/libmalloc%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%88%9D%E5%A7%8B%E5%8C%96/" ref="nofollow noopener noreferrer">libmalloc源码分析之初始化</a></p>
</div><style>.markdown-body pre,.markdown-body pre>code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style></div></article> <!----> <div class="article-end" data-v-4b9f9746="" data-v-1c9ebbff=""><div class="tag-list-box" data-v-4b9f9746="" data-v-1c9ebbff=""><div class="tag-list" data-v-4b9f9746="" data-v-1c9ebbff=""><div class="tag-list-title" data-v-4b9f9746="" data-v-1c9ebbff="">分类：</div> <a href="https://juejin.cn/ios" target="_blank" rel="" class="item category-item" data-v-1c9ebbff="" data-v-4b9f9746=""><span class="tag-title" data-v-1c9ebbff="">iOS</span></a></div> <div class="tag-list" data-v-4b9f9746="" data-v-1c9ebbff=""><div class="tag-list-title" data-v-4b9f9746="" data-v-1c9ebbff="">标签：</div> <div class="tag-list-container" data-v-4b9f9746="" data-v-1c9ebbff=""><a href="https://juejin.cn/tag/iOS" target="_blank" rel="" class="item tag-item" data-v-1c9ebbff="" data-v-4b9f9746=""><span class="tag-title" data-v-1c9ebbff="">iOS</span></a></div></div></div> <!----> <div data-fetch-key="1" class="extension-banner" data-v-224127ff="" data-v-1c9ebbff="" data-v-4b9f9746=""><span class="banner-icon" data-v-224127ff=""></span> <div class="banner-wrapper" data-v-224127ff=""><a class="banner-title" data-v-224127ff="" href="https://juejin.cn/extension/?utm_source=standalone&amp;utm_medium=post&amp;utm_campaign=extension_promotion" target="_blank">
      安装掘金浏览器插件
    </a> <div class="banner-content" data-v-224127ff="">多内容聚合浏览、多引擎快捷搜索、多工具便捷提效、多模式随心畅享，你想要的，这里都有！</div></div> <a class="banner-action" data-v-224127ff="" href="https://juejin.cn/extension/?utm_source=standalone&amp;utm_medium=post&amp;utm_campaign=extension_promotion" target="_blank">前往安装</a></div></div> <!----> <!----> <div data-v-33dabfcc="" data-v-1c9ebbff="" data-jj-helper="comment-container" class="container comment-list-box" id="comment-box" data-v-4b9f9746=""><div data-v-14a3249a="" data-v-33dabfcc="" class="comment-form"><div data-v-14a3249a="" class="header"><span data-v-14a3249a="" class="header-title">评论</span></div><div data-v-14a3249a="" class="content"><div data-v-14a3249a="" class="avatar-box"><img data-v-248050e4="" data-v-0b45085c="" data-v-14a3249a="" src="./iOS内存二三事 - 掘金_files/3044413937_100x100.awebp" alt="" class="lazy avatar avatar" loading="lazy"></div><div data-v-14a3249a="" class="form-box"><div data-v-7c7c7498="" data-v-14a3249a="" class="auth-card"><!----> <div data-v-14a3249a="" data-v-7c7c7498="" class="input-box"><div data-v-14a3249a="" data-v-7c7c7498="" contenteditable="true" spellcheck="false" placeholder="输入评论（Enter换行，⌘ + Enter发送）" disabled="disabled" class="rich-input empty"></div><!----><!----></div></div><div data-v-14a3249a="" class="action-box"><div data-v-33ab0a29="" data-v-14a3249a="" class="emoji-container emoji-btn" style="display: none;"><div data-v-33ab0a29="" class="emoji-box"><svg data-v-33ab0a29="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon"><path data-v-33ab0a29="" fill-rule="evenodd" clip-rule="evenodd" d="M8.00002 0.666504C12.0501 0.666504 15.3334 3.94975 15.3334 7.99984C15.3334 12.0499 12.0501 15.3332 8.00002 15.3332C3.94993 15.3332 0.666687 12.0499 0.666687 7.99984C0.666687 3.94975 3.94993 0.666504 8.00002 0.666504ZM8 2C4.68629 2 2 4.68629 2 8C2 11.3137 4.68629 14 8 14C11.3137 14 14 11.3137 14 8C14 4.68629 11.3137 2 8 2ZM10.6667 5.66667V7.66667H9.33333V5.66667H10.6667ZM6.66667 5.66667V7.66667H5.33333V5.66667H6.66667ZM10.0767 9.33333H11.0495C11.1804 9.33333 11.2866 9.43951 11.2866 9.57048C11.2866 9.60754 11.2779 9.64409 11.2612 9.67718L11.244 9.71053C10.6294 10.8739 9.40726 11.6667 7.99998 11.6667C6.61523 11.6667 5.40977 10.8991 4.7859 9.76612L4.73786 9.67593C4.67845 9.56052 4.72385 9.4188 4.83926 9.35939C4.87253 9.34226 4.90941 9.33333 4.94683 9.33333H5.92347C6.02396 9.33332 6.11908 9.37865 6.18238 9.4567C6.26207 9.55496 6.32833 9.62955 6.38117 9.68046C6.80074 10.0847 7.37133 10.3333 7.99998 10.3333C8.63289 10.3333 9.20694 10.0814 9.62728 9.67224C9.67791 9.62296 9.74135 9.55121 9.8176 9.45698C9.88089 9.37877 9.97611 9.33333 10.0767 9.33333Z"></path></svg> <span data-v-33ab0a29="">表情</span></div> <!----></div><div data-v-14a3249a="" class="image-btn" style="display: none;"><svg data-v-14a3249a="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon"><path data-v-14a3249a="" fill-rule="evenodd" clip-rule="evenodd" d="M14 1.3335C14.3514 1.3335 14.6394 1.60546 14.6648 1.95041L14.6666 2.00016V14.0002C14.6666 14.3516 14.3947 14.6396 14.0497 14.665L14 14.6668H1.99998C1.64853 14.6668 1.36059 14.3949 1.33514 14.0499L1.33331 14.0002V2.00016C1.33331 1.64871 1.60527 1.36077 1.95023 1.33532L1.99998 1.3335H14ZM13.3333 2.66618H2.66664V13.3328H13.3333V2.66618ZM11.9219 6.7879C11.9719 6.83791 12 6.90574 12 6.97647V11.7993C12 11.9098 11.9104 11.9993 11.8 11.9993H6.81615C6.7975 11.9993 6.77945 11.9968 6.76232 11.992L3.91042 11.9847C3.79996 11.9844 3.71063 11.8947 3.7109 11.7842C3.71102 11.7313 3.73209 11.6807 3.76948 11.6433L6.52468 8.88807C6.62882 8.78393 6.79766 8.78393 6.9018 8.88807L8.17297 10.1593L11.5447 6.7879C11.6489 6.68376 11.8177 6.68376 11.9219 6.7879ZM5.99997 3.99951V5.99951H3.99997V3.99951H5.99997Z"></path></svg><span data-v-14a3249a="">图片</span></div><div data-v-14a3249a="" class="submit" style="display: none;"><span data-v-14a3249a="">⌘ + Enter</span><button data-v-14a3249a="" disabled="disabled" class="submit-btn">发表评论</button></div></div></div><input data-v-14a3249a="" type="file" class="hidden"></div></div> <!----> <div data-v-33dabfcc="" class="comment-list-wrapper"><div data-v-33dabfcc="" class="title">
      全部评论 2
      <div data-v-33dabfcc="" class="sort"><div data-v-33dabfcc="" class="item active"><svg data-v-33dabfcc="" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" class=""><path data-v-33dabfcc="" fill-rule="evenodd" clip-rule="evenodd" d="M5.99951 0.5C9.03708 0.5 11.4995 2.96243 11.4995 6C11.4995 9.03757 9.03708 11.5 5.99951 11.5C2.96195 11.5 0.499512 9.03757 0.499512 6C0.499512 2.96243 2.96195 0.5 5.99951 0.5ZM6.25 3.49988C6.38807 3.49988 6.5 3.61181 6.5 3.74988V5.49988H8.25C8.38807 5.49988 8.5 5.61181 8.5 5.74988V6.24988C8.5 6.38795 8.38807 6.49988 8.25 6.49988H5.75C5.61193 6.49988 5.5 6.38795 5.5 6.24988V3.74988C5.5 3.61181 5.61193 3.49988 5.75 3.49988H6.25Z"></path></svg>
          最新
        </div> <div data-v-33dabfcc="" class="item"><svg data-v-33dabfcc="" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" class=""><path data-v-33dabfcc="" d="M4.88933 0.613974C4.92947 0.616946 4.96831 0.629568 5.00253 0.650767C6.67348 1.68589 7.55141 3.13884 7.63632 5.00962C7.947 5.00962 8.2245 4.65999 8.46882 3.96072L8.49487 3.88447C8.53862 3.75351 8.68025 3.68282 8.8112 3.72656C8.83398 3.73417 8.85554 3.74502 8.87522 3.75878C9.96316 4.5193 10.5048 5.50231 10.5 6.70782C10.4999 6.73762 10.4982 6.76675 10.495 6.7952C10.4985 6.86294 10.5 6.93131 10.5 7.00005C10.5 9.48533 8.48528 11.5 6 11.5C3.51472 11.5 1.5 9.48533 1.5 7.00005C1.5 6.90255 1.5031 6.80578 1.50921 6.70983C1.5062 6.70917 1.5031 6.70849 1.5 6.70782C1.50864 6.60849 1.52139 6.50994 1.53824 6.41219C1.54515 6.35775 1.55321 6.30373 1.56222 6.25003L1.57017 6.24983C1.7622 5.3813 2.28426 4.57601 3.13635 3.83394C4.00892 3.07405 4.50079 2.11523 4.61198 0.957499L4.62156 0.844839C4.63175 0.707146 4.75163 0.603784 4.88933 0.613974Z"></path></svg>
          最热
        </div></div></div> <div data-v-51124a88="" data-v-33dabfcc="" class="comment-list comment-list"><div data-v-5ca9a68f="" data-v-51124a88="" class="image-viewer-box"><!----></div> <div data-v-18fef07e="" data-v-51124a88="" class="comment" data-jj-helper-comment-id="6888144135606960142"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-18fef07e="" class="popover-box user-popover popover"><!---->  <a data-v-18fef07e="" href="https://juejin.cn/user/3051900008145182" target="_blank" rel="" class="user-link" data-v-f1a2074a=""><img data-v-248050e4="" data-v-0b45085c="" data-v-18fef07e="" src="./iOS内存二三事 - 掘金_files/f04e5d111a455d11003ff06d29f85d4b_100x100.awebp" alt="东野浪子的头像" class="lazy avatar avatar" loading="lazy"></a></div> <div data-v-18fef07e="" class="content-box"><div data-v-18fef07e="" class="comment-main"><span data-v-18fef07e="" class="delete">
        删除
      </span> <div data-v-18fef07e="" class="user-box"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-18fef07e="" class="popover-box user-popover"><!---->  <a data-v-68a20f0a="" data-v-18fef07e="" href="https://juejin.cn/user/3051900008145182" target="_blank" rel="" class="username username" data-v-f1a2074a=""><span data-v-68a20f0a="" class="name" style="max-width: 128px;">
    东野浪子
  </span> <span data-v-3c1a13dc="" data-v-68a20f0a="" blank="true" class="rank"><img data-v-248050e4="" data-v-3c1a13dc="" src="./iOS内存二三事 - 掘金_files/ad1d5b8ec0974b0bbc14446acdd7c20d_tplv-k3u1fbpfcp-no-mark_0_0_0_0.awebp" alt="lv-2" class="lazy" title="创作等级" loading="lazy"></span> <img data-v-7b42e73d="" data-v-68a20f0a="" src="./iOS内存二三事 - 掘金_files/8c6985e2aa4c06f307ae3734da4b43ac.svg" alt="掘友等级" title="掘友等级" class="jueyou-level"> <!----> </a></div> <!----> <span data-v-18fef07e="" class="position">
          iOS研发工程师 @ 北京字节跳动科技有限公司
        </span> <time data-v-18fef07e="" datetime="1603771040000" title="Tue Oct 27 2020 11:57:20 GMT+0800 (中国标准时间)" class="time">
          2年前
        </time></div> <div data-v-18fef07e="" class="content">同学你好，看了你的文章，非常有深度，非常欣赏。请问字节跳动APM中台的机会考虑下吗？这是我们团队的一篇技术文章：<a href="https://juejin.im/post/6885144933997494280" class="parse-emoji-url" style="color: #027fff" title="https://juejin.im/post/6885144933997494280" target="_blank"><img alt="" style="vertical-align: sub" draggable="false" src="./iOS内存二三事 - 掘金_files/3f843e8626a3844c624fb596dddd9674.svg">juejin.im</a></div> <div data-v-18fef07e="" class="limit-btn" style="display: none;">
        展开
      </div> <div data-v-18fef07e="" class="limit-btn" style="display: none;">
        收起
      </div> <!----> <div data-v-18fef07e="" class="action-box"><div data-v-18fef07e="" class="item dig-item"><svg data-v-18fef07e="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class=""><path data-v-18fef07e="" fill-rule="evenodd" clip-rule="evenodd" d="M8.56162 2.16952C8.66569 2.09661 8.78195 2.06124 8.88247 2.0912C8.97653 2.11923 9.23851 2.25916 9.50988 2.96799C9.64419 3.31881 9.9356 4.2424 9.42155 6.05431C9.29751 6.49152 9.61394 6.95303 10.0926 6.95971L13.492 7.00716L13.492 7.00721H13.4991C13.6049 7.00721 13.7228 7.01986 13.8134 7.05898C13.8544 7.07671 13.8815 7.09639 13.8999 7.116C13.9166 7.13375 13.9368 7.16247 13.9515 7.21636C13.9848 7.33784 14.0228 7.74712 13.9473 8.42262C13.874 9.07857 13.698 9.94479 13.341 10.9598C13.0424 11.8088 12.6601 12.5292 12.0684 13.4879C12.0558 13.5052 12.0462 13.5197 12.0418 13.5265L12.0404 13.5285C12.0292 13.5454 12.0242 13.5531 12.018 13.5618C12.0076 13.5764 12.0018 13.582 11.9983 13.585C11.996 13.587 11.9908 13.5912 11.9777 13.5959C11.9638 13.6009 11.9311 13.61 11.8706 13.61H5.56278L5.56373 6.58489C5.87126 6.41901 6.19881 6.20128 6.54112 5.84059C6.93883 5.42152 7.33789 4.8294 7.76254 3.94183C7.84974 3.75957 7.91745 3.55962 7.97574 3.37762C7.99264 3.32486 8.0087 3.27379 8.02438 3.22393L8.02439 3.22389C8.066 3.09158 8.10495 2.96776 8.14985 2.84312C8.2758 2.49352 8.40247 2.28101 8.56162 2.16952ZM10.452 2.60729C10.1323 1.77209 9.70208 1.28277 9.17063 1.12437C8.64564 0.967902 8.20308 1.18891 7.98278 1.34325C7.55169 1.64525 7.33837 2.11908 7.20071 2.5012C7.14817 2.64705 7.10002 2.80016 7.05661 2.93824C7.0422 2.98405 7.02832 3.02821 7.01496 3.0699C6.95791 3.24804 6.90763 3.39115 6.85248 3.50643C6.45683 4.3334 6.1121 4.8271 5.80935 5.14611C5.51322 5.45815 5.23983 5.6219 4.9473 5.76821C4.71095 5.88641 4.55494 6.12906 4.55491 6.40159L4.55388 13.9125C4.55383 14.3026 4.87002 14.6188 5.26008 14.6188H11.8706C12.2097 14.6188 12.4663 14.5113 12.6519 14.3535C12.7387 14.2797 12.7988 14.2043 12.8387 14.1484C12.8556 14.1248 12.8704 14.1025 12.8786 14.09L12.8813 14.0859L12.8826 14.0839L12.8955 14.0685L12.9142 14.0382C13.5304 13.0414 13.9578 12.247 14.2927 11.2945C14.6745 10.209 14.8679 9.26811 14.9499 8.5347C15.0297 7.82084 15.009 7.25845 14.9246 6.95014C14.805 6.51285 14.5104 6.26112 14.2134 6.13284C13.9385 6.01407 13.661 5.99859 13.5028 5.99836L10.4907 5.95631C10.9296 4.15791 10.648 3.11902 10.452 2.60729ZM1.0008 6.46783C0.981809 6.0652 1.30313 5.72836 1.70621 5.72836H2.75264C3.14266 5.72836 3.45883 6.04454 3.45883 6.43456V13.9442C3.45883 14.3342 3.14266 14.6504 2.75264 14.6504H2.06044C1.68335 14.6504 1.37279 14.3541 1.35502 13.9775L1.0008 6.46783Z"></path></svg>
          点赞
        </div> <div data-v-18fef07e="" class="item"><svg data-v-18fef07e="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class=""><path data-v-18fef07e="" fill-rule="evenodd" clip-rule="evenodd" d="M2.30136 10.1142L2.30019 3.45191C2.30024 2.6778 2.92779 2.05019 3.70191 2.05019H12.3989C13.1731 2.05019 13.8006 2.67785 13.8006 3.452L13.8018 10.1144C13.8017 10.8885 13.1742 11.516 12.4001 11.516H10.1322C9.97329 11.516 9.81862 11.5675 9.69142 11.6629L6.65162 13.9406C6.62173 13.9598 6.58148 13.9444 6.57209 13.91L6.15416 12.0869C6.07758 11.7528 5.78033 11.516 5.43761 11.516H3.70308C2.92893 11.516 2.30136 10.8884 2.30136 10.1142ZM3.70191 1C2.34776 1 1.25 2.09776 1.25 3.45191L1.25117 10.1144C1.25122 11.4685 2.34896 12.5662 3.70308 12.5662H5.18661L5.54953 14.1495L5.55107 14.1558C5.73515 14.9153 6.62879 15.248 7.26458 14.7937L10.2372 12.5662H12.4001C13.7542 12.5662 14.852 11.4684 14.852 10.1142L14.8508 3.45182C14.8508 2.09771 13.753 1 12.3989 1H3.70191ZM4.78612 7.91404C5.35027 7.91404 5.8076 7.45671 5.8076 6.89257C5.8076 6.32842 5.35027 5.87109 4.78612 5.87109C4.22198 5.87109 3.76465 6.32842 3.76465 6.89257C3.76465 7.45671 4.22198 7.91404 4.78612 7.91404ZM8.98631 6.89257C8.98631 7.45671 8.52898 7.91404 7.96483 7.91404C7.40069 7.91404 6.94336 7.45671 6.94336 6.89257C6.94336 6.32842 7.40069 5.87109 7.96483 5.87109C8.52898 5.87109 8.98631 6.32842 8.98631 6.89257ZM11.1484 7.91404C11.7126 7.91404 12.1699 7.45671 12.1699 6.89257C12.1699 6.32842 11.7126 5.87109 11.1484 5.87109C10.5843 5.87109 10.127 6.32842 10.127 6.89257C10.127 7.45671 10.5843 7.91404 11.1484 7.91404Z"></path></svg>
          回复
        </div></div></div> <div data-v-18fef07e="" class="subcomment-wrapper"><!----> <!----></div></div></div><div data-v-18fef07e="" data-v-51124a88="" class="comment" data-jj-helper-comment-id="6855147111064469517"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-18fef07e="" class="popover-box user-popover popover"><!---->  <a data-v-18fef07e="" href="https://juejin.cn/user/1538972010421981" target="_blank" rel="" class="user-link" data-v-f1a2074a=""><img data-v-248050e4="" data-v-0b45085c="" data-v-18fef07e="" src="./iOS内存二三事 - 掘金_files/16d4c3f948c74eef53d_tplv-t2oaga2asx-no-mark_100_100_100_100.awebp" alt="大斗田的头像" class="lazy avatar avatar" loading="lazy"></a></div> <div data-v-18fef07e="" class="content-box"><div data-v-18fef07e="" class="comment-main"><span data-v-18fef07e="" class="delete">
        删除
      </span> <div data-v-18fef07e="" class="user-box"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-18fef07e="" class="popover-box user-popover"><!---->  <a data-v-68a20f0a="" data-v-18fef07e="" href="https://juejin.cn/user/1538972010421981" target="_blank" rel="" class="username username" data-v-f1a2074a=""><span data-v-68a20f0a="" class="name" style="max-width: 128px;">
    大斗田
  </span> <!----> <img data-v-7b42e73d="" data-v-68a20f0a="" src="./iOS内存二三事 - 掘金_files/9b2f31c663d17de59dd9e5fff272bb85.svg" alt="掘友等级" title="掘友等级" class="jueyou-level"> <!----> </a></div> <!----> <!----> <time data-v-18fef07e="" datetime="1587079974000" title="Fri Apr 17 2020 07:32:54 GMT+0800 (中国标准时间)" class="time">
          2年前
        </time></div> <div data-v-18fef07e="" class="content"><img class="emoji old" draggable="false" "="" loading="lazy" alt="👍" src="./iOS内存二三事 - 掘金_files/1f44d.svg_tplv-t2oaga2asx-image.image">    <img class="emoji old" draggable="false" "="" loading="lazy" alt="👍" src="./iOS内存二三事 - 掘金_files/1f44d.svg_tplv-t2oaga2asx-image.image"></div> <div data-v-18fef07e="" class="limit-btn" style="display: none;">
        展开
      </div> <div data-v-18fef07e="" class="limit-btn" style="display: none;">
        收起
      </div> <!----> <div data-v-18fef07e="" class="action-box"><div data-v-18fef07e="" class="item dig-item"><svg data-v-18fef07e="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class=""><path data-v-18fef07e="" fill-rule="evenodd" clip-rule="evenodd" d="M8.56162 2.16952C8.66569 2.09661 8.78195 2.06124 8.88247 2.0912C8.97653 2.11923 9.23851 2.25916 9.50988 2.96799C9.64419 3.31881 9.9356 4.2424 9.42155 6.05431C9.29751 6.49152 9.61394 6.95303 10.0926 6.95971L13.492 7.00716L13.492 7.00721H13.4991C13.6049 7.00721 13.7228 7.01986 13.8134 7.05898C13.8544 7.07671 13.8815 7.09639 13.8999 7.116C13.9166 7.13375 13.9368 7.16247 13.9515 7.21636C13.9848 7.33784 14.0228 7.74712 13.9473 8.42262C13.874 9.07857 13.698 9.94479 13.341 10.9598C13.0424 11.8088 12.6601 12.5292 12.0684 13.4879C12.0558 13.5052 12.0462 13.5197 12.0418 13.5265L12.0404 13.5285C12.0292 13.5454 12.0242 13.5531 12.018 13.5618C12.0076 13.5764 12.0018 13.582 11.9983 13.585C11.996 13.587 11.9908 13.5912 11.9777 13.5959C11.9638 13.6009 11.9311 13.61 11.8706 13.61H5.56278L5.56373 6.58489C5.87126 6.41901 6.19881 6.20128 6.54112 5.84059C6.93883 5.42152 7.33789 4.8294 7.76254 3.94183C7.84974 3.75957 7.91745 3.55962 7.97574 3.37762C7.99264 3.32486 8.0087 3.27379 8.02438 3.22393L8.02439 3.22389C8.066 3.09158 8.10495 2.96776 8.14985 2.84312C8.2758 2.49352 8.40247 2.28101 8.56162 2.16952ZM10.452 2.60729C10.1323 1.77209 9.70208 1.28277 9.17063 1.12437C8.64564 0.967902 8.20308 1.18891 7.98278 1.34325C7.55169 1.64525 7.33837 2.11908 7.20071 2.5012C7.14817 2.64705 7.10002 2.80016 7.05661 2.93824C7.0422 2.98405 7.02832 3.02821 7.01496 3.0699C6.95791 3.24804 6.90763 3.39115 6.85248 3.50643C6.45683 4.3334 6.1121 4.8271 5.80935 5.14611C5.51322 5.45815 5.23983 5.6219 4.9473 5.76821C4.71095 5.88641 4.55494 6.12906 4.55491 6.40159L4.55388 13.9125C4.55383 14.3026 4.87002 14.6188 5.26008 14.6188H11.8706C12.2097 14.6188 12.4663 14.5113 12.6519 14.3535C12.7387 14.2797 12.7988 14.2043 12.8387 14.1484C12.8556 14.1248 12.8704 14.1025 12.8786 14.09L12.8813 14.0859L12.8826 14.0839L12.8955 14.0685L12.9142 14.0382C13.5304 13.0414 13.9578 12.247 14.2927 11.2945C14.6745 10.209 14.8679 9.26811 14.9499 8.5347C15.0297 7.82084 15.009 7.25845 14.9246 6.95014C14.805 6.51285 14.5104 6.26112 14.2134 6.13284C13.9385 6.01407 13.661 5.99859 13.5028 5.99836L10.4907 5.95631C10.9296 4.15791 10.648 3.11902 10.452 2.60729ZM1.0008 6.46783C0.981809 6.0652 1.30313 5.72836 1.70621 5.72836H2.75264C3.14266 5.72836 3.45883 6.04454 3.45883 6.43456V13.9442C3.45883 14.3342 3.14266 14.6504 2.75264 14.6504H2.06044C1.68335 14.6504 1.37279 14.3541 1.35502 13.9775L1.0008 6.46783Z"></path></svg>
          点赞
        </div> <div data-v-18fef07e="" class="item"><svg data-v-18fef07e="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class=""><path data-v-18fef07e="" fill-rule="evenodd" clip-rule="evenodd" d="M2.30136 10.1142L2.30019 3.45191C2.30024 2.6778 2.92779 2.05019 3.70191 2.05019H12.3989C13.1731 2.05019 13.8006 2.67785 13.8006 3.452L13.8018 10.1144C13.8017 10.8885 13.1742 11.516 12.4001 11.516H10.1322C9.97329 11.516 9.81862 11.5675 9.69142 11.6629L6.65162 13.9406C6.62173 13.9598 6.58148 13.9444 6.57209 13.91L6.15416 12.0869C6.07758 11.7528 5.78033 11.516 5.43761 11.516H3.70308C2.92893 11.516 2.30136 10.8884 2.30136 10.1142ZM3.70191 1C2.34776 1 1.25 2.09776 1.25 3.45191L1.25117 10.1144C1.25122 11.4685 2.34896 12.5662 3.70308 12.5662H5.18661L5.54953 14.1495L5.55107 14.1558C5.73515 14.9153 6.62879 15.248 7.26458 14.7937L10.2372 12.5662H12.4001C13.7542 12.5662 14.852 11.4684 14.852 10.1142L14.8508 3.45182C14.8508 2.09771 13.753 1 12.3989 1H3.70191ZM4.78612 7.91404C5.35027 7.91404 5.8076 7.45671 5.8076 6.89257C5.8076 6.32842 5.35027 5.87109 4.78612 5.87109C4.22198 5.87109 3.76465 6.32842 3.76465 6.89257C3.76465 7.45671 4.22198 7.91404 4.78612 7.91404ZM8.98631 6.89257C8.98631 7.45671 8.52898 7.91404 7.96483 7.91404C7.40069 7.91404 6.94336 7.45671 6.94336 6.89257C6.94336 6.32842 7.40069 5.87109 7.96483 5.87109C8.52898 5.87109 8.98631 6.32842 8.98631 6.89257ZM11.1484 7.91404C11.7126 7.91404 12.1699 7.45671 12.1699 6.89257C12.1699 6.32842 11.7126 5.87109 11.1484 5.87109C10.5843 5.87109 10.127 6.32842 10.127 6.89257C10.127 7.45671 10.5843 7.91404 11.1484 7.91404Z"></path></svg>
          回复
        </div></div></div> <div data-v-18fef07e="" class="subcomment-wrapper"><!----> <!----></div></div></div></div> <!----></div></div> <div data-v-1b688d7c="" data-v-1c9ebbff="" class="action-box action-bar" data-v-4b9f9746=""><div data-v-1b688d7c="" class="praise-action action"><div data-v-1b688d7c="" class="action-title-box"><img data-v-1b688d7c="" src="./iOS内存二三事 - 掘金_files/00ba359ecd0075e59ffbc3d810af551d.svg"> <span data-v-1b688d7c="" class="action-title">
          54
        </span></div></div> <div data-v-1b688d7c="" class="comment-action action"><div data-v-1b688d7c="" class="action-title-box"><img data-v-1b688d7c="" src="./iOS内存二三事 - 掘金_files/336af4d1fafabcca3b770c8ad7a50781.svg"> <span data-v-1b688d7c="" class="action-title">
          2
        </span></div></div> <div data-v-1b688d7c="" class="collect-action action"><div data-v-1b688d7c="" class="action-title-box"><img data-v-1b688d7c="" src="./iOS内存二三事 - 掘金_files/3d482c7a948bac826e155953b2a28a9e.svg"> <span data-v-1b688d7c="" class="action-title">收藏</span></div></div> <!----></div></div> <div data-v-1c9ebbff="" data-v-4b9f9746="" class="main-area recommended-area shadow"><div data-v-1c9ebbff="" data-v-4b9f9746="" class="recommended-list-title-wrapper"><div data-v-1c9ebbff="" data-v-4b9f9746="" class="title"><span data-v-1c9ebbff="" data-v-4b9f9746="" class="title-content">相关推荐</span></div></div> <div data-v-3ff8f708="" data-v-57c9777c="" data-v-1c9ebbff="" name="entry-list" tag="div" class="entry-list list recommended-entry-list" data-v-4b9f9746=""><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="7199113019447099452" data-original-type="0" data-draft-id="7199106370825273404" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/1556564198302935" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        图图大恼
      </div></a> <div data-v-5380cbb8="" class="date">19天前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/%E6%8E%98%E9%87%91%C2%B7%E6%97%A5%E6%96%B0%E8%AE%A1%E5%88%92" target="_blank" rel="" class="tag">
        掘金·日新计划
      </a><a data-v-5380cbb8="" href="https://juejin.cn/tag/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96" target="_blank" rel="" class="tag">
        性能优化
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/7199113019447099452" target="_blank" rel="" title="iOS 内存优化之自动导出内存图" class="title">iOS 内存优化之自动导出内存图</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/7199113019447099452" target="_blank" rel=""><div data-v-5380cbb8="">在上一篇文章iOS 内存优化之工具介绍中提到利用leaks工具进行排查内存问题的最佳实践方案，本篇文章是对其的补充，这里将讲述录制UITest和自动导出内存图过程的具体实践。</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">3020</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            4
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            1
          </span></li> <!----></ul></div> <img data-v-248050e4="" data-v-5380cbb8="" src="./iOS内存二三事 - 掘金_files/772121afd69342988f1885a3cdd6e20d_tplv-k3u1fbpfcp-no-mark_300_300_300_200.awebp" alt="iOS 内存优化之自动导出内存图" class="lazy thumb" loading="lazy" style=""></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6844903568642670600" data-original-type="1" data-draft-id="0" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/1908407914208456" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        和田鑫
      </div></a> <div data-v-5380cbb8="" class="date">5年前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/%E5%BE%AE%E4%BF%A1" target="_blank" rel="" class="tag">
        微信
      </a><a data-v-5380cbb8="" href="https://juejin.cn/tag/iOS" target="_blank" rel="" class="tag">
        iOS
      </a><a data-v-5380cbb8="" href="https://juejin.cn/tag/%E8%85%BE%E8%AE%AF" target="_blank" rel="" class="tag">
        腾讯
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6844903568642670600" target="_blank" rel="" title="iOS微信内存监控" class="title">iOS微信内存监控</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6844903568642670600" target="_blank" rel=""><div data-v-5380cbb8="">杨津，腾讯移动客户端开发 高级工程师 WeTest 导读 目前iOS主流的内存监控工具是Instruments的Allocations，但只能用于开发阶段。本文介绍如何搭建离线化的内存监控工具，用于App上线后发现…</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">1478</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            32
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            1
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="7123765829929762847" data-original-type="0" data-draft-id="7123573224792670216" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/1025215862414904" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        JPlay
      </div></a> <div data-v-5380cbb8="" class="date">7月前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/Flutter" target="_blank" rel="" class="tag">
        Flutter
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/7123765829929762847" target="_blank" rel="" title="解决 Flutter 引起的 iOS 内存崩溃问题" class="title">解决 Flutter 引起的 iOS 内存崩溃问题</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/7123765829929762847" target="_blank" rel=""><div data-v-5380cbb8="">目前主流版本的 Flutter 在 iOS 平台上存在内存问题，如果你的 Flutter 版本号大于 2.5.3 且小于 3.0.5，那么我相信此文会对你有用。</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">9139</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            65
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            17
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="7174259081484763173" data-original-type="0" data-draft-id="7174210545606721544" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/3285773734395085" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        老边
      </div></a> <div data-v-5380cbb8="" class="date">2月前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/%E7%A8%8B%E5%BA%8F%E5%91%98" target="_blank" rel="" class="tag">
        程序员
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/7174259081484763173" target="_blank" rel="" title="程序员入行感触二三事" class="title">程序员入行感触二三事</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/7174259081484763173" target="_blank" rel=""><div data-v-5380cbb8="">引言 好久没有发感触了，之前一直在做讲师授课，接触了好多入门的程序员，有很多感触，但是在做讲师的时候有时候不方便说，在做开发又开始忙，所以就沉淀下来了，今天掏出来聊聊吧。</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">1808</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            51
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            1
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6844903717125226503" data-original-type="1" data-draft-id="0" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/3737995264145063" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        Mr_zebra
      </div></a> <div data-v-5380cbb8="" class="date">4年前</div> <!----></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6844903717125226503" target="_blank" rel="" title="理解 iOS 和 macOS 的内存管理" class="title">理解 iOS 和 macOS 的内存管理</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6844903717125226503" target="_blank" rel=""><div data-v-5380cbb8="">在 iOS 和 macOS 应用的开发中，无论是使用 Objective-C 还是使用 swift 都是通过引用计数策略来进行内存管理的，但是在日常开发中80%（这里，我瞎说的，8020 原则嘛）以上的情况，我们不需要考虑内存问题，因为 Objective-C 2.0 引入的自…</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">223</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            点赞
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6844903622862618631" data-original-type="1" data-draft-id="0" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/4195392100501208" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        iFangcy_
      </div></a> <div data-v-5380cbb8="" class="date">4年前</div> <!----></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6844903622862618631" target="_blank" rel="" title="探索iOS内存分配" class="title">探索iOS内存分配</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6844903622862618631" target="_blank" rel=""><div data-v-5380cbb8="">在运行iOS（OSX）程序时，左侧的Debug Navigator中可以看见当前使用的内存。我们也可以使用Instruments的Allocations模板来追踪对象的创建和释放。不知道你是否也曾困惑于Debug Navigator显示的内存和Allocations显示的总内存…</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">198</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            点赞
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="7080042610571608078" data-original-type="0" data-draft-id="7080041631629443086" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/3114277759891991" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        百瓶技术
      </div></a> <div data-v-5380cbb8="" class="date">11月前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/%E6%B5%8B%E8%AF%95" target="_blank" rel="" class="tag">
        测试
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/7080042610571608078" target="_blank" rel="" title="接口测试二三事" class="title">接口测试二三事</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/7080042610571608078" target="_blank" rel=""><div data-v-5380cbb8="">接口测试小白摸着石头过河，本文主要介绍测试小团队在接口测试实践过程中遇到的一些事，如有雷同纯属巧合😊。</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">1546</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            8
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            3
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="7196931784328626234" data-original-type="0" data-draft-id="7196905678438039589" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/3843548382519448" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        呦呦君
      </div></a> <div data-v-5380cbb8="" class="date">25天前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/iOS" target="_blank" rel="" class="tag">
        iOS
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/7196931784328626234" target="_blank" rel="" title="iOS APP虚拟内存用量初探" class="title">iOS APP虚拟内存用量初探</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/7196931784328626234" target="_blank" rel=""><div data-v-5380cbb8="">业务上出现过因为虚拟内存耗尽导致的crash，后续也通过设置为APP扩展虚拟内存的可用范围，本文主要基于以上背景对虚拟内存进行一些调研</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">3309</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            18
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            1
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6844903715816603662" data-original-type="1" data-draft-id="0" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/4195392100501208" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        iFangcy_
      </div></a> <div data-v-5380cbb8="" class="date">4年前</div> <!----></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6844903715816603662" target="_blank" rel="" title="理解 iOS 和 macOS 的内存管理" class="title">理解 iOS 和 macOS 的内存管理</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6844903715816603662" target="_blank" rel=""><div data-v-5380cbb8="">在 iOS 和 macOS 应用的开发中，无论是使用 Objective-C 还是使用 swift 都是通过引用计数策略来进行内存管理的，但是在日常开发中80%（这里，我瞎说的，8020 原则嘛😆）以上的情况，我们不需要考虑内存问题，因为 Objective-C 2.0 引入…</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">176</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            点赞
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="7026744482741633060" data-original-type="0" data-draft-id="7026743721920036871" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/3474880355109070" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        麻蕊老师
      </div></a> <div data-v-5380cbb8="" class="date">1年前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96" target="_blank" rel="" class="tag">
        性能优化
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/7026744482741633060" target="_blank" rel="" title="iOS内存优化" class="title">iOS内存优化</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/7026744482741633060" target="_blank" rel=""><div data-v-5380cbb8="">「这是我参与11月更文挑战的第2天，活动详情查看：2021最后一次更文挑战」。 一、列表 &nbsp; &nbsp; TableView/CollectionView的无限下滑会导致数据、UI的持续调用，会造成内存暴涨 </div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">1126</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            2
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            1
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6844903429471649799" data-original-type="1" data-draft-id="0" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/1926000100000247" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        要乖乖搬砖的小幽幽
      </div></a> <div data-v-5380cbb8="" class="date">6年前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/iOS" target="_blank" rel="" class="tag">
        iOS
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6844903429471649799" target="_blank" rel="" title="谈谈 iOS 内存泄露" class="title">谈谈 iOS 内存泄露</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6844903429471649799" target="_blank" rel=""><div data-v-5380cbb8="">如何动态检测内存泄露</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">915</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            45
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            评论
          </span></li> <!----></ul></div> <img data-v-248050e4="" data-v-5380cbb8="" src="./iOS内存二三事 - 掘金_files/9b82a376e71b7aa10338.jpg_tplv-t2oaga2asx-no-mark_300_300_300_200.awebp" alt="谈谈 iOS 内存泄露" class="lazy thumb" loading="lazy" style=""></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6844903533356007431" data-original-type="0" data-draft-id="6845075343724773383" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/377887729386301" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        BigYiZa
      </div></a> <div data-v-5380cbb8="" class="date">5年前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/Apple" target="_blank" rel="" class="tag">
        Apple
      </a><a data-v-5380cbb8="" href="https://juejin.cn/tag/iOS" target="_blank" rel="" class="tag">
        iOS
      </a><a data-v-5380cbb8="" href="https://juejin.cn/tag/%E7%A8%8B%E5%BA%8F%E5%91%98" target="_blank" rel="" class="tag">
        程序员
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6844903533356007431" target="_blank" rel="" title="【程序员的自我修养①】iOS内存管理" class="title">【程序员的自我修养①】iOS内存管理</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6844903533356007431" target="_blank" rel=""><div data-v-5380cbb8="">iOS内存管理Objective-C中的内存分配在Objective-C中，对象通常是使用alloc方法在堆上创建的。[NSObjectalloc]方法会在对堆上分配一块内存，按照NSObject的内</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">361</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            1
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6844903524824776711" data-original-type="0" data-draft-id="6845075331473211406" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/4406498333575997" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        吃粑粑的毕教授
      </div></a> <div data-v-5380cbb8="" class="date">5年前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/iOS" target="_blank" rel="" class="tag">
        iOS
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6844903524824776711" target="_blank" rel="" title="iOS 简单而粗暴的说一说内存管理" class="title">iOS 简单而粗暴的说一说内存管理</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6844903524824776711" target="_blank" rel=""><div data-v-5380cbb8="">简介:既然是内存管理，首先要知道那么内存是用来干什么的？内存具体管理的东西是什么？当然这些东西基本都是常识了，内存当然是用来存储数据的，内存要管理的东西简单的说也就是如何将数据存储到内存中（比如说我们</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">88</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            点赞
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6935409052499312653" data-original-type="0" data-draft-id="6935408777277472805" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/1468603264927198" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        jackyshan_
      </div></a> <div data-v-5380cbb8="" class="date">1年前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/iOS" target="_blank" rel="" class="tag">
        iOS
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6935409052499312653" target="_blank" rel="" title="iOS内存管理方案" class="title">iOS内存管理方案</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6935409052499312653" target="_blank" rel=""><div data-v-5380cbb8="">__x86_64__环境调试TaggedPointer解析判断取值NONPOINTER_ISA解析判断class指针==isa取值shiftcls计算出类对象地址初始化isa左移三位得到cls指针散列</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">893</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            4
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            4
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6844903456923353095" data-original-type="0" data-draft-id="6845075290247397389" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/26044007449998" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        lyxia_iOS
      </div></a> <div data-v-5380cbb8="" class="date">6年前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/iOS" target="_blank" rel="" class="tag">
        iOS
      </a><a data-v-5380cbb8="" href="https://juejin.cn/tag/Objective-C" target="_blank" rel="" class="tag">
        Objective-C
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6844903456923353095" target="_blank" rel="" title="“理解”iOS内存管理" class="title">“理解”iOS内存管理</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6844903456923353095" target="_blank" rel=""><div data-v-5380cbb8="">引言：我们都知道Objective-C通过“引用计数”来管理对象释放。基本原理就是管理对象的持有者个数（引用计数），引用计数为0时释放对象。现在有ARC（自动引用计数），则无需我们自己显式持有（retain）和释放（release）对象，ARC通过对对像加上所有权修饰符（__s…</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">2190</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            34
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6844904018871844871" data-original-type="0" data-draft-id="6845076551407501326" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/1662117311428174" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        ZJ_Sandy
      </div></a> <div data-v-5380cbb8="" class="date">3年前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/iOS" target="_blank" rel="" class="tag">
        iOS
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6844904018871844871" target="_blank" rel="" title="iOS 分类与扩展" class="title">iOS 分类与扩展</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6844904018871844871" target="_blank" rel=""><div data-v-5380cbb8="">1，已经有对象方法，类方法，协议方法和属性的存储方式。但是并不存在成员变量，所以分类是不允许添加成员变量的。 2， 分类的属性是不会自动生产成员变量，set/get方法。我们可以通过runtime动态的生产set/get方法 答：分类的实现原理是将category的方法，属性，…</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">1291</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            点赞
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6844903544852758536" data-original-type="0" data-draft-id="6845075361873526798" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/2629687543607837" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        大白先生
      </div></a> <div data-v-5380cbb8="" class="date">5年前</div> <!----></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6844903544852758536" target="_blank" rel="" title="关于 iOS 实现多继承的补充" class="title">关于 iOS 实现多继承的补充</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6844903544852758536" target="_blank" rel=""><div data-v-5380cbb8="">刚刚看到一篇文章介绍的是关于iOS多继承的实现，作者也是用NSProxy实现，但是和我之前的有些不一样，在这里做个补充。 我们可以看到这种方式写出来的不仅能调用类方法还能直接使用属性，感觉比之前的方法更为强大。</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">180</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            1
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6844903653090787336" data-original-type="1" data-draft-id="0" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/1327865773697112" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        Chars
      </div></a> <div data-v-5380cbb8="" class="date">4年前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/iOS" target="_blank" rel="" class="tag">
        iOS
      </a><a data-v-5380cbb8="" href="https://juejin.cn/tag/%E7%AE%97%E6%B3%95" target="_blank" rel="" class="tag">
        算法
      </a><a data-v-5380cbb8="" href="https://juejin.cn/tag/%E5%AE%89%E5%85%A8" target="_blank" rel="" class="tag">
        安全
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6844903653090787336" target="_blank" rel="" title="聊聊iOS数据保护" class="title">聊聊iOS数据保护</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6844903653090787336" target="_blank" rel=""><div data-v-5380cbb8="">我们应该在安全方面投入更多关注</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">1655</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            3
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="6971596472554881038" data-original-type="0" data-draft-id="6971324431826157605" class="entry" style="margin-bottom: 0px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/2840793775356989" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        Raindy酷酷的
      </div></a> <div data-v-5380cbb8="" class="date">1年前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/%E5%89%8D%E7%AB%AF" target="_blank" rel="" class="tag">
        前端
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/6971596472554881038" target="_blank" rel="" title="iOS 系统内存开辟分析" class="title">iOS 系统内存开辟分析</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/6971596472554881038" target="_blank" rel=""><div data-v-5380cbb8="">案例1 - 结构体内存对齐 定义三个结构体，前二者拥有的数据类型是一致的，sizeof(struct)是否一样呢？ 执行NSLog(@"%lu-%lu-%lu",sizeof(struct1),siz</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">214</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            2
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-57c9777c="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-5380cbb8="" data-v-805bdd7e="" data-v-57c9777c="" data-entry-id="7195489874422513701" data-original-type="0" data-draft-id="7193613611791548476" class="entry" style="margin-bottom: 20px;"><div data-v-5380cbb8="" class="meta-container"><a data-v-5380cbb8="" href="https://juejin.cn/user/3685218708888429" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-1120b3da="" data-v-5380cbb8="" class="popover-box user-popover"><!---->  
        podongfeng
      </div></a> <div data-v-5380cbb8="" class="date">29天前</div> <div data-v-5380cbb8="" class="tag_list"><a data-v-5380cbb8="" href="https://juejin.cn/tag/%E6%8E%98%E9%87%91%C2%B7%E6%97%A5%E6%96%B0%E8%AE%A1%E5%88%92" target="_blank" rel="" class="tag">
        掘金·日新计划
      </a><a data-v-5380cbb8="" href="https://juejin.cn/tag/Java" target="_blank" rel="" class="tag">
        Java
      </a></div></div> <div data-v-5380cbb8="" class="content-wrapper" style="border-bottom: 0px;"><div data-v-5380cbb8="" class="content-main"><div data-v-5380cbb8="" class="title-row"> <!----> <!----> <!----> <a data-v-5380cbb8="" href="https://juejin.cn/post/7195489874422513701" target="_blank" rel="" title="BigDecimal二三事" class="title">BigDecimal二三事</a></div> <div data-v-5380cbb8="" class="abstract"><a data-v-5380cbb8="" href="https://juejin.cn/post/7195489874422513701" target="_blank" rel=""><div data-v-5380cbb8="">概述 作为JAVA程序员，应该或多或少跟BigDecimal打过交道。JAVA在java.math包中提供的API类BigDecimal，用来对超过16位有效位的数进行精确的运算。 精度丢失 先从1个</div></a></div> <ul data-v-5380cbb8="" class="action-list jh-timeline-action-area"><li data-v-5380cbb8="" class="item view"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">948</span></li> <li data-v-5380cbb8="" class="item like"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            16
          </span></li> <li data-v-5380cbb8="" class="item comment"><i data-v-5380cbb8=""></i> <span data-v-5380cbb8="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li></div></div> <div data-v-65e9deb8="" data-v-1c9ebbff="" class="recommended-links main-area" data-v-4b9f9746=""><p data-v-65e9deb8="">友情链接：</p> <ul data-v-65e9deb8=""><li data-v-65e9deb8=""><a data-v-65e9deb8="" href="https://frontend.devrank.cn/traffic-aggregation/273597" title="java json日期格式化" target="_blank" rel="noopener noreferrer">
        java json日期格式化
      </a></li><li data-v-65e9deb8=""><a data-v-65e9deb8="" href="https://frontend.devrank.cn/traffic-aggregation/273600" title="react实战教程" target="_blank" rel="noopener noreferrer">
        react实战教程
      </a></li><li data-v-65e9deb8=""><a data-v-65e9deb8="" href="https://frontend.devrank.cn/traffic-aggregation/273601" title="node 更新依赖" target="_blank" rel="noopener noreferrer">
        node 更新依赖
      </a></li><li data-v-65e9deb8=""><a data-v-65e9deb8="" href="https://frontend.devrank.cn/traffic-aggregation/273603" title="js 正则表达 空格" target="_blank" rel="noopener noreferrer">
        js 正则表达 空格
      </a></li><li data-v-65e9deb8=""><a data-v-65e9deb8="" href="https://frontend.devrank.cn/traffic-aggregation/273590" title="jsp登录和注册模板" target="_blank" rel="noopener noreferrer">
        jsp登录和注册模板
      </a></li><li data-v-65e9deb8=""><a data-v-65e9deb8="" href="https://frontend.devrank.cn/traffic-aggregation/273617" title="js 文件夹特效" target="_blank" rel="noopener noreferrer">
        js 文件夹特效
      </a></li></ul></div> <div data-v-65597ac0="" data-v-1c9ebbff="" st:block="sidebar" class="sidebar sidebar" data-v-4b9f9746=""><div data-v-71f2d09e="" data-v-bdf6e7fa="" data-v-65597ac0="" class="sidebar-block author-block pure"><a data-v-bdf6e7fa="" href="https://juejin.cn/user/3016715633959592" target="_blank" rel="" class="user-item item" data-v-71f2d09e=""><img data-v-248050e4="" data-v-0b45085c="" data-v-bdf6e7fa="" src="./iOS内存二三事 - 掘金_files/1627085161a3210c_tplv-t2oaga2asx-no-mark_100_100_100_100.awebp" alt="" class="lazy avatar avatar" loading="lazy"> <div data-v-bdf6e7fa="" class="info-box"><a data-v-68a20f0a="" data-v-bdf6e7fa="" href="https://juejin.cn/user/3016715633959592" target="_blank" rel="" class="username"><span data-v-68a20f0a="" class="name" style="max-width: 128px;">
      南华Coder
    </span> <span data-v-3c1a13dc="" data-v-68a20f0a="" blank="true" class="rank"><img data-v-248050e4="" data-v-3c1a13dc="" src="./iOS内存二三事 - 掘金_files/05be64d75fee4dbdb290ba23afd21fcf_tplv-k3u1fbpfcp-no-mark_0_0_0_0.awebp" alt="lv-4" class="lazy" title="创作等级" loading="lazy"></span> <!----> <!----> </a> <div data-v-bdf6e7fa="" title="程序猿" class="position">
        程序猿
      </div></div></a> <div data-v-bdf6e7fa="" data-v-71f2d09e="" class="operate-btn"><button data-v-2afc21b6="" data-v-bdf6e7fa="" class="ui-btn follow-btn primary large default attention" st:name="followBtn" data-v-71f2d09e=""><!----> 
    关注
  </button> <a data-v-11443840="" data-v-bdf6e7fa="" href="https://juejin.cn/notification/im?participantId=3016715633959592" class="im-button im-btn" data-v-71f2d09e=""><!----> <div data-v-11443840="">私信</div></a></div> <div data-v-bdf6e7fa="" data-v-71f2d09e="" class="cut-off"></div>  <div data-v-bdf6e7fa="" data-v-71f2d09e="" class="stat-item item"><svg data-v-bdf6e7fa="" data-v-71f2d09e="" xmlns="http://www.w3.org/2000/svg" width="25" height="26" viewBox="0 0 25 26" class="zan"><g data-v-bdf6e7fa="" data-v-71f2d09e="" fill="none" fill-rule="evenodd" transform="translate(0 .57)"><ellipse data-v-bdf6e7fa="" data-v-71f2d09e="" cx="12.5" cy="12.57" fill="#E1EFFF" rx="12.5" ry="12.57"></ellipse><path data-v-bdf6e7fa="" data-v-71f2d09e="" fill="#7BB9FF" d="M8.596 11.238V19H7.033C6.463 19 6 18.465 6 17.807v-5.282c0-.685.483-1.287 1.033-1.287h1.563zm4.275-4.156A1.284 1.284 0 0 1 14.156 6c.885.016 1.412.722 1.595 1.07.334.638.343 1.687.114 2.361-.207.61-.687 1.412-.687 1.412h3.596c.38 0 .733.178.969.488.239.317.318.728.21 1.102l-1.628 5.645a1.245 1.245 0 0 1-1.192.922h-7.068v-7.889c1.624-.336 2.623-2.866 2.806-4.029z"></path></g></svg> <span data-v-bdf6e7fa="" data-v-71f2d09e="" class="content">
      获得点赞
      <span data-v-bdf6e7fa="" data-v-71f2d09e="" class="count">&nbsp;642</span></span></div> <div data-v-bdf6e7fa="" data-v-71f2d09e="" class="stat-item item"><svg data-v-bdf6e7fa="" data-v-71f2d09e="" width="25" height="25" viewBox="0 0 25 25" class="icon stat-view-icon"><g data-v-bdf6e7fa="" data-v-71f2d09e="" fill="none" fill-rule="evenodd"><circle data-v-bdf6e7fa="" data-v-71f2d09e="" cx="12.5" cy="12.5" r="12.5" fill="#E1EFFF"></circle><path data-v-bdf6e7fa="" data-v-71f2d09e="" fill="#7BB9FF" d="M4 12.5S6.917 7 12.75 7s8.75 5.5 8.75 5.5-2.917 5.5-8.75 5.5S4 12.5 4 12.5zm8.75 2.292c1.208 0 2.188-1.026 2.188-2.292 0-1.266-.98-2.292-2.188-2.292-1.208 0-2.188 1.026-2.188 2.292 0 1.266.98 2.292 2.188 2.292z"></path></g></svg> <span data-v-bdf6e7fa="" data-v-71f2d09e="" class="content">
      文章被阅读
      <span data-v-bdf6e7fa="" data-v-71f2d09e="" class="count">&nbsp;124,074</span></span></div> <!----></div> <!----> <a data-v-65597ac0="" href="https://juejin.cn/user/center/signin?from=item" target="" rel=""></a> <div data-v-71f2d09e="" data-v-7571c026="" data-v-65597ac0="" class="sidebar-block wechat-sidebar-block pure"><div data-v-19814543="" data-v-7571c026="" class="wechat-banner" data-v-71f2d09e=""><img data-v-19814543="" src="./iOS内存二三事 - 掘金_files/default.640d9a7.png" loading="lazy" class="wechat-img square"></div> <div data-v-7571c026="" data-v-71f2d09e="" title="关闭" class="close-btn"><i data-v-7571c026="" class="byte-icon byte-icon--close-circle" data-v-71f2d09e=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path fill="none" d="M0 0h48v48H0z"></path><path d="M24 2c12.2 0 22 9.8 22 22s-9.8 22-22 22S2 36.2 2 24 11.8 2 24 2zm0 4C14.1 6 6 14.1 6 24s8.1 18 18 18 18-8.1 18-18S33.9 6 24 6zm-4.9 10.2l4.9 4.9 5-4.9c.4-.4 1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4l-5 4.9 5 5c.4.4.4 1 0 1.4l-1.4 1.4c-.4.4-1 .4-1.4 0l-5-5-4.9 5c-.4.4-1 .4-1.4 0l-1.4-1.4c-.4-.4-.4-1 0-1.4l4.9-5-4.9-4.9c-.4-.4-.4-1 0-1.4l1.4-1.4c.3-.4 1-.4 1.4 0z"></path></svg></i></div></div> <div data-v-71f2d09e="" data-v-17139de4="" data-v-65597ac0="" class="sidebar-block related-entry-sidebar-block shadow" st:block="relatedEntrySidebarBlock"><div data-v-71f2d09e="" class="block-title">相关文章</div> <div data-v-71f2d09e="" class="block-body"><div data-v-17139de4="" data-v-71f2d09e="" class="entry-list"><a data-v-17139de4="" href="https://juejin.cn/post/6844903505497423879" target="_blank" rel="" st:name="link" title="大麦网技术二三事" class="item" data-v-71f2d09e=""><div data-v-17139de4="" class="entry-title">大麦网技术二三事</div> <div data-v-17139de4="" class="entry-meta-box"><div data-v-17139de4="" class="entry-meta">224点赞</div> <div data-v-17139de4="" class="entry-meta">&nbsp;·&nbsp;</div> <div data-v-17139de4="" class="entry-meta">49评论</div></div></a><a data-v-17139de4="" href="https://juejin.cn/post/7123841673150332935" target="_blank" rel="" st:name="link" title="租房二三事" class="item" data-v-71f2d09e=""><div data-v-17139de4="" class="entry-title">租房二三事</div> <div data-v-17139de4="" class="entry-meta-box"><div data-v-17139de4="" class="entry-meta">66点赞</div> <div data-v-17139de4="" class="entry-meta">&nbsp;·&nbsp;</div> <div data-v-17139de4="" class="entry-meta">31评论</div></div></a><a data-v-17139de4="" href="https://juejin.cn/post/6844903830409183239" target="_blank" rel="" st:name="link" title="JS 异步错误捕获二三事" class="item" data-v-71f2d09e=""><div data-v-17139de4="" class="entry-title">JS 异步错误捕获二三事</div> <div data-v-17139de4="" class="entry-meta-box"><div data-v-17139de4="" class="entry-meta">126点赞</div> <div data-v-17139de4="" class="entry-meta">&nbsp;·&nbsp;</div> <div data-v-17139de4="" class="entry-meta">9评论</div></div></a><a data-v-17139de4="" href="https://juejin.cn/post/6844903741104078861" target="_blank" rel="" st:name="link" title="内存二三事: Xcode 内存图、Instruments  可视化检测循环引用" class="item" data-v-71f2d09e=""><div data-v-17139de4="" class="entry-title">内存二三事: Xcode 内存图、Instruments  可视化检测循环引用</div> <div data-v-17139de4="" class="entry-meta-box"><div data-v-17139de4="" class="entry-meta">35点赞</div> <div data-v-17139de4="" class="entry-meta">&nbsp;·&nbsp;</div> <div data-v-17139de4="" class="entry-meta">2评论</div></div></a><a data-v-17139de4="" href="https://juejin.cn/post/7003165795857465374" target="_blank" rel="" st:name="link" title="MySQL空间数据存储及函数" class="item" data-v-71f2d09e=""><div data-v-17139de4="" class="entry-title">MySQL空间数据存储及函数</div> <div data-v-17139de4="" class="entry-meta-box"><div data-v-17139de4="" class="entry-meta">23点赞</div> <div data-v-17139de4="" class="entry-meta">&nbsp;·&nbsp;</div> <div data-v-17139de4="" class="entry-meta">7评论</div></div></a></div></div></div> <div data-v-65597ac0="" class="sticky-block-box"><div data-v-71f2d09e="" data-v-65597ac0="" class="sidebar-block catalog-block catalog-block pure isExpand" style=""><nav data-v-21dfbf50="" class="article-catalog" data-v-71f2d09e="" style=""><div data-v-21dfbf50="" class="catalog-title">目录</div> <div data-v-21dfbf50="" class="catalog-body"><ul data-v-21dfbf50="" class="catalog-list" style="margin-top: 0px;"><li data-v-21dfbf50="" class="item d1 active"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-0" title="一、内存基础概念" class="catalog-aTag">
      一、内存基础概念
    </a></div> <ul class="sub-list"><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-1" title="1、物理内存 &amp; 虚拟内存" class="catalog-aTag">
      1、物理内存 &amp; 虚拟内存
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-2" title="2、段页式存储" class="catalog-aTag">
      2、段页式存储
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-3" title="3、Swap In/Out &amp; Page In/Out" class="catalog-aTag">
      3、Swap In/Out &amp; Page In/Out
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-4" title="4、to be continued" class="catalog-aTag">
      4、to be continued
    </a></div> <!----></li></ul></li><li data-v-21dfbf50="" class="item d1"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-5" title="二、iOS内存管理基础概念" class="catalog-aTag">
      二、iOS内存管理基础概念
    </a></div> <ul class="sub-list"><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-6" title="1、iOS的内存分区" class="catalog-aTag">
      1、iOS的内存分区
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-7" title="2、内存页类型：Clean和Dirty" class="catalog-aTag">
      2、内存页类型：Clean和Dirty
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-8" title="3、VM Region" class="catalog-aTag">
      3、VM Region
    </a></div> <!----></li></ul></li><li data-v-21dfbf50="" class="item d1"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-9" title="三、iOS内存管理机制" class="catalog-aTag">
      三、iOS内存管理机制
    </a></div> <ul class="sub-list"><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-10" title="1、OC的内存管理" class="catalog-aTag">
      1、OC的内存管理
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-11" title="2、系统内存分类" class="catalog-aTag">
      2、系统内存分类
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-12" title="3、Jetsam机制" class="catalog-aTag">
      3、Jetsam机制
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-13" title="4、内存警告" class="catalog-aTag">
      4、内存警告
    </a></div> <!----></li></ul></li><li data-v-21dfbf50="" class="item d1"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-14" title="四、常见的内存类问题" class="catalog-aTag">
      四、常见的内存类问题
    </a></div> <ul class="sub-list"><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-15" title="1、FOOM" class="catalog-aTag">
      1、FOOM
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-16" title="2、内存泄露" class="catalog-aTag">
      2、内存泄露
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-17" title="3、WKWebview白屏" class="catalog-aTag">
      3、WKWebview白屏
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-18" title="4、野指针问题" class="catalog-aTag">
      4、野指针问题
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-19" title="5、iOS 10 nano_free Crash" class="catalog-aTag">
      5、iOS 10 nano_free Crash
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-20" title="6、to be continued" class="catalog-aTag">
      6、to be continued
    </a></div> <!----></li></ul></li><li data-v-21dfbf50="" class="item d1"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-21" title="五、优化内存使用" class="catalog-aTag">
      五、优化内存使用
    </a></div> <ul class="sub-list"><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-22" title="1、降低图片解码和渲染开销" class="catalog-aTag">
      1、降低图片解码和渲染开销
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-23" title="2、其他降低内存峰值办法" class="catalog-aTag">
      2、其他降低内存峰值办法
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-24" title="3、避免循环引用，减少内存泄露" class="catalog-aTag">
      3、避免循环引用，减少内存泄露
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-25" title="4、处理内存警告" class="catalog-aTag">
      4、处理内存警告
    </a></div> <!----></li></ul></li><li data-v-21dfbf50="" class="item d1"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-26" title="历史文章" class="catalog-aTag">
      历史文章
    </a></div> <!----></li><li data-v-21dfbf50="" class="item d1"><div class="a-container"><a href="https://juejin.cn/post/6844904119723884551#heading-27" title="参考文章" class="catalog-aTag">
      参考文章
    </a></div> <!----></li></ul></div></nav></div> <!----></div></div> <div data-v-fe76cb40="" data-v-1c9ebbff="" class="article-suspended-panel article-suspended-panel"><svg data-v-fe76cb40="" xmlns="http://www.w3.org/2000/svg" class="" style="display: none;"><symbol data-v-fe76cb40="" id="icon-collect" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path data-v-fe76cb40="" fill-rule="evenodd" clip-rule="evenodd" d="M5.24287 18.3845C4.89724 18.5507 4.48229 18.4053 4.31605 18.0596C4.26029 17.9437 4.23783 17.8146 4.25117 17.6866L4.75725 12.8332C4.77762 12.6379 4.71431 12.443 4.583 12.297L1.29207 8.63594C1.03567 8.35071 1.05905 7.91164 1.34428 7.65524C1.43464 7.574 1.54475 7.5179 1.66358 7.49254L6.47789 6.46509C6.66998 6.42409 6.83572 6.30367 6.93407 6.13365L9.39894 1.87248C9.59098 1.54049 10.0158 1.42704 10.3478 1.61907C10.453 1.67992 10.5403 1.76729 10.6012 1.87248L13.0661 6.13365C13.1644 6.30367 13.3301 6.42409 13.5222 6.46509L18.3365 7.49254C18.7116 7.57259 18.9508 7.94155 18.8707 8.31664C18.8454 8.43547 18.7893 8.54557 18.708 8.63594L15.4171 12.297C15.2858 12.443 15.2225 12.6379 15.2429 12.8332L15.7489 17.6866C15.7887 18.0681 15.5117 18.4096 15.1303 18.4493C15.0023 18.4627 14.8732 18.4402 14.7572 18.3845L10.3011 16.2412C10.1108 16.1497 9.8893 16.1497 9.69906 16.2412L5.24287 18.3845Z"></path></symbol><symbol data-v-fe76cb40="" id="icon-comment" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path data-v-fe76cb40="" fill-rule="evenodd" clip-rule="evenodd" d="M4.62739 1.25C2.9347 1.25 1.5625 2.6222 1.5625 4.31489L1.56396 12.643C1.56403 14.3356 2.9362 15.7078 4.62885 15.7078H6.48326L6.93691 17.6869L6.93884 17.6948C7.16894 18.6441 8.28598 19.0599 9.08073 18.4921L12.7965 15.7078H15.5001C17.1928 15.7078 18.565 14.3355 18.565 12.6428L18.5635 4.31477C18.5635 2.62213 17.1913 1.25 15.4986 1.25H4.62739ZM5.98265 9.89255C6.68783 9.89255 7.2595 9.32089 7.2595 8.61571C7.2595 7.91053 6.68783 7.33887 5.98265 7.33887C5.27747 7.33887 4.70581 7.91053 4.70581 8.61571C4.70581 9.32089 5.27747 9.89255 5.98265 9.89255ZM9.95604 9.89255C10.6612 9.89255 11.2329 9.32089 11.2329 8.61571C11.2329 7.91053 10.6612 7.33887 9.95604 7.33887C9.25086 7.33887 8.6792 7.91053 8.6792 8.61571C8.6792 9.32089 9.25086 9.89255 9.95604 9.89255ZM15.2124 8.61571C15.2124 9.32089 14.6407 9.89255 13.9355 9.89255C13.2304 9.89255 12.6587 9.32089 12.6587 8.61571C12.6587 7.91053 13.2304 7.33887 13.9355 7.33887C14.6407 7.33887 15.2124 7.91053 15.2124 8.61571Z"></path></symbol><symbol data-v-fe76cb40="" id="icon-zan" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path data-v-fe76cb40="" fill-rule="evenodd" clip-rule="evenodd" d="M13.0651 3.25923C12.6654 2.21523 12.1276 1.60359 11.4633 1.40559C10.8071 1.21 10.2539 1.48626 9.97848 1.67918C9.43962 2.05668 9.17297 2.64897 9.0009 3.12662C8.93522 3.30893 8.87504 3.50032 8.82077 3.67291L8.82077 3.67292C8.80276 3.73019 8.78541 3.78539 8.76872 3.8375C8.6974 4.06017 8.63455 4.23905 8.56561 4.38315C8.07104 5.41687 7.64014 6.034 7.2617 6.43277C6.89154 6.8228 6.5498 7.0275 6.18413 7.21038C5.8887 7.35813 5.69369 7.66144 5.69365 8.00211L5.69237 17.3908C5.6923 17.8783 6.08754 18.2736 6.57511 18.2736H14.8382C15.2621 18.2736 15.5829 18.1393 15.8149 17.9421C15.9234 17.8497 15.9985 17.7554 16.0484 17.6856C16.0695 17.6561 16.088 17.6282 16.0983 17.6126L16.1017 17.6075L16.1033 17.6051L16.1194 17.5857L16.1428 17.5478C16.913 16.3019 17.4472 15.3088 17.8659 14.1183C18.3431 12.7613 18.5849 11.5853 18.6874 10.6685C18.7871 9.77617 18.7612 9.07318 18.6558 8.68779C18.5062 8.14118 18.138 7.82653 17.7668 7.66617C17.4231 7.51771 17.0763 7.49836 16.8785 7.49807L13.1134 7.44551C13.662 5.19751 13.31 3.89889 13.0651 3.25923ZM1.251 8.0848C1.22726 7.5815 1.62891 7.16046 2.13277 7.16046H3.4408C3.92832 7.16046 4.32354 7.55568 4.32354 8.04321V17.4303C4.32354 17.9178 3.92832 18.313 3.4408 18.313H2.57554C2.10419 18.313 1.71599 17.9427 1.69378 17.4718L1.251 8.0848Z"></path></symbol><symbol data-v-fe76cb40="" id="icon-share" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path data-v-fe76cb40="" fill-rule="evenodd" clip-rule="evenodd" d="M10.4167 6.40399C5.35406 6.40399 1.25 10.5675 1.25 15.7035C1.25 16.0225 1.28448 16.4512 1.35344 16.9898C1.36807 17.1039 1.47243 17.1846 1.58655 17.17C1.6483 17.1621 1.70328 17.127 1.73643 17.0743L1.86865 16.8676C1.99553 16.6731 2.10644 16.5147 2.20137 16.3925C3.69554 14.4692 6.13777 13.3823 9.35515 13.3378L10.4167 13.3364V17.0757C10.4167 17.3101 10.6086 17.5 10.8453 17.5C10.959 17.5 11.068 17.4553 11.1483 17.3757L18.145 10.45C18.3961 10.2015 18.3961 9.79853 18.145 9.55L11.1483 2.62426C10.981 2.45858 10.7096 2.45858 10.5422 2.62426C10.4618 2.70383 10.4167 2.81174 10.4167 2.92426V6.40399Z"></path></symbol><symbol data-v-fe76cb40="" id="icon-report" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path data-v-fe76cb40="" fill-rule="evenodd" clip-rule="evenodd" d="M10.8389 1.89381C11.0873 2.03868 11.2939 2.24532 11.4388 2.49366L18.9369 15.0065C19.4007 15.8015 19.1322 16.8221 18.3371 17.2859C18.0822 17.4346 17.7924 17.5129 17.4973 17.5129H2.50041C1.57993 17.5129 0.83374 16.7667 0.83374 15.8462C0.83374 15.5512 0.912088 15.2614 1.06078 15.0065L8.5595 2.49366C9.0233 1.69857 10.0438 1.43001 10.8389 1.89381ZM10.3118 13.3459C10.6283 13.3459 10.8848 13.6025 10.8848 13.9189V14.4918C10.8848 14.8082 10.6283 15.0647 10.3118 15.0647H9.73893C9.42252 15.0647 9.16602 14.8082 9.16602 14.4918V13.9189C9.16602 13.6025 9.42252 13.3459 9.73893 13.3459H10.3118ZM10.8356 7.09513C10.8356 6.86502 10.6491 6.67847 10.419 6.67847H9.58512C9.35501 6.67847 9.16846 6.86502 9.16846 7.09513V12.0956C9.16846 12.3257 9.35501 12.5123 9.58512 12.5123H10.419C10.6491 12.5123 10.8356 12.3257 10.8356 12.0956V7.09513Z"></path></symbol><symbol data-v-fe76cb40="" id="icon-immerse" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path data-v-fe76cb40="" fill-rule="evenodd" clip-rule="evenodd" d="M0.25 1C0.25 0.585786 0.585786 0.25 1 0.25H4C4.41421 0.25 4.75 0.585786 4.75 1C4.75 1.41421 4.41421 1.75 4 1.75H1.75V4C1.75 4.41421 1.41421 4.75 1 4.75C0.585786 4.75 0.25 4.41421 0.25 4V1ZM0.25 19C0.25 19.4142 0.585786 19.75 1 19.75H4C4.41421 19.75 4.75 19.4142 4.75 19C4.75 18.5858 4.41421 18.25 4 18.25H1.75V16C1.75 15.5858 1.41421 15.25 1 15.25C0.585786 15.25 0.25 15.5858 0.25 16V19ZM19 0.25C19.4142 0.25 19.75 0.585786 19.75 1V4C19.75 4.41421 19.4142 4.75 19 4.75C18.5858 4.75 18.25 4.41421 18.25 4V1.75H16C15.5858 1.75 15.25 1.41421 15.25 1C15.25 0.585786 15.5858 0.25 16 0.25H19ZM19.75 19C19.75 19.4142 19.4142 19.75 19 19.75H16C15.5858 19.75 15.25 19.4142 15.25 19C15.25 18.5858 15.5858 18.25 16 18.25H18.25V16C18.25 15.5858 18.5858 15.25 19 15.25C19.4142 15.25 19.75 15.5858 19.75 16V19ZM7 5C5.89543 5 5 5.89543 5 7V13C5 14.1046 5.89543 15 7 15H13C14.1046 15 15 14.1046 15 13V7C15 5.89543 14.1046 5 13 5H7Z"></path></symbol><symbol data-v-fe76cb40="" id="icon-wechat" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path data-v-fe76cb40="" fill-rule="evenodd" clip-rule="evenodd" d="M13.5578 5.34061C12.0476 2.85722 8.90911 1.73257 6.11813 2.05358C4.56413 2.23231 3.0449 2.85861 1.88463 3.92471C1.00689 4.72863 0.354462 5.78486 0.109889 6.95889C-0.187864 8.37395 0.125815 9.85314 0.957723 11.0298C1.28982 11.4994 1.68479 11.9193 2.11951 12.2941C2.25136 12.4079 2.38694 12.5172 2.52543 12.6228C2.59301 12.6742 2.66115 12.7249 2.73011 12.7745C2.74195 12.7831 2.75392 12.7902 2.76512 12.7969C2.80389 12.8201 2.83351 12.8378 2.81653 12.8887L2.67458 13.3177C2.53986 13.7252 2.40492 14.1325 2.26998 14.5399C2.22084 14.6883 2.17169 14.8366 2.12256 14.985L2.61572 14.7368C2.85714 14.6151 3.09863 14.4935 3.34012 14.3719C3.58099 14.2507 3.82186 14.1294 4.06266 14.0081L4.40902 13.8337C4.42474 13.8257 4.44104 13.8164 4.45775 13.8069C4.51759 13.7728 4.58265 13.7356 4.64501 13.7481C4.76613 13.7723 4.88708 13.7972 5.00801 13.8221C5.08094 13.8372 5.15386 13.8522 5.22681 13.867C6.06287 14.0373 6.88508 14.1348 7.73859 14.0675C7.4486 13.0669 7.44915 12.0016 7.7559 11.0045C8.09853 9.88624 8.81438 8.89831 9.74448 8.19773C11.0171 7.23915 12.6431 6.81493 14.2212 6.99199C14.0895 6.4081 13.8688 5.85148 13.5578 5.34061ZM4.77922 5.02147C4.28094 5.02147 3.71299 5.35514 3.71299 5.90829C3.71299 6.46088 4.28066 6.79844 4.77922 6.79844C5.29233 6.79844 5.66293 6.42291 5.66293 5.90829C5.66293 5.39311 5.29205 5.02147 4.77922 5.02147ZM10.6158 5.90829C10.6158 6.42444 10.2434 6.79844 9.7296 6.79844C9.23076 6.79844 8.66641 6.46032 8.66641 5.90829C8.66641 5.3557 9.23104 5.02147 9.7296 5.02147C10.2431 5.02147 10.6158 5.39158 10.6158 5.90829ZM17.7911 8.53846C15.3552 6.80489 11.734 6.93368 9.53048 9.01108C8.77779 9.72181 8.22909 10.6485 8.04061 11.6744C7.78288 13.0799 8.22536 14.5441 9.17304 15.605C10.0674 16.6063 11.2889 17.2564 12.5986 17.5166C13.4216 17.6806 14.2559 17.6931 15.0799 17.5344C15.2863 17.4948 15.4911 17.4481 15.6954 17.3986C15.7826 17.3774 15.8697 17.3559 15.9568 17.334C15.9655 17.3319 15.9784 17.3272 15.9934 17.3219C16.0359 17.3068 16.0949 17.2858 16.118 17.2984C16.2476 17.3695 16.3771 17.4408 16.5066 17.5122L17.0557 17.8142L17.0577 17.8153L17.0598 17.8164C17.3912 17.9986 17.7227 18.1809 18.054 18.3634C17.9748 18.0977 17.895 17.832 17.8153 17.5664L17.8146 17.5641L17.6749 17.0981L17.5814 16.7863L17.5332 16.6257C17.5159 16.5675 17.5927 16.5183 17.6556 16.4779C17.6753 16.4653 17.6937 16.4535 17.7073 16.4426C18.0608 16.1622 18.3952 15.8558 18.6963 15.5191C19.1832 14.9747 19.5895 14.3498 19.8161 13.6505C20.0122 13.039 20.0488 12.392 19.9377 11.7604C19.7098 10.438 18.8643 9.30511 17.7911 8.53846ZM15.2396 11.0049C15.1595 10.6088 15.5334 10.1787 15.931 10.1787C16.3063 10.1787 16.7409 10.3931 16.8096 10.7989C16.8724 11.1695 16.556 11.4696 16.227 11.5617C15.8032 11.6802 15.3326 11.4649 15.2396 11.0049ZM12.0348 10.1787C11.6369 10.1787 11.2573 10.6064 11.3385 11.0049C11.4325 11.4667 11.9081 11.68 12.3327 11.5617C12.6626 11.4696 12.9753 11.1695 12.9134 10.7989C12.8453 10.3914 12.4112 10.1787 12.0348 10.1787Z"></path></symbol><symbol data-v-fe76cb40="" id="icon-weibo" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path data-v-fe76cb40="" fill-rule="evenodd" clip-rule="evenodd" d="M-0.000244141 13.0984C-0.000244141 8.70757 6.6145 3.5004 9.18008 4.57052C10.1717 4.98415 9.97381 6.1693 9.85415 6.88576C9.8069 7.16863 9.77186 7.37844 9.82705 7.43887C9.92921 7.55074 10.2955 7.42054 10.7994 7.2414C11.8362 6.87286 13.4557 6.2972 14.5566 7.19617C15.2665 7.77576 14.9657 8.72382 14.7905 9.27603C14.7289 9.4701 14.6829 9.61528 14.7017 9.6784C14.741 9.81053 14.9858 9.91133 15.317 10.0477C15.926 10.2984 16.8269 10.6692 17.2784 11.5759C18.3716 13.7713 15.2036 18.2504 8.62234 18.2504C3.25024 18.2504 -0.000244141 15.6688 -0.000244141 13.0984ZM8.45309 17.057C11.7733 16.7393 14.2944 14.7397 14.0842 12.5908C13.874 10.4418 11.012 8.95732 7.69179 9.27503C4.37159 9.59274 1.85045 11.5924 2.06068 13.7413C2.2709 15.8902 5.13288 17.3747 8.45309 17.057Z"></path><path data-v-fe76cb40="" fill-rule="evenodd" clip-rule="evenodd" d="M10.7098 12.7012C11.1162 14.1374 10.0604 15.6852 8.35157 16.1581C6.64275 16.6311 4.92801 15.8502 4.5216 14.4139C4.11518 12.9777 5.171 11.4299 6.87982 10.957C8.58865 10.484 10.3034 11.2649 10.7098 12.7012ZM7.67026 13.6265C7.89619 14.1072 7.61751 14.7092 7.04779 14.9711C6.47808 15.2331 5.83308 15.0558 5.60715 14.5751C5.38122 14.0945 5.6599 13.4925 6.22962 13.2306C6.79933 12.9686 7.44433 13.1459 7.67026 13.6265ZM8.41746 13.3766C8.63945 13.2745 8.74804 13.0399 8.66001 12.8526C8.57197 12.6654 8.32065 12.5963 8.09866 12.6984C7.87667 12.8004 7.76808 13.035 7.85612 13.2223C7.94415 13.4095 8.19547 13.4786 8.41746 13.3766Z"></path><path data-v-fe76cb40="" d="M13.648 3.54836C13.9523 3.47388 14.2712 3.43418 14.6004 3.43418C16.7813 3.43418 18.5492 5.18267 18.5492 7.33955C18.5492 7.81593 18.4633 8.27085 18.3066 8.69104C18.168 9.06261 18.3602 9.47493 18.7359 9.61199C19.1116 9.74904 19.5285 9.55894 19.6671 9.18737C19.8822 8.61063 19.9993 7.98781 19.9993 7.33955C19.9993 4.3906 17.5822 2 14.6004 2C14.1528 2 13.717 2.05403 13.2996 2.15619C12.9109 2.25133 12.6738 2.64011 12.77 3.02455C12.8662 3.40899 13.2593 3.6435 13.648 3.54836Z"></path><path data-v-fe76cb40="" d="M14.2887 6.05162C14.388 6.02824 14.4923 6.01569 14.6004 6.01569C15.3397 6.01569 15.939 6.6084 15.939 7.33955C15.939 7.49914 15.9108 7.65062 15.8596 7.7904C15.7232 8.16277 15.9179 8.57396 16.2944 8.70881C16.6709 8.84366 17.0867 8.65112 17.2231 8.27875C17.3307 7.98466 17.3891 7.66805 17.3891 7.33955C17.3891 5.81633 16.1406 4.58152 14.6004 4.58152C14.3784 4.58152 14.1614 4.60734 13.9529 4.65643C13.5633 4.74813 13.3227 5.1348 13.4154 5.52008C13.5082 5.90535 13.8991 6.14333 14.2887 6.05162Z"></path></symbol><symbol data-v-fe76cb40="" id="icon-qq" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path data-v-fe76cb40="" d="M11.8841 17.1943C11.1815 17.1943 10.5625 17.2136 10.0541 17.26C9.44625 17.2112 8.8365 17.1898 8.22671 17.1956C6.20498 17.1956 4.40588 17.9613 4.40588 18.5263C4.40588 19.0681 5.89998 19.0076 7.91657 18.987C8.64426 18.985 9.3699 18.9096 10.0824 18.7618C10.6796 18.8879 11.4079 18.9677 12.193 18.9741C14.2095 18.9947 15.7024 19.0552 15.7024 18.5173C15.7024 17.9549 13.9045 17.1943 11.8841 17.1943V17.1943Z"></path><path data-v-fe76cb40="" d="M16.9138 11.6311C16.5346 10.6112 16.1212 9.60428 15.6745 8.61206C15.6951 8.37141 15.7054 8.12818 15.7054 7.8811C15.7054 4.08086 13.7622 1 10.0649 1C6.36759 1 4.42307 4.08086 4.42307 7.8811C4.42307 8.11274 4.43208 8.34052 4.45138 8.56573C3.99804 9.5756 3.57913 10.6006 3.19536 11.6389C2.41678 13.7494 2.38203 15.6566 2.65357 15.7982C2.84661 15.8985 3.54797 15.1611 4.21845 13.9669C4.66115 16.7801 6.53102 18.8842 10.0649 18.8842C13.5871 18.8842 15.457 16.7916 15.9074 13.99C16.5728 15.1611 17.2664 15.8818 17.4569 15.7814C17.7284 15.6399 17.6937 13.7365 16.9138 11.6311V11.6311Z"></path><path data-v-fe76cb40="" d="M8.5542 3.2522C8.00598 3.26507 7.57358 3.90981 7.58902 4.69739C7.60447 5.48369 8.06132 6.11299 8.60954 6.1027C9.15776 6.0924 9.59016 5.44637 9.57472 4.65879C9.56056 3.87249 9.10243 3.24319 8.5542 3.25348V3.2522ZM11.5862 3.26764C11.0315 3.25734 10.5695 3.88278 10.5541 4.66651C10.5386 5.44895 10.9749 6.0924 11.5308 6.1027C12.0842 6.11299 12.5475 5.48755 12.5629 4.70512C12.5784 3.92139 12.1408 3.27794 11.5862 3.26764V3.26764Z"></path><path data-v-fe76cb40="" d="M13.6704 9.57861C12.5971 9.76521 11.354 9.87074 10.0285 9.87074C8.7287 9.87074 7.50742 9.76779 6.44959 9.58762C5.71605 10.4962 5.65942 11.8307 5.65942 13.3184C5.65942 16.0505 7.20371 18.2665 10.0645 18.2665C12.924 18.2665 14.4696 16.0505 14.4696 13.3184C14.4696 11.8243 14.4104 10.4859 13.6704 9.57861V9.57861Z"></path><path data-v-fe76cb40="" d="M10.0628 6.56616C8.14273 6.56616 6.58557 6.95223 6.58557 7.26238C6.58557 7.57124 8.62146 8.42188 10.0641 8.42188C11.5054 8.42188 13.5413 7.55065 13.5413 7.26238C13.5413 6.97411 11.9842 6.56745 10.0641 6.56745L10.0628 6.56616Z"></path><path data-v-fe76cb40="" d="M15.6744 8.6121L15.6757 8.59151C14.264 9.05866 12.2718 9.35078 10.0648 9.35078C7.8513 9.35078 5.85402 9.05737 4.441 8.58765C4.14115 9.25684 3.85546 9.93375 3.58521 10.6171C4.45644 10.9054 5.43192 11.1357 6.48332 11.2992V13.8858C6.48332 13.8858 7.22715 14.0235 7.92981 14.0531C8.42784 14.0737 8.95676 13.9888 8.95676 13.9888V11.5398C9.32095 11.5565 9.6903 11.5656 10.0635 11.5656C12.4919 11.5656 14.7311 11.2142 16.5251 10.6222C16.2566 9.94593 15.9729 9.27571 15.6744 8.6121V8.6121Z"></path><path data-v-fe76cb40="" d="M8.87981 4.24829C8.63787 4.24829 8.44226 4.53656 8.44226 4.89174C8.44226 5.24693 8.63787 5.5352 8.87981 5.5352C9.12046 5.5352 9.31736 5.24693 9.31736 4.89174C9.31736 4.53656 9.12046 4.24829 8.87981 4.24829V4.24829ZM12.0997 4.65624C12.0997 4.65624 11.9246 4.41816 11.4819 4.48122C11.0444 4.54428 10.8745 4.83126 10.8423 4.86215C10.8423 4.86215 10.7381 5.0243 10.8115 5.12467C10.8848 5.22505 11.0174 5.06676 11.0174 5.06676C11.0174 5.06676 11.2194 4.78364 11.4806 4.77335C11.6273 4.76349 11.7729 4.80489 11.8925 4.89046C11.8925 4.89046 12.0211 4.99856 12.0984 4.89046C12.1769 4.78364 12.0997 4.65624 12.0997 4.65624V4.65624Z"></path></symbol></svg> <div data-v-fe76cb40="" badge="54" class="panel-btn with-badge"><svg data-v-0f838daa="" data-v-fe76cb40="" class="sprite-icon icon-zan"><use data-v-0f838daa="" xlink:href="#icon-zan"></use></svg></div> <div data-v-fe76cb40="" badge="2" class="panel-btn with-badge"><svg data-v-0f838daa="" data-v-fe76cb40="" class="sprite-icon icon-comment"><use data-v-0f838daa="" xlink:href="#icon-comment"></use></svg></div> <div data-v-fe76cb40="" class="panel-btn"><svg data-v-0f838daa="" data-v-fe76cb40="" class="sprite-icon icon-collect"><use data-v-0f838daa="" xlink:href="#icon-collect"></use></svg> <div data-v-d0b73df6="" data-v-fe76cb40="" class="collect-popover"><div data-v-d0b73df6="" class="title">收藏成功！</div> <div data-v-d0b73df6="" class="sub-title">
    已添加到「」，
    <span data-v-d0b73df6="" class="modify-btn">点击更改</span></div></div> <!----> <!----></div> <div data-v-fe76cb40="" class="share-btn panel-btn"><svg data-v-0f838daa="" data-v-fe76cb40="" class="sprite-icon icon-share"><use data-v-0f838daa="" xlink:href="#icon-share"></use></svg> <div data-v-fe76cb40="" class="share-popup"><ul data-v-fe76cb40=""><li data-v-fe76cb40="" class="share-item wechat"><svg data-v-0f838daa="" data-v-fe76cb40="" class="sprite-icon share-icon icon-wechat"><use data-v-0f838daa="" xlink:href="#icon-wechat"></use></svg> <span data-v-fe76cb40="" class="share-item-title">微信</span> <div data-v-fe76cb40="" class="wechat-qrcode"><img data-v-fe76cb40="" src="https://juejin.cn/post/6844904119723884551" class="wechat-qrcode-img" style="display: none;"> <span data-v-fe76cb40="" class="wechat-qrcode-title">微信扫码分享</span></div></li> <li data-v-fe76cb40="" class="share-item weibo"><svg data-v-0f838daa="" data-v-fe76cb40="" class="sprite-icon share-icon icon-weibo"><use data-v-0f838daa="" xlink:href="#icon-weibo"></use></svg> <span data-v-fe76cb40="" class="share-item-title">新浪微博</span></li> <li data-v-fe76cb40="" class="share-item qq"><svg data-v-0f838daa="" data-v-fe76cb40="" class="sprite-icon share-icon icon-qq"><use data-v-0f838daa="" xlink:href="#icon-qq"></use></svg> <span data-v-fe76cb40="" class="share-item-title">QQ</span></li></ul></div></div> <div data-v-fe76cb40="" class="divider"></div> <div data-v-fe76cb40="" class="panel-btn"><svg data-v-0f838daa="" data-v-fe76cb40="" class="sprite-icon icon-report"><use data-v-0f838daa="" xlink:href="#icon-report"></use></svg></div> <span data-v-fe76cb40="" class="tooltip"><span class="byte-tooltip__wrapper"><div data-v-fe76cb40="" class="panel-btn"><svg data-v-0f838daa="" data-v-fe76cb40="" class="sprite-icon icon-immerse"><use data-v-0f838daa="" xlink:href="#icon-immerse"></use></svg></div></span></span></div></div> <!----></main> <!----></div> <!----> <div class="global-component-box"><div data-v-262fe4c6="" class="alert-list alert-list"></div> <div data-v-0b2d23d8="" class="suspension-panel suspension-panel"><!----> <button data-v-0b2d23d8="" title="回到顶部" class="btn to-top-btn" style="display: none;"><svg data-v-0b2d23d8="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class=""><path data-v-0b2d23d8="" fill-rule="evenodd" clip-rule="evenodd" d="M2.75 1C2.33579 1 2 1.33579 2 1.75C2 2.16421 2.33579 2.5 2.75 2.5H13.25C13.6642 2.5 14 2.16421 14 1.75C14 1.33579 13.6642 1 13.25 1H2.75ZM7.24407 3.87287C7.64284 3.41241 8.35716 3.41241 8.75593 3.87287L13.0622 8.84535C13.6231 9.49299 13.163 10.5 12.3063 10.5H10V14C10 14.5523 9.55228 15 9 15H7C6.44772 15 6 14.5523 6 14V10.5H3.69371C2.83696 10.5 2.37691 9.49299 2.93778 8.84535L7.24407 3.87287Z" fill="#8A919F"></path></svg></button> <button data-v-0b2d23d8="" title="建议反馈" class="btn meiqia-btn" style=""><svg data-v-0b2d23d8="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-feedback"><path data-v-0b2d23d8="" fill-rule="evenodd" clip-rule="evenodd" d="M1.8252 4.002C1.8252 2.80032 2.79935 1.82617 4.00102 1.82617H12.001C13.2027 1.82617 14.1768 2.80032 14.1768 4.002V9.71628C14.1768 10.918 13.2027 11.8921 12.001 11.8921H9.43308L6.92709 14.1281C6.4455 14.5578 5.68234 14.216 5.68234 13.5706V11.8921H4.00102C2.79934 11.8921 1.8252 10.918 1.8252 9.71628V4.002ZM11.2414 7.86753C11.3826 7.65526 11.3249 7.36878 11.1126 7.22764C10.9004 7.08651 10.6139 7.14417 10.4728 7.35643C9.94042 8.15705 9.03153 8.68309 7.99997 8.68309C6.96841 8.68309 6.05952 8.15705 5.52719 7.35643C5.38605 7.14417 5.09957 7.08651 4.88731 7.22764C4.67504 7.36878 4.61738 7.65526 4.75852 7.86753C5.45467 8.91452 6.64645 9.60617 7.99997 9.60617C9.35349 9.60617 10.5453 8.91452 11.2414 7.86753Z" fill="#1E80FF"></path></svg></button></div> <!----> <!----> <!----> <!----> <!----></div> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----></div></div></div><script>window.__NUXT__=(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F){q.loading=a;q.skeleton=b;q.cursor=f;q.data=[];q.total=d;q.hasMore=b;return {layout:"default",data:[{renderPost:b,additionalDataUseCSR:b}],fetch:[{bdPageUrlForNav:"https:\u002F\u002Fbd.juejin.cn?utm_campaign=bd&utm_source=web&utm_medium=nav",queryString:e,isShowUserDropdownList:a,isShowAddMoreList:a,isFocus:a,isPhoneMenuShow:a,visibleBadge:a,placeholder:e,hiddenProperty:"hidden",searchHistoryVisible:a,searchHistoryItems:[],tabBadge:c,isChangePlaceholder:b,showMallBridge:a},{articleBanner:{url:"https:\u002F\u002Fjuejin.cn\u002Fextension\u002F?utm_source=standalone&utm_medium=post&utm_campaign=extension_promotion",title:"安装掘金浏览器插件",content:"多内容聚合浏览、多引擎快捷搜索、多工具便捷提效、多模式随心畅享，你想要的，这里都有！"},showExtension:b}],error:c,state:{view:{activityIndex:{activityList:[],pageInfo:{hasNextPage:a,endCursor:e},afterPosition:e,activityListIsLoading:b,activityListIsError:a,userActivityList:[],placeholder:e,actionType:{FETCH:"@\u002Fview\u002Factivity-index\u002FFETCH",FETCH_RECOMMEND_LIST:"@\u002Fview\u002Factivity-index\u002FFETCH_RECOMMEND_LIST",RESET_ACTIVITY_LIST:"@\u002Fview\u002Factivity-index\u002FRESET_ACTIVITY_LIST",FETCH_USER_ACTIVITY_LIST:"@\u002Fview\u002Factivity-index\u002FFETCH_USER_ACTIVITY_LIST",FETCH_NEW_COUNT:"@\u002Fview\u002Factivity-index\u002FFETCH_NEW_COUNT",DELETE_ACTIVITY:"@\u002Fview\u002Factivity-index\u002FDELETE_ACTIVITY",TOGGLE_FOLLOW_USER:"@\u002Fview\u002Factivity-index\u002FTOGGLE_FOLLOW_USER",FETCH_ENTRY_COMMENT_LIST:"@\u002Fview\u002Factivity-index\u002FFETCH_ENTRY_COMMENT_LIST",UPDATE_LIST_LOADING:"@\u002Fview\u002Factivity-index\u002FUPDATE_LIST_LOADING",RESET:"@\u002Fview\u002Factivity-index\u002FRESET"},hotList:{list:[],after:e,loading:a,hasNextPage:a,actionType:{UPDATE_STATE:"@\u002Fview\u002Factivity-index\u002Fhot-list\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Fhot-list\u002FFETCH_MORE",FETCH:"@\u002Fview\u002Factivity-index\u002Fhot-list\u002FFETCH",RESET:"@\u002Fview\u002Factivity-index\u002Fhot-list\u002FRESET"}},sidebar:{bannerList:[],actionType:{RESET:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002FRESET",UPDATE_STATE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002FUPDATE_STATE",FETCH_BANNER:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002FFETCH_BANNER"},recommend:{pageSize:h,page:d,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FUPDATE",FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FFETCH_MORE",RESET:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FRESET"},after:d},followed:{pageSize:h,page:d,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FUPDATE",FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FFETCH_MORE",RESET:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FRESET"},after:d},recommendPin:{list:[],after:e,loading:a,hasNextPage:b,actionType:{UPDATE_STATE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-pin-list\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-pin-list\u002FFETCH_MORE",FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-pin-list\u002FFETCH",RESET:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-pin-list\u002FRESET"}}},topicPinList:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FUPDATE",FETCH:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FFETCH_MORE",RESET:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FRESET"},topicId:e,navList:[{type:k,name:k,title:"推荐 ",id:k},{type:m,name:m,title:"热门 ",id:m},{type:o,name:o,title:"关注 ",id:o},{type:i,name:"opensource",title:"开源推荐 ",id:"5c09ea2b092dcb42c740fe73"},{type:i,name:"recruitment",title:"内推招聘",id:"5abb61e1092dcb4620ca3322"},{type:i,name:"dating",title:"掘金相亲",id:"5abcaa67092dcb4620ca335c"},{type:i,name:"slacking",title:"上班摸鱼",id:"5c106be9092dcb2cc5de7257"},{type:i,name:"app",title:"应用安利",id:"5b514af1092dcb61bd72800d"},{type:i,name:"tool",title:"开发工具",id:"5abb67d2092dcb4620ca3324"},{type:i,name:"news",title:"New资讯",id:"5c46a17f092dcb4737217152"}],sortType:p}},search:{search_result_from:d,query:e,list:[],linkList:[],loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fsearch\u002FFETCH",FETCH_MORE:"@\u002Fview\u002Fsearch\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fsearch\u002FRESET"}},columnIndex:{list:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FUPDATE",FETCH:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FFETCH_MORE",RESET:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FRESET"},sort:n,category:"all"},hotList:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FUPDATE",FETCH:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FFETCH_MORE",RESET:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FRESET"}}},timelineIndex:{tdkTemplates:[],categoryNavList:[],tagNavList:[],splitTagList:[],timelineAdList:[],list:[],sort:p,category:k,categoryId:e,tagId:e,tag:"全部",actionType:{FETCH_TIMELINE_LIST:"@\u002Fview\u002FtimelineIndex\u002FFETCH_TIMELINE_LIST",FETCH_CATEGORY_LIST:"@\u002Fview\u002FtimelineIndex\u002FFETCH_CATEGORY_LIST",FETCH_TAG_LIST:"@\u002Fview\u002FtimelineIndex\u002FFETCH_TAG_LIST",DELETE_ENTRY:"@\u002Fview\u002FtimelineIndex\u002FDELETE_ENTRY",DELETE_USER_ENTRIES:"@\u002Fview\u002FtimelineIndex\u002FDELETE_USER_ENTRIES",DELETE_TAG_ENTRIES:"@\u002Fview\u002FtimelineIndex\u002FDELETE_TAG_ENTRIES",FETCH_MORE:"@\u002Fview\u002FtimelineIndex\u002FFETCH_MORE",FETCH:"@\u002Fview\u002FtimelineIndex\u002FFETCH",RESET:"@\u002Fview\u002FtimelineIndex\u002FRESET"},serverRenderTimelineList:a,timelineList:{list:[],cursor:f,skeleton:b,loading:a,hasMore:b,categoryId:e,tagId:e,sort:e,actionType:{UPDATE_STATE:"timeline-list\u002FUPDATE_STATE",FETCH_MORE:"timeline-list\u002FFETCH_MORE",FETCH:"timeline-list\u002FFETCH",RESET:"timeline-list\u002FRESET"}},recommendList:{list:[],cursor:f,loading:a,skeleton:b,hasMore:b,actionType:{UPDATE_STATE:"recommend-list\u002FUPDATE_STATE",FETCH_MORE:"recommend-list\u002FFETCH_MORE",FETCH:"recommend-list\u002FFETCH",RESET:"recommend-list\u002FRESET"}},followingList:{list:[],cursor:f,skeleton:b,loading:a,hasMore:b,actionType:{UPDATE_STATE:"following-list\u002FUPDATE_STATE",FETCH_MORE:"following-list\u002FFETCH_MORE",FETCH:"following-list\u002FFETCH",RESET:"following-list\u002FRESET"}}},subscribe:{subscribed:{list:[],cursor:f,skeleton:b,loading:a,hasMore:a,actionType:{UPDATE_STATE:"view\u002Fsubscribe\u002Fsubscribed\u002Flist\u002FUPDATE_STATE",FETCH_MORE:"view\u002Fsubscribe\u002Fsubscribed\u002Flist\u002FFETCH_MORE",FETCH:"view\u002Fsubscribe\u002Fsubscribed\u002Flist\u002FFETCH",RESET:"view\u002Fsubscribe\u002Fsubscribed\u002Flist\u002FRESET"}},all:{list:[],cursor:f,loading:a,skeleton:b,hasMore:a,linkList:e,actionType:{UPDATE_STATE:"view\u002Fsubscribe\u002Fall\u002Flist\u002FUPDATE_STATE",FETCH_MORE:"view\u002Fsubscribe\u002Fall\u002Flist\u002FFETCH_MORE",FETCH:"view\u002Fsubscribe\u002Fall\u002Flist\u002FFETCH",RESET:"view\u002Fsubscribe\u002Fall\u002Flist\u002FRESET"}}},entryPublic:{entry:{user:{}},relatedEntryList:[],relatedCollectionList:[],actionType:{FETCH:"@\u002Fview\u002FentryPublic\u002FFETCH",RESET:"@\u002Fview\u002FentryPublic\u002FRESET"}},user:{user:{},serverRendered:a,userAnnuals:[],actionType:{FETCH:"@\u002Fview\u002Fuser\u002FFETCH",RESET:"@\u002Fview\u002Fuser\u002FRESET",UPDATE:"@\u002Fview\u002Fuser\u002FUPDATE",FETCH_ANNUALS:"@\u002Fview\u002Fuser\u002FFETCH_ANNUALS"},detailList:{actionType:{RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FRESET"},likeList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FlikePostList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FlikePostList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FlikePostList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FlikePostList\u002FRESET"}},postList:{list:[],hasMore:a,skeleton:a,loading:a,sort:n,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FpostList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpostList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpostList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FpostList\u002FRESET"}},searchList:{list:[],hasMore:a,skeleton:a,loading:a,key_word:e,search_type:d,cursor:f,isPostSearch:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FsearchList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FsearchList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FsearchList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FsearchList\u002FRESET"}},tagList:{list:[],loading:a,skeleton:b,hasMore:a,cursor:f,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FtagList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FtagList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FtagList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FtagList\u002FRESET"}},collectionList:{list:[],userId:e,skeleton:b,hasMore:a,cursor:f,type:"created",loading:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FRESET",TOGGLE_FOLLOW_COLLECTION:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FTOGGLE_FOLLOW_COLLECTION",FOLLOW_COLLECTION:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FFOLLOW_COLLECTION",UNFOLLOW_COLLECTION:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FUNFOLLOW_COLLECTION",DELELTE_COLLECTION:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FDELELTE_COLLECTION",ADD_COLLECTION:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FADD_COLLECTION",EDIT_COLLECTION:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FEDIT_COLLECTION"}},followerList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowerList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowerList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowerList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowerList\u002FRESET"}},followingList:{list:[],cursor:f,hasMore:a,skeleton:a,loading:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingList\u002FRESET"}},followingTeamsList:{list:[],cursor:f,hasMore:a,skeleton:a,loading:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingTeamsList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingTeamsList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingTeamsList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingTeamsList\u002FRESET"}},activityList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FactivityList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FactivityList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FactivityList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FactivityList\u002FRESET"}},bookList:{list:[],cursor:f,skeleton:b,hasMore:a,loading:a,type:"wrote",actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FbookList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FbookList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FbookList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FbookList\u002FRESET"}},pinList:{list:[],hasMore:a,loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinList\u002FRESET"}},courseList:{list:[],hasMore:a,loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FcourseList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcourseList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcourseList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FcourseList\u002FRESET"}},pinPraisedList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinPraisedList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinPraisedList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinPraisedList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinPraisedList\u002FRESET"}},eventList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FeventList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FeventList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FeventList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FeventList\u002FRESET"}},selfColumnList:{list:[],hasMore:a,skeleton:a,loading:a,cursor:f,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnList\u002FRESET"}},columnFollowedList:{list:[],hasMore:a,skeleton:a,loading:a,cursor:f,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnFollowedList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnFollowedList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnFollowedList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnFollowedList\u002FRESET",FILTER:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnFollowedList\u002FFILTER"}},realtimes:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimes\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimes\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimes\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimes\u002FRESET",DELETE:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimes\u002FDELETE"}},realtimeliked:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimeliked\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimeliked\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimeliked\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimeliked\u002FRESET",DELETE:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimeliked\u002FDELETE"}}}},tag:{tag:{},actionType:{FETCH:"@\u002Fview\u002Ftag\u002FFETCH",FETCH_LIST:"@\u002Fview\u002Ftag\u002FFETCH_LIST",RESET:"@\u002Fview\u002Ftag\u002FRESET"},list:{list:[],cursor:f,loading:a,skeleton:a,hasMore:a,actionType:{UPDATE_STATE:"@\u002Fview\u002Ftag\u002Flist\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Ftag\u002Flist\u002FFETCH_MORE",FETCH:"@\u002Fview\u002Ftag\u002Flist\u002FFETCH",RESET:"@\u002Fview\u002Ftag\u002Flist\u002FRESET"}}},notification:{user:{actionType:{READ_ALL:"@\u002Fview\u002Fnotification\u002Fuser\u002FREAD_ALL",RESET:"@\u002Fview\u002Fnotification\u002Fuser\u002FRESET"},listState:{list:[],cursor:f,hasMore:a,isLoading:a,messageType:3,msgTotal:d,msgSubMap:{"1":d,"2":d,"3":d,"4":d,"7":d}},list:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FUPDATE",FETCH:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FRESET"}}},system:{actionType:{READ_ALL:"@\u002Fview\u002Fnotification\u002Fsystem\u002FREAD_ALL",RESET:"@\u002Fview\u002Fnotification\u002Fsystem\u002FRESET"},list:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FUPDATE",FETCH:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FRESET"}}}},column:{serverRenderList:a,column:{id:w},entry:{id:w,screenshot:void 0,liked:a,article_id:w,article_info:{article_id:w,user_id:"3016715633959592",category_id:"6809635626661445640",tag_ids:[6809640399544517000],visible_level:d,link_url:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F6844904119723884551",cover_image:e,is_gfw:d,title:"iOS内存二三事",brief_content:"Page In\u002FOut和 Swap In\u002FOut 概念类似，只不过Page In\u002FOut是将某些页的数据写到内存\u002F从内存写回磁盘交互区；而Swap In\u002FOut是将整个地址空间的数据写到内存\u002F从内存写回磁盘交互区；本质都是交互机制。 通用的计算机（大型机和专用计算机不在此范围）…",is_english:d,is_original:g,user_index:6.8208583121434,original_type:d,original_author:e,content:"\u003Cp\u003E简单总结下iOS内存方面的一些知识\u003C\u002Fp\u003E\n\u003Ch3 class=\"heading\"\u003E一、内存基础概念\u003C\u002Fh3\u003E\n\u003Ch4 class=\"heading\"\u003E1、物理内存 &amp; 虚拟内存\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E物理内存（Physical Memory）\u003C\u002Fstrong\u003E: 指通过物理内存条而获得的内存空间，和虚拟内存对应；主要作用是：设备运行时为操作系统和各种程序提供临时储存空间；iPhone 6 和 6 Plus 及之前都是1G 内存，目前比较新的iPhone XS和XS Max是4GB内存；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E虚拟内存(Virtual Memory)\u003C\u002Fstrong\u003E：是计算机系统内存管理的一种技术，为每一个进程提供了一个\u003Cstrong\u003E一致的、私有的地址空间\u003C\u002Fstrong\u003E；其主要作用是：保护了每个进程的地址空间不会被其他进程破坏，降低内存管理的复杂性；32位设备虚拟内存大小是4GB，64位设备（5s以后的设备）是 4GB * 4GB；\u003C\u002Fli\u003E\n\u003Cli\u003E虚拟内存是进程运行时所有内存空间的总和，并且可能有一部分不在物理内存中；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E2、段页式存储\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E目前，大部分通用的计算机的内存管理使用\u003Cstrong\u003E段页式存储结构\u003C\u002Fstrong\u003E；用户程序先分段，每个段内再分页；而\u003Cstrong\u003E页是存储的最基本单位\u003C\u002Fstrong\u003E，iOS设备的arm64架构后，页大小是16KB；\u003C\u002Fli\u003E\n\u003Cli\u003E利用\u003Cstrong\u003E逻辑地址\u003C\u002Fstrong\u003E(段号 + 段内页号 + 页内地址) 进行地址变化，获得物理地址；这样的话，在段页式结构中，须\u003Cstrong\u003E三次访问\u003C\u002Fstrong\u003E内存才能获取数据或指令；\u003C\u002Fli\u003E\n\u003Cli\u003E当进程访问一个虚拟内存的页时，而对应的物理内存却不存在时，会触发一次\u003Cstrong\u003EPage Fault\u003C\u002Fstrong\u003E（\u003Cstrong\u003E缺页中断\u003C\u002Fstrong\u003E），将需要的数据 or 指令从磁盘加载到物理内存页中，建立映射关系，然后再恢复现场，程序本身是无感知的；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E3、Swap In\u002FOut &amp; Page In\u002FOut\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E磁盘内部有一个区域叫做\u003Cstrong\u003E交换空间\u003C\u002Fstrong\u003E(Swap Space)，MMU(内存管理单元) 会将\u003Cstrong\u003E暂时不用的内存块内容\u003C\u002Fstrong\u003E写在交互空间上(硬盘)，这就是\u003Cstrong\u003ESwap Out\u003C\u002Fstrong\u003E；当需要时候再从Swap Space中读取到内存中，这就是\u003Cstrong\u003ESwap In\u003C\u002Fstrong\u003E；Swap in和swap out的操作都是比较耗时的, 频繁的Swap in和Swap out操作非常影响系统性能；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003EPage In\u002FOut\u003C\u002Fstrong\u003E和 \u003Cstrong\u003ESwap In\u002FOut\u003C\u002Fstrong\u003E 概念类似，只不过Page In\u002FOut是将\u003Cstrong\u003E某些页\u003C\u002Fstrong\u003E的数据写到内存\u002F从内存写回磁盘交互区；而Swap In\u002FOut是将\u003Cstrong\u003E整个地址空间\u003C\u002Fstrong\u003E的数据写到内存\u002F从内存写回磁盘交互区；本质都是交互机制。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EmacOS支持这类交换机制，但是iOS不支持；主要有两方面考虑吧：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E移动设备的闪存读写次数有限，频繁写会降低寿命；\u003C\u002Fli\u003E\n\u003Cli\u003E相比PC机，移动设备闪存空间有限(15年6s最小存储空间16GB、最大128GB；19年XS Max最小64GB，最大521GB)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E4、to be continued\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E通用的计算机（\u003Cem\u003E大型机和专用计算机不在此范围\u003C\u002Fem\u003E）的存储器一般设置为多层，从最靠近CPU的Cache一直到磁盘，速度越来越慢，价格也越来越便宜。\u003C\u002Fli\u003E\n\u003Cli\u003E为了充分利用好硬件资源，Cache和Swap机制应运而生，Cache机制是一种用空间换时间的机制；而Swap机制是使用时间换空间的；\u003C\u002Fli\u003E\n\u003Cli\u003E但是，iOS系统舍弃交换机制，取而代之的是\u003Cstrong\u003E压缩内存（Compressed memory）机制\u003C\u002Fstrong\u003E；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 class=\"heading\"\u003E二、iOS内存管理基础概念\u003C\u002Fh3\u003E\n\u003Ch4 class=\"heading\"\u003E1、iOS的内存分区\u003C\u002Fh4\u003E\n\u003Cp\u003E从高地址到低地址各区域如下：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E栈区(stack)\u003C\u002Fstrong\u003E： 由编译器⾃动分配，存放函数的参数值，局部变量的值等，作用域执行完毕之后，就会被系统收回；(栈区的地址从高到低分配)\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E堆区(heap)\u003C\u002Fstrong\u003E：一般由程序员分配和释放，用于存放程序运行中被动态分配的内存段；iOS中的Objective-C对象存放在这里，由ARC管理；（堆区的地址是从低到高分配）\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E全局区静态区\u003C\u002Fstrong\u003E：由编译器分配，主要是存放全局变量 和 静态变量，程序结束后由系统释放；主要分两个区：\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EBSS区\u003C\u002Fstrong\u003E：\u003Cstrong\u003E未初始化\u003C\u002Fstrong\u003E的全局变量 和 静态变量；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E数据区\u003C\u002Fstrong\u003E：\u003Cstrong\u003E已初始化\u003C\u002Fstrong\u003E的全局变量 和 静态变量；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E常量区：\u003C\u002Fstrong\u003E 存放的是常量，如常量字符串，程序结束后由系统释放；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E代码区\u003C\u002Fstrong\u003E：存放函数体的二进制代码，程序结束后由系统释放；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cfigure\u003E\u003Cimg alt=\"内存分区示意\" src=\"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fgold-user-assets\u002F2020\u002F4\u002F9\u002F1715e3aff4615a4d~tplv-t2oaga2asx-image.image\"\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\n\u003Ch4 class=\"heading\"\u003E2、内存页类型：Clean和Dirty\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E内存页按照各自的\u003Cstrong\u003E分配和使用\u003C\u002Fstrong\u003E状态，分为 \u003Ccode\u003EClean\u003C\u002Fcode\u003E 和 \u003Ccode\u003EDirty\u003C\u002Fcode\u003E 两类。其中\u003Ccode\u003EClean Page\u003C\u002Fcode\u003E是可以被回收的，\u003Ccode\u003EDirty Page\u003C\u002Fcode\u003E不能；\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs objective-c\" lang=\"objective-c\"\u003Eint *array = malloc(20000 * sizeof(int)); \u002F\u002F 第1步\narray[0] = 32                             \u002F\u002F 第2步\narray[19999] = 64                         \u002F\u002F 第3步\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E第一步，申请一块长度为80000 字节的内存空间，按照一页 16KB 来计算，就需要 6 页内存来存储。当这些内存页开辟出来的时候，它们都是 Clean 的；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E第二步，向处于第一页的内存写入数据时，第一页内存会变成 Dirty；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E第三步，当向处于最后一页的内存写入数据时，这一页也会变成 Dirty；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E3、VM Region\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EiOS进程中所有内存就是由许许多多的\u003Ccode\u003EVM Region\u003C\u002Fcode\u003E组成的；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003EVM Region\u003C\u002Fcode\u003E指\u003Cstrong\u003E一段连续的内存页（在虚拟地址空间里）\u003C\u002Fstrong\u003E，\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fopensource.apple.com\u002Fsource\u002Fxnu\u002Fxnu-792\u002Fosfmk\u002Fmach\u002Fvm_region.h\"\u003EVM Region\u003C\u002Fa\u003E的结构如下\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs objective-c\" lang=\"objective-c\"\u003Estruct vm_region_submap_info_64 {\n\tvm_prot_t\t\tprotection;     \u002F* present access protection *\u002F\n\tvm_prot_t\t\tmax_protection; \u002F* max avail through vm_prot *\u002F\n\tvm_inherit_t\t\tinheritance;\u002F* behavior of map\u002Fobj on fork *\u002F\n\tmemory_object_offset_t\toffset;\t\t\u002F* offset into object\u002Fmap *\u002F\n  unsigned int            user_tag;\t\u002F* user tag on map entry *\u002F\n  unsigned int            pages_resident;\t\u002F* only valid for objects *\u002F\n  unsigned int            pages_shared_now_private; \u002F* only for objects *\u002F\n  unsigned int            pages_swapped_out; \u002F* only for objects *\u002F\n  unsigned int            pages_dirtied;   \u002F* only for objects *\u002F\n  unsigned int            ref_count;\t \u002F* obj\u002Fmap mappers, etc *\u002F\n  unsigned short          shadow_depth; \t\u002F* only for obj *\u002F\n  unsigned char           external_pager;  \u002F* only for obj *\u002F\n  unsigned char           share_mode;\t\u002F* see enumeration *\u002F\n\tboolean_t\t\tis_submap;\t\u002F* submap vs obj *\u002F\n\tvm_behavior_t\t\tbehavior;\t\u002F* access behavior hint *\u002F\n\tvm_offset_t\t\tobject_id;\t\u002F* obj\u002Fmap name, not a handle *\u002F\n\tunsigned short\t\tuser_wired_count; \n};\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EVM Region包含的重要信息有：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003Epages_resident\u003C\u002Fstrong\u003E：在用的物理内存页数\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003Epages_dirtied\u003C\u002Fstrong\u003E：Dirty的内存页数\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003Epages_swapped_out\u003C\u002Fstrong\u003E：Swapped的内存页数（\u003Cstrong\u003E实际指的是被Compressed Memory页数\u003C\u002Fstrong\u003E）\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E可以通过了解\u003Cstrong\u003Epages_dirtied\u003C\u002Fstrong\u003E和\u003Cstrong\u003Epages_swapped_out\u003C\u002Fstrong\u003E来了解\u003Ccode\u003EVM Region\u003C\u002Fcode\u003E的真实物理内存使用。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 class=\"heading\"\u003E三、iOS内存管理机制\u003C\u002Fh3\u003E\n\u003Ch4 class=\"heading\"\u003E1、OC的内存管理\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003EObjective-C提供两种方式的内存管理方式：\u003Cstrong\u003EMRC\u003C\u002Fstrong\u003E（手动管理引用计数）和  \u003Cstrong\u003EARC\u003C\u002Fstrong\u003E（自动引用计数）\u003C\u002Fli\u003E\n\u003Cli\u003EObjective-C内存管理的基本原则：谁创建，谁释放，谁引用，谁管理；\u003C\u002Fli\u003E\n\u003Cli\u003EiOS 5之后提出的ARC被广泛接收，毕竟不需要管理引用计数是个很爽的事情；有了ARC，开开心心写OC；但是\u003Cstrong\u003EARC只管理Objective-C对象的内存\u003C\u002Fstrong\u003E，CoreFoundation对象、CoreGraphics对象、还有C\u002FC++的内存分配还是需要开发者自己管理。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cfigure\u003E\u003Cimg alt=\"OC的内存管理图\" src=\"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fgold-user-assets\u002F2020\u002F4\u002F9\u002F1715e39230e29f4a~tplv-t2oaga2asx-image.image\"\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\n\u003Ch4 class=\"heading\"\u003E2、系统内存分类\u003C\u002Fh4\u003E\n\u003Cp\u003E​\t从 iOS7 开始，系统开始采用\u003Ccode\u003ECompressed Memory\u003C\u002Fcode\u003E机制优化内存使用，内存类型可以分为三类：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003EClean Memory\u003C\u002Fcode\u003E：可以被释放或重建的，主要包括：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ECode\u003C\u002Fli\u003E\n\u003Cli\u003Eframework，每个 framework都有 \u003Ccode\u003E_DATA_CONST\u003C\u002Fcode\u003E 段，当 App 在运行时使用到了某个 framework，它所对应的 \u003Ccode\u003E_DATA_CONST\u003C\u002Fcode\u003E 的内存就会由 Clean 变为 Dirty。\u003C\u002Fli\u003E\n\u003Cli\u003Ememory-mapped files（已被加载到内存中的文件）\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E：指那些被写入过数据的内存，主要包括：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E所有堆区中的对象（Heap allocations）\u003C\u002Fli\u003E\n\u003Cli\u003E图像解码缓冲区（Decoded image buffers）\u003C\u002Fli\u003E\n\u003Cli\u003Eframeworks（framework中 \u003Ccode\u003E_DATA\u003C\u002Fcode\u003E 段和 \u003Ccode\u003E_DATA_DIRTY\u003C\u002Fcode\u003E 段）\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs bash\" lang=\"bash\"\u003E\t在使用 framework 的过程中会产生Dirty Memory，使用单例或者全局初始化方法是减少Dirty Memory；这是因为单例一旦创建就不会销毁，全局初始化方法会在 class 加载时执行。\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003ECompressed Memory\u003C\u002Fcode\u003E：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E在内存吃紧时，系统会将不使用的内存进行压缩(Compresses unaccessed pages)\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E在需要的时候，进行解压 （Decompresses pages upon access）\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E优势：减少了不活跃内存占用；减少磁盘IO带来的损耗；压缩\u002F解压十分迅速，能够尽可能减少 CPU 的时间开销；支持多核操作。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E举例\u003C\u002Fstrong\u003E：当我们使用 \u003Ccode\u003ENSDictionary\u003C\u002Fcode\u003E 去缓存数据的时候，假设现在已经使用了 3 页内存，当不访问的时候可能会被压缩为 1 页，再次使用到时候又会解压成 3 页。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E介绍\u003Ccode\u003EClear Memory\u003C\u002Fcode\u003E和 \u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E 的Code如下：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs objective-c\" lang=\"objective-c\"\u003E\u002F\u002F堆分配的内存 Dirty Memory\nNSString *str1 = [NSString stringWithString:@\"Welcome!\"]; \n\u002F\u002F常量字符串, 存放在一个只读数据段里面,这段内存释放后,还可以在读取重建 Clear Memory\nNSString *str2 = @\"Welcome!\"; \n\u002F\u002F分配100M虚拟内存,当没有用时没有建立映射,Clear Memory\nchar *buf = malloc(100 * 1024 *1024); 关系\nfor (int i = 0; i &lt; 3 * 1024 * 1024; ++i) {\n    \u002F\u002F写入数据了,Dirty Memory\n\t\tbuf[i] = rand();\t\t\t\t\t\t\t\t\t\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E说明\u003C\u002Fstrong\u003E：在内存吃紧的情况下，释放\u003Ccode\u003EClean Memory\u003C\u002Fcode\u003E，不能释放\u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E ，所以\u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E 的内存越多，App的稳定性越差。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E3、\u003Ccode\u003EJetsam\u003C\u002Fcode\u003E机制\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EJetsam机制是操作系统为了控制内存资源过度使用而采用的一种管理机制；Jetsam是一个独立运行的进程，会把一些\u003Cstrong\u003E优先级不高或者占用内存过大的\u003C\u002Fstrong\u003EApp杀掉；在杀掉App后会记录一些数据信息并保存到日志。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EApp优先级可以这么简单理解：前台App &gt; 后台App; 占用内存少 &gt; 占用内存多；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EJetsam产生的这些日志可以在\u003Cstrong\u003E手机设置-&gt;隐私-&gt;分析\u003C\u002Fstrong\u003E中找到，日志是以\u003Ccode\u003EJetsamEvent\u003C\u002Fcode\u003E开头，日志中有内存页大小(pageSize)，CPU时间(cpuTime)等字段。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E查看\u003Ccode\u003E设置-&gt;隐私-&gt;分析\u003C\u002Fcode\u003E中以JetsamEvent开头的系统日志，关注两个重要的信息；\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs python\" lang=\"python\"\u003E\u003Cspan class=\"hljs-string\"\u003E\"pageSize\"\u003C\u002Fspan\u003E : \u003Cspan class=\"hljs-number\"\u003E16384\u003C\u002Fspan\u003E,\n\u002F\u002F内存页达到上限\n\u003Cspan class=\"hljs-string\"\u003E\"rpages\"\u003C\u002Fspan\u003E : \u003Cspan class=\"hljs-number\"\u003E948\u003C\u002Fspan\u003E,      \u002F\u002FApp 占用的内存页数量\n\u003Cspan class=\"hljs-string\"\u003E\"reason\"\u003C\u002Fspan\u003E : \u003Cspan class=\"hljs-string\"\u003E\"per-process-limit\"\u003C\u002Fspan\u003E,  \u002F\u002FApp 占用的内存超过了系统对单个 App 的内存限制。\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E说明\u003C\u002Fstrong\u003E：该内存“上限”计算：pageSize \u003Cem\u003Erpages = 16384\u003C\u002Fem\u003E 948 \u002F1024\u002F1014 = 14.8MB，这个App应该是因优先级不高而被强杀，毕竟App内存使用上限不可能不到15MB。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E4、内存警告\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E内存警告（Memory Warning）三种通知方式:\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EUIApplicationDelegate\u003C\u002Fstrong\u003E的\u003Ccode\u003EapplicationDidReceiveMemoryWarning:\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E视图控制器\u003Cstrong\u003EUIViewController\u003C\u002Fstrong\u003E的\u003Ccode\u003EdidReceiveMemoryWarning\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EUIApplicationDidReceiveMemoryWarningNotification\u003C\u002Fstrong\u003E通知\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E出现OOM前不一定出现内存警告；有可能是瞬间申请了大量内存，而恰好此时主线程在忙于其他事情，导致可能没有经历过Memory Warning就发生了OOM；也可能即便出现了多次Memory Warning后，也不见得会在最后一次Memory Warning的几秒钟后出现OOM(可能是1-2分钟后)；\u003C\u002Fli\u003E\n\u003Cli\u003E并非所有内存警告都是由 App 造成的，例如在内存较小的设备上，当你接听电话的时候也有可能发生内存警告。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 class=\"heading\"\u003E四、常见的内存类问题\u003C\u002Fh3\u003E\n\u003Ch4 class=\"heading\"\u003E1、FOOM\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EFOOM（Foreground Out Of Memory），是指App\u003Cstrong\u003E在前台\u003C\u002Fstrong\u003E因消耗内存过多引起系统强杀。对用户而言，表现跟Crash一样。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EFacebook早在2015年8月提出FOOM检测办法，大致原理是排除各种情况后，剩余的情况是FOOM；Facebook如何判定上一次启动是否出现FOOM方法：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E1.App没有升级\u003C\u002Fli\u003E\n\u003Cli\u003E2.App没有调用exit()或abort()退出\u003C\u002Fli\u003E\n\u003Cli\u003E3.App没有出现Crash (依赖于自身CrashReport组件的Crash回调)\u003C\u002Fli\u003E\n\u003Cli\u003E4.用户没有强退App\u003C\u002Fli\u003E\n\u003Cli\u003E5.系统没有升级\u002F重启\u003C\u002Fli\u003E\n\u003Cli\u003E6.App当时没有后台运行（依赖于ApplicationState和前后台切换通知）\u003C\u002Fli\u003E\n\u003Cli\u003E7.App出现FOOM （依赖于ApplicationState和前后台切换通知）\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E排查法有误报的可能，因为有些被系统强杀case，但是我们捕获不到信息，也可能被归类到OOM；已知被系统强杀的case是：OOM和watchdog(Code 0x8badf00d)。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E发现FOOM问题的关键：监控App使用内存增长，在收到内存警告通知时，dump 内存信息，获取对象名称、对象个数、各对象的内存值，并在合适的时机上报到服务器；加强对大内存的分配监控。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E2、内存泄露\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E内存泄露(Memory Leak)：指申请的内存空间使用完毕之后\u003Cstrong\u003E未回收\u003C\u002Fstrong\u003E，内存泄露问题多的话，对App质量影响很大；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E目前引起内存泄露的主要原因是循环引用(堆内存中对象相互引用，彼此都得不到释放的机会)，目前，调试阶段使用Instrument的Leaks工具发现，线上利用MLeaksFinder发现后上报；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E如何避免内存泄露在后面有介绍\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E3、WKWebview白屏\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EWKWebview白屏问题，严格来说，是一种内存方面的问题；之前的UIWebview因为内存使用过大会Crash，而WKWebview不会Crash，会白屏；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EWKWebView是一个多进程组件，\u003Ccode\u003ENetwork Loading\u003C\u002Fcode\u003E以及\u003Ccode\u003EUI Rendering\u003C\u002Fcode\u003E在其它进程中执行，当WKWebView总体的内存占用比较大时，\u003Ccode\u003EWebContent Process\u003C\u002Fcode\u003E会Crash，从而出现白屏现象。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E解决办法\u003C\u002Fstrong\u003E：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EKVO监听URL, 当URL为nil，重新reload\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E在进程被终止回调中，重新reload\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs objective-c\" lang=\"objective-c\"\u003E\u002F\u002F 此方法适用iOS9.0以上 \n- (void)webViewWebContentProcessDidTerminate:(WKWebView *)webView NS_AVAILABLE(10_11, 9_0){\n\t\t\u002F\u002Freload\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E4、野指针问题\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E野指针\u003C\u002Fstrong\u003E：指向一个已删除的对象 或 受限内存区域的指针；目前此类问题很少了，主要来自两个方面\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EMRC时代 到 ARC时代，OC对象管理极大方便了，ARC解决大部分野指针问题\u003C\u002Fli\u003E\n\u003Cli\u003EiOS 9开始，系统库中部分遗留的被\u003Ccode\u003Eassign(unsafe_unretain)\u003C\u002Fcode\u003E修饰的 \u003Ccode\u003Edelegate\u003C\u002Fcode\u003E和\u003Ccode\u003Etarget-action\u003C\u002Fcode\u003E修改成了weak，内存被回收的时候，这些指针设为nil，这也大幅度减少了野指针的出现。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E目前绝大部分App都是iOS 9起步，野指针少了很多，但是工程中依然会有野指针问题，本质还是内存使用不当；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003EMach Exception\u003C\u002Fcode\u003E大多数都是野指针的问题，崩溃日志里最多见\u003Ccode\u003Eobjc_msgSend\u003C\u002Fcode\u003E和\u003Ccode\u003Eunrecognized selector sent to\u003C\u002Fcode\u003E等等。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E对于野指针问题，最好能复现，使用\u003Ccode\u003EZombie Object\u003C\u002Fcode\u003E 帮助调试，\u003Ccode\u003EZombie Object\u003C\u002Fcode\u003E 实现原理就是 hook 住了对象的\u003Ccode\u003Edealloc\u003C\u002Fcode\u003E方法，通过调用自己的\u003Ccode\u003E__dealloc_zombie\u003C\u002Fcode\u003E方法来把对象进行僵尸化，当这个对象再次收到消息,\u003Ccode\u003Eobjc_msgsend\u003C\u002Fcode\u003E的时候，调用abort()崩溃并打印出调用的方法。。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E\u003Cstrong\u003EiOS 9以后NSNotificationCenter不需要手动移除观察者\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E在iOS9之前，通知中心使用 \u003Cstrong\u003Eunsafe_unretained\u003C\u002Fstrong\u003E修饰引用观察者，如果观察者被回收时，若不手动移除，指针会指向被回收的内存区域，变为野指针，如果再发送消息会造成Crash；\u003C\u002Fli\u003E\n\u003Cli\u003E而iOS 9之后，通知中心使用\u003Cstrong\u003Eweak\u003C\u002Fstrong\u003E修饰引用观察者 ，即使不手动移除观察者，weak指针也会在观察者被回收后自动置nil。之后发送消息，是不会有问题的。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch4 class=\"heading\"\u003E5、iOS 10 nano_free Crash\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E在iOS 10.0 - 10.1，苹果bug引入nano_free Crash问题，这些Crash发生\u003Ccode\u003Elibsystem_malloc.dylib\u003C\u002Fcode\u003E中的 \u003Ccode\u003Enano zone\u003C\u002Fcode\u003E内的；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003Elibsystem_malloc.dylib\u003C\u002Fcode\u003E中，对内存的管理有两个实现：\u003Ccode\u003Enano zone\u003C\u002Fcode\u003E和\u003Ccode\u003Escalable zone\u003C\u002Fcode\u003E。他们分别管理不同大小的内存块：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E内存分配函数malloc和calloc等默认使用的是nano_zone，nao_zone是 256B 以下小内存的分配，\u003C\u002Fli\u003E\n\u003Cli\u003E大于 256B 的时候会使用 \u003Cstrong\u003Escalable_zone\u003C\u002Fstrong\u003E 来分配。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E当时微信团队提出的几种解决思路，最后给的解决方案是\u003Cstrong\u003E不使用nano zone\u003C\u002Fstrong\u003E，具体描述\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E创建一个自己的zone，命名为\u003Ccode\u003Eguard zone\u003C\u002Fcode\u003E。\u003C\u002Fli\u003E\n\u003Cli\u003E修改nano zone的函数指针，重定向到guard zone(通过\u003Ccode\u003Emalloc_zone_create\u003C\u002Fcode\u003E创建的)。\n\u003Cul\u003E\n\u003Cli\u003E对于没有传入指针的函数，直接重定向到guard zone\u003C\u002Fli\u003E\n\u003Cli\u003E对于有传入指针的函数，先用size判断所属的zone，再进行分发。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E更多见：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fcloud.tencent.com\u002Fdeveloper\u002Farticle\u002F1031006\"\u003E聊聊苹果的Bug - iOS 10 nano_free Crash\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fopensource.apple.com\u002Ftarballs\u002Flibmalloc\u002F\"\u003Elibsystem_malloc.dylib 源码\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E6、to be continued\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E内存类问题排查难度大，复杂。需要对内存有更深入的理解\u003C\u002Fli\u003E\n\u003Cli\u003E为了避免内存问题：根本上是优化内存使用，主要表现在：减少大块内存使用，降低内存峰值，避免内存泄露，处理内存警告;\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 class=\"heading\"\u003E五、优化内存使用\u003C\u002Fh3\u003E\n\u003Ch4 class=\"heading\"\u003E1、降低图片解码和渲染开销\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E将图片渲染显示在屏幕上，需要先将其解码成位图；而位图大小：\u003Cstrong\u003E像素高 * 像素宽 * 4字节\u003C\u002Fstrong\u003E(\u003Cem\u003E4字节对应一个像素点，4个通道的大小\u003C\u002Fem\u003E)；图片解码会造成内存使用上升，尤其是高分辨率图解码可能导致内存暴涨；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E代码优化建议\u003C\u002Fstrong\u003E：\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E善待\"大\"图（位图大小大于60MB）解码：将原图裁剪成多个小图，然后依次绘制到目标位图context中，具体可见SDWebImage中和关于**decodedAndScaledDownImageWithImage:**的实现；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E限制并发解码图片的个数；\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E图片大小调整和显示大小一样，以此避免重采样(重采样也很消耗资源，放大图像称为上采样\u002F插值（upsamping），缩小图像为小采样（downsampling));\u003C\u002Fli\u003E\n\u003Cli\u003E使用 ImageIO直接读取图像大小和元数据信息，减少内存开销。\u003C\u002Fli\u003E\n\u003Cli\u003EiOS10后使用 \u003Ccode\u003EUIGraphicsImageRenderer\u003C\u002Fcode\u003E 创建 image 上下文，而不是\u003Ccode\u003EUIGraphicsBeginImageContextWithOptions\u003C\u002Fcode\u003E，因为前者的性能更好、更高效，并且支持广色域；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E2、其他降低内存峰值办法\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E合理使用\u003Ccode\u003Eautorealsepool\u003C\u002Fcode\u003E，降低内存峰值，避免 OOM\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E基于引用计数,Pool执行drain方法会release所有该Pool中的autorelease对象\u003C\u002Fli\u003E\n\u003Cli\u003E可以嵌套多个AutoReleasePool\u003C\u002Fli\u003E\n\u003Cli\u003E每个线程并没有设置默认的AutoReleasePool,需要手动创建,避免内存泄露\u003C\u002Fli\u003E\n\u003Cli\u003E在一段内存分配频繁的代码中嵌套AutoReleasePool有利于降低整体内存峰值\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E复用大内存对象，如UITableViewCell对象；懒加载大的内存对象\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EimageNamed 和 imageWithContentOfFile 的选择\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EimageNamed使用系统缓存，适用于频繁使用的小图片\u003C\u002Fli\u003E\n\u003Cli\u003EimageWithContentOfFile不带缓存机制,适用于大图片,使用完就释放\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E建议NSData读取文件方式\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E建议使用\u003Ccode\u003E[NSData dataWithContentsOfFile:path options:NSDataReadingMappedIfSafe error:&amp;error]\u003C\u002Fcode\u003E;\u003C\u002Fli\u003E\n\u003Cli\u003E该API映射文件到虚拟内存, 只有读取操作的时候才会读取相应页的内容到物理内存页中；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E用 \u003Ccode\u003ENSCache\u003C\u002Fcode\u003E 代替 \u003Ccode\u003ENSMutableDictionary\u003C\u002Fcode\u003E， 因为 \u003Ccode\u003ENSCache\u003C\u002Fcode\u003E 可以自动清理内存，在内存吃紧的时候会更加合理。\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ENSCache有2种界限条件:totalCostLimt &amp; countLimit，超过这两种界限后系统会去释放一些旧的资源.\u003C\u002Fli\u003E\n\u003Cli\u003E监听到内存警告消息后移除所有Cache\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E使用 NSPurgableData 代替NSData，主要原因如下：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E当系统处于低内存的时候会自动移除\u003C\u002Fli\u003E\n\u003Cli\u003E适用于大数据\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E栈内存分配\u003C\u002Fstrong\u003E：\u003Ccode\u003Ealloca(size_t)\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E栈分配仅仅修改栈指针寄存器，比malloc遍历并修改空闲列表要快得多\u003C\u002Fli\u003E\n\u003Cli\u003E栈内存一般都已经在物理内存中，不用担心页错误\u003C\u002Fli\u003E\n\u003Cli\u003E函数返回的时候栈分配的空间都会自动释放\u003C\u002Fli\u003E\n\u003Cli\u003E但仅适合小空间的分配,并且函数嵌套不宜过深\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E堆内存分配\u003C\u002Fstrong\u003E：\u003Cstrong\u003Ecalloc\u003C\u002Fstrong\u003E \u003Cstrong\u003EVS\u003C\u002Fstrong\u003E \u003Cstrong\u003Emalloc + memset\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Ecalloc(size_t num,size_t size)\u003C\u002Fcode\u003E分配内存时是虚拟内存，只有在访问的时候才会发生物理页的映射关系；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Emalloc + memset\u003C\u002Fcode\u003E 会产生\u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Ecalloc\u003C\u002Fcode\u003E函数得到的内存空间是经过初始化的，其内容全为0，而\u003Ccode\u003Emalloc\u003C\u002Fcode\u003E函数得到的内存空间是未初始化的，必须使用memset函数来初始化；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E3、避免循环引用，减少内存泄露\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E代码优化建议\u003C\u002Fstrong\u003E\n\u003Cul\u003E\n\u003Cli\u003E申明代理(delegate)为weak；\u003C\u002Fli\u003E\n\u003Cli\u003E使用 \u003Ccode\u003Eweak strong dance\u003C\u002Fcode\u003E 来解决 block 中的循环引用问题；\u003C\u002Fli\u003E\n\u003Cli\u003E实现NSProxy(虚拟类)的子类，然后在子类中定义weak修饰的target，然后实现消息转发方法，使target处理业务逻辑；一般用于解决NSTimer、CADisplayLink的循环引用；\u003C\u002Fli\u003E\n\u003Cli\u003ECoreFoundation对象、CoreGraphics对象、还有C\u002FC++的内存分配需要管理好，有malloc就要有free\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E善用工具：\u003Cstrong\u003EMLeaksFinder + Instrument\u003C\u002Fstrong\u003E 或 \u003Cstrong\u003EFBMemoryProfiler + Instrument\u003C\u002Fstrong\u003E组合使用。通过MLeaksFinder\u002FFBMemoryProfiler发现后。然后使用Instrument再验证；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E4、处理内存警告\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003EMemory Warning时，尽可能释放多资源，尤其图片等占内存多的资源，等需要用的时候再重建；\u003C\u002Fli\u003E\n\u003Cli\u003EMemory Warning时，部分单例对象可考虑释放掉；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EMemory Warning时，不建议self.view = nil\u003C\u002Fstrong\u003E：iOS 6之后，系统发出 Memory Warning 时，\u003Cstrong\u003E系统会自动回收CALayer的CABackingStore对象(bitmap 内容)\u003C\u002Fstrong\u003E；虽然没有回收 UIView 和 CALayer 类，但是也回收了大部分内存，在需要 bitmap 类时，通过调用 UIView 的 drawRect: 方法重建。\u003C\u002Fli\u003E\n\u003Cli\u003E最佳的实践还是\u003Cstrong\u003E减少大块内存使用，降低内存峰值，避免内存泄露\u003C\u002Fstrong\u003E。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 class=\"heading\"\u003E历史文章\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Cstrong\u003E之前对内存问题一些整理\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"http:\u002F\u002Fnanhuacoder.top\u002F2018\u002F01\u002F30\u002FiOS-iOSMemory\"\u003EOC对象内存小记\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"http:\u002F\u002Fnanhuacoder.top\u002F2019\u002F04\u002F17\u002FiOS-OOM\u002F\"\u003EOOM问题小记\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003Cstrong\u003E之前对图片解码和图片优化一些总结\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002F728f71b9fe28\"\u003E篇1：SDWebImage源码看图片解码\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002Fa38a7c7bccbb\"\u003EiOS实录17：网络图片的优化显示\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"http:\u002F\u002Fnanhuacoder.top\u002F2019\u002F03\u002F13\u002FiOS-PicDecode\"\u003E图片解码小记\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 class=\"heading\"\u003E参考文章\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fblog.csdn.net\u002FTuGeLe\u002Farticle\u002Fdetails\u002F104004692\"\u003E深入了解iOS中的OOM(低内存崩溃)\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fjuejin.cn\u002Fpost\u002F6844903621276991502#heading-3\"\u003EWWDC 2018：iOS 内存深入研究\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fyq.aliyun.com\u002Farticles\u002F55820\"\u003Epage fault带来的性能问题\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fwetest.qq.com\u002Flab\u002Fview\u002F367.html\"\u003EiOS微信内存监控\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fjuejin.cn\u002Fpost\u002F6844903747538141191\"\u003EiOS野指针定位总结\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002F8e764d05275b\"\u003EiOS中的内存管理\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F49829766\"\u003EiOS 内存管理研究\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002Ff9b8c139c2ed\"\u003ELinux对内存的管理, 以及page fault的概念\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fyq.aliyun.com\u002Farticles\u002F3065\"\u003EiOS内存管理和malloc源码解读\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fturingh.github.io\u002F2016\u002F06\u002F28\u002Flibmalloc%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%88%9D%E5%A7%8B%E5%8C%96\u002F\"\u003Elibmalloc源码分析之初始化\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n",ctime:"1586444638",mtime:"1598880864",rtime:"1586487296",draft_id:"6845076719783641095",view_count:6956,collect_count:74,digg_count:54,comment_count:l,hot_index:403,is_hot:d,rank_index:.00077063,status:l,verify_status:g,audit_status:l,mark_content:e,display_count:d,is_markdown:g,app_html_content:e},author_user_info:{user_id:"3016715633959592",user_name:"南华Coder",company:e,job_title:"程序猿",avatar_large:"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fgold-user-assets\u002F2018\u002F3\u002F29\u002F1627085161a3210c~tplv-t2oaga2asx-image.image",level:4,description:"于无声处听惊雷,于无色处见繁花",followee_count:35,follower_count:2962,post_article_count:31,digg_article_count:48,got_digg_count:642,got_view_count:124074,post_shortmsg_count:d,digg_shortmsg_count:l,isfollowed:a,favorable_author:d,power:3326,study_point:d,university:{university_id:f,name:e,logo:e},major:{major_id:f,parent_id:f,name:e},student_status:d,select_event_count:d,select_online_course_count:d,identity:d,is_select_annual:a,select_annual_rank:d,annual_list_type:d,extraMap:{},is_logout:d,annual_info:[],account_amount:d,user_growth_info:{user_id:3016715633959592,jpower:3326,jscore:287.6,jpower_level:4,jscore_level:4,jscore_title:"进阶掘友",author_achievement_list:[],vip_level:d,vip_title:e,jscore_next_level_score:500,jscore_this_level_mini_score:d},is_vip:a,become_author_days:d,collection_set_article_count:d},category:{category_id:"6809635626661445640",category_name:"iOS",category_url:"ios",rank:4,back_ground:"https:\u002F\u002Flc-mhke0kuv.cn-n1.lcfile.com\u002F34589746327a360a.png",icon:"https:\u002F\u002Flc-mhke0kuv.cn-n1.lcfile.com\u002F4a218bdf1f6969fd.png",ctime:1461266350,mtime:1432503174,show_type:3,item_type:l,promote_tag_cap:4,promote_priority:4,id:"6809635626661445640",name:"iOS",title:"iOS",alias:"ios"},tags:[{entriesCount:void 0,subscribed:a,id:"6809640399544516616",tag_id:"6809640399544516616",tag_name:"iOS",color:"#616161",icon:"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fgold-user-assets\u002F155962881259379c25251a455680e3249366e3a3ac373.jpg~tplv-t2oaga2asx-image.image",back_ground:e,show_navi:g,ctime:1435964171,mtime:1677836082,id_type:9,tag_alias:e,post_article_count:34104,concern_user_count:192615,title:"iOS",tagId:"6809640399544516616",articleCount:34104,subscribersCount:192615,createdAt:c,updatedAt:c}],user_interact:{id:6844904119723885000,omitempty:l,user_id:2894327269039357,is_digg:a,is_follow:a,is_collect:a},org:{org_info:c,org_user:c,is_followed:a},req_id:"202303032023003C9D87540C2E29A969E2",status:{push_status:d},author_interact:c,extra:{boost_type:e},title:"iOS内存二三事",user:{id:"3016715633959592",self_description:void 0,followed:a,viewerIsFollowing:void 0,community:void 0,subscribedTagCount:d,wroteBookCount:d,boughtBookCount:d,isBindedPhone:a,level:4,user_id:"3016715633959592",user_name:"南华Coder",company:e,job_title:"程序猿",avatar_large:"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fgold-user-assets\u002F2018\u002F3\u002F29\u002F1627085161a3210c~tplv-t2oaga2asx-image.image",description:"于无声处听惊雷,于无色处见繁花",followee_count:35,follower_count:2962,post_article_count:31,digg_article_count:48,got_digg_count:642,got_view_count:124074,post_shortmsg_count:d,digg_shortmsg_count:l,isfollowed:a,favorable_author:d,power:3326,study_point:d,university:{university_id:f,name:e,logo:e},major:{major_id:f,parent_id:f,name:e},student_status:d,select_event_count:d,select_online_course_count:d,identity:d,is_select_annual:a,select_annual_rank:d,annual_list_type:d,extraMap:{},is_logout:d,annual_info:[],account_amount:d,user_growth_info:{user_id:3016715633959592,jpower:3326,jscore:287.6,jpower_level:4,jscore_level:4,jscore_title:"进阶掘友",author_achievement_list:[],vip_level:d,vip_title:e,jscore_next_level_score:500,jscore_this_level_mini_score:d},is_vip:a,become_author_days:d,collection_set_article_count:d,juejinPower:3326,jobTitle:"程序猿",roles:{isBookAuthor:a,isFavorableAuthor:a,isCobuilder:a,isAdmin:a},username:"南华Coder",blogAddress:void 0,selfDescription:"于无声处听惊雷,于无色处见繁花",beLikedCount:642,beReadCount:124074,followerCount:2962,followingCount:35,collectionCount:d,createdCollectionCount:d,followingCollectionCount:d,postedPostsCount:31,pinCount:d,likedArticleCount:48,likedPinCount:l,avatar:"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fgold-user-assets\u002F2018\u002F3\u002F29\u002F1627085161a3210c~tplv-t2oaga2asx-image.image",latestLoginedInAt:c,createdAt:c,updatedAt:c,phoneNumber:e,titleDescription:e,followeesCount:35,applyEventCount:d,need_lead:d,followTopicCnt:d},viewCount:void 0,commentsCount:l,isEvent:void 0,abstract:"Page In\u002FOut和 Swap In\u002FOut 概念类似，只不过Page In\u002FOut是将某些页的数据写到内存\u002F从内存写回磁盘交互区；而Swap In\u002FOut是将整个地址空间的数据写到内存\u002F从内存写回磁盘交互区；本质都是交互机制。 通用的计算机（大型机和专用计算机不在此范围）…",latestCommentAt:c,createdAt:new Date(1586444638000),updatedAt:c,isTopicEvent:a,likedCount:54,likeCount:54,content:"\u003Cp\u003E简单总结下iOS内存方面的一些知识\u003C\u002Fp\u003E\n\u003Ch3 class=\"heading\"\u003E一、内存基础概念\u003C\u002Fh3\u003E\n\u003Ch4 class=\"heading\"\u003E1、物理内存 &amp; 虚拟内存\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E物理内存（Physical Memory）\u003C\u002Fstrong\u003E: 指通过物理内存条而获得的内存空间，和虚拟内存对应；主要作用是：设备运行时为操作系统和各种程序提供临时储存空间；iPhone 6 和 6 Plus 及之前都是1G 内存，目前比较新的iPhone XS和XS Max是4GB内存；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E虚拟内存(Virtual Memory)\u003C\u002Fstrong\u003E：是计算机系统内存管理的一种技术，为每一个进程提供了一个\u003Cstrong\u003E一致的、私有的地址空间\u003C\u002Fstrong\u003E；其主要作用是：保护了每个进程的地址空间不会被其他进程破坏，降低内存管理的复杂性；32位设备虚拟内存大小是4GB，64位设备（5s以后的设备）是 4GB * 4GB；\u003C\u002Fli\u003E\n\u003Cli\u003E虚拟内存是进程运行时所有内存空间的总和，并且可能有一部分不在物理内存中；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E2、段页式存储\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E目前，大部分通用的计算机的内存管理使用\u003Cstrong\u003E段页式存储结构\u003C\u002Fstrong\u003E；用户程序先分段，每个段内再分页；而\u003Cstrong\u003E页是存储的最基本单位\u003C\u002Fstrong\u003E，iOS设备的arm64架构后，页大小是16KB；\u003C\u002Fli\u003E\n\u003Cli\u003E利用\u003Cstrong\u003E逻辑地址\u003C\u002Fstrong\u003E(段号 + 段内页号 + 页内地址) 进行地址变化，获得物理地址；这样的话，在段页式结构中，须\u003Cstrong\u003E三次访问\u003C\u002Fstrong\u003E内存才能获取数据或指令；\u003C\u002Fli\u003E\n\u003Cli\u003E当进程访问一个虚拟内存的页时，而对应的物理内存却不存在时，会触发一次\u003Cstrong\u003EPage Fault\u003C\u002Fstrong\u003E（\u003Cstrong\u003E缺页中断\u003C\u002Fstrong\u003E），将需要的数据 or 指令从磁盘加载到物理内存页中，建立映射关系，然后再恢复现场，程序本身是无感知的；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E3、Swap In\u002FOut &amp; Page In\u002FOut\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E磁盘内部有一个区域叫做\u003Cstrong\u003E交换空间\u003C\u002Fstrong\u003E(Swap Space)，MMU(内存管理单元) 会将\u003Cstrong\u003E暂时不用的内存块内容\u003C\u002Fstrong\u003E写在交互空间上(硬盘)，这就是\u003Cstrong\u003ESwap Out\u003C\u002Fstrong\u003E；当需要时候再从Swap Space中读取到内存中，这就是\u003Cstrong\u003ESwap In\u003C\u002Fstrong\u003E；Swap in和swap out的操作都是比较耗时的, 频繁的Swap in和Swap out操作非常影响系统性能；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003EPage In\u002FOut\u003C\u002Fstrong\u003E和 \u003Cstrong\u003ESwap In\u002FOut\u003C\u002Fstrong\u003E 概念类似，只不过Page In\u002FOut是将\u003Cstrong\u003E某些页\u003C\u002Fstrong\u003E的数据写到内存\u002F从内存写回磁盘交互区；而Swap In\u002FOut是将\u003Cstrong\u003E整个地址空间\u003C\u002Fstrong\u003E的数据写到内存\u002F从内存写回磁盘交互区；本质都是交互机制。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EmacOS支持这类交换机制，但是iOS不支持；主要有两方面考虑吧：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E移动设备的闪存读写次数有限，频繁写会降低寿命；\u003C\u002Fli\u003E\n\u003Cli\u003E相比PC机，移动设备闪存空间有限(15年6s最小存储空间16GB、最大128GB；19年XS Max最小64GB，最大521GB)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E4、to be continued\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E通用的计算机（\u003Cem\u003E大型机和专用计算机不在此范围\u003C\u002Fem\u003E）的存储器一般设置为多层，从最靠近CPU的Cache一直到磁盘，速度越来越慢，价格也越来越便宜。\u003C\u002Fli\u003E\n\u003Cli\u003E为了充分利用好硬件资源，Cache和Swap机制应运而生，Cache机制是一种用空间换时间的机制；而Swap机制是使用时间换空间的；\u003C\u002Fli\u003E\n\u003Cli\u003E但是，iOS系统舍弃交换机制，取而代之的是\u003Cstrong\u003E压缩内存（Compressed memory）机制\u003C\u002Fstrong\u003E；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 class=\"heading\"\u003E二、iOS内存管理基础概念\u003C\u002Fh3\u003E\n\u003Ch4 class=\"heading\"\u003E1、iOS的内存分区\u003C\u002Fh4\u003E\n\u003Cp\u003E从高地址到低地址各区域如下：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E栈区(stack)\u003C\u002Fstrong\u003E： 由编译器⾃动分配，存放函数的参数值，局部变量的值等，作用域执行完毕之后，就会被系统收回；(栈区的地址从高到低分配)\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E堆区(heap)\u003C\u002Fstrong\u003E：一般由程序员分配和释放，用于存放程序运行中被动态分配的内存段；iOS中的Objective-C对象存放在这里，由ARC管理；（堆区的地址是从低到高分配）\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E全局区静态区\u003C\u002Fstrong\u003E：由编译器分配，主要是存放全局变量 和 静态变量，程序结束后由系统释放；主要分两个区：\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EBSS区\u003C\u002Fstrong\u003E：\u003Cstrong\u003E未初始化\u003C\u002Fstrong\u003E的全局变量 和 静态变量；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E数据区\u003C\u002Fstrong\u003E：\u003Cstrong\u003E已初始化\u003C\u002Fstrong\u003E的全局变量 和 静态变量；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E常量区：\u003C\u002Fstrong\u003E 存放的是常量，如常量字符串，程序结束后由系统释放；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E代码区\u003C\u002Fstrong\u003E：存放函数体的二进制代码，程序结束后由系统释放；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cfigure\u003E\u003Cimg alt=\"内存分区示意\" src=\"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fgold-user-assets\u002F2020\u002F4\u002F9\u002F1715e3aff4615a4d~tplv-t2oaga2asx-image.image\"\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\n\u003Ch4 class=\"heading\"\u003E2、内存页类型：Clean和Dirty\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E内存页按照各自的\u003Cstrong\u003E分配和使用\u003C\u002Fstrong\u003E状态，分为 \u003Ccode\u003EClean\u003C\u002Fcode\u003E 和 \u003Ccode\u003EDirty\u003C\u002Fcode\u003E 两类。其中\u003Ccode\u003EClean Page\u003C\u002Fcode\u003E是可以被回收的，\u003Ccode\u003EDirty Page\u003C\u002Fcode\u003E不能；\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs objective-c\" lang=\"objective-c\"\u003Eint *array = malloc(20000 * sizeof(int)); \u002F\u002F 第1步\narray[0] = 32                             \u002F\u002F 第2步\narray[19999] = 64                         \u002F\u002F 第3步\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E第一步，申请一块长度为80000 字节的内存空间，按照一页 16KB 来计算，就需要 6 页内存来存储。当这些内存页开辟出来的时候，它们都是 Clean 的；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E第二步，向处于第一页的内存写入数据时，第一页内存会变成 Dirty；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E第三步，当向处于最后一页的内存写入数据时，这一页也会变成 Dirty；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E3、VM Region\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EiOS进程中所有内存就是由许许多多的\u003Ccode\u003EVM Region\u003C\u002Fcode\u003E组成的；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003EVM Region\u003C\u002Fcode\u003E指\u003Cstrong\u003E一段连续的内存页（在虚拟地址空间里）\u003C\u002Fstrong\u003E，\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fopensource.apple.com\u002Fsource\u002Fxnu\u002Fxnu-792\u002Fosfmk\u002Fmach\u002Fvm_region.h\"\u003EVM Region\u003C\u002Fa\u003E的结构如下\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs objective-c\" lang=\"objective-c\"\u003Estruct vm_region_submap_info_64 {\n\tvm_prot_t\t\tprotection;     \u002F* present access protection *\u002F\n\tvm_prot_t\t\tmax_protection; \u002F* max avail through vm_prot *\u002F\n\tvm_inherit_t\t\tinheritance;\u002F* behavior of map\u002Fobj on fork *\u002F\n\tmemory_object_offset_t\toffset;\t\t\u002F* offset into object\u002Fmap *\u002F\n  unsigned int            user_tag;\t\u002F* user tag on map entry *\u002F\n  unsigned int            pages_resident;\t\u002F* only valid for objects *\u002F\n  unsigned int            pages_shared_now_private; \u002F* only for objects *\u002F\n  unsigned int            pages_swapped_out; \u002F* only for objects *\u002F\n  unsigned int            pages_dirtied;   \u002F* only for objects *\u002F\n  unsigned int            ref_count;\t \u002F* obj\u002Fmap mappers, etc *\u002F\n  unsigned short          shadow_depth; \t\u002F* only for obj *\u002F\n  unsigned char           external_pager;  \u002F* only for obj *\u002F\n  unsigned char           share_mode;\t\u002F* see enumeration *\u002F\n\tboolean_t\t\tis_submap;\t\u002F* submap vs obj *\u002F\n\tvm_behavior_t\t\tbehavior;\t\u002F* access behavior hint *\u002F\n\tvm_offset_t\t\tobject_id;\t\u002F* obj\u002Fmap name, not a handle *\u002F\n\tunsigned short\t\tuser_wired_count; \n};\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EVM Region包含的重要信息有：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003Epages_resident\u003C\u002Fstrong\u003E：在用的物理内存页数\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003Epages_dirtied\u003C\u002Fstrong\u003E：Dirty的内存页数\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003Epages_swapped_out\u003C\u002Fstrong\u003E：Swapped的内存页数（\u003Cstrong\u003E实际指的是被Compressed Memory页数\u003C\u002Fstrong\u003E）\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E可以通过了解\u003Cstrong\u003Epages_dirtied\u003C\u002Fstrong\u003E和\u003Cstrong\u003Epages_swapped_out\u003C\u002Fstrong\u003E来了解\u003Ccode\u003EVM Region\u003C\u002Fcode\u003E的真实物理内存使用。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 class=\"heading\"\u003E三、iOS内存管理机制\u003C\u002Fh3\u003E\n\u003Ch4 class=\"heading\"\u003E1、OC的内存管理\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003EObjective-C提供两种方式的内存管理方式：\u003Cstrong\u003EMRC\u003C\u002Fstrong\u003E（手动管理引用计数）和  \u003Cstrong\u003EARC\u003C\u002Fstrong\u003E（自动引用计数）\u003C\u002Fli\u003E\n\u003Cli\u003EObjective-C内存管理的基本原则：谁创建，谁释放，谁引用，谁管理；\u003C\u002Fli\u003E\n\u003Cli\u003EiOS 5之后提出的ARC被广泛接收，毕竟不需要管理引用计数是个很爽的事情；有了ARC，开开心心写OC；但是\u003Cstrong\u003EARC只管理Objective-C对象的内存\u003C\u002Fstrong\u003E，CoreFoundation对象、CoreGraphics对象、还有C\u002FC++的内存分配还是需要开发者自己管理。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cfigure\u003E\u003Cimg alt=\"OC的内存管理图\" src=\"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fgold-user-assets\u002F2020\u002F4\u002F9\u002F1715e39230e29f4a~tplv-t2oaga2asx-image.image\"\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\n\u003Ch4 class=\"heading\"\u003E2、系统内存分类\u003C\u002Fh4\u003E\n\u003Cp\u003E​\t从 iOS7 开始，系统开始采用\u003Ccode\u003ECompressed Memory\u003C\u002Fcode\u003E机制优化内存使用，内存类型可以分为三类：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003EClean Memory\u003C\u002Fcode\u003E：可以被释放或重建的，主要包括：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ECode\u003C\u002Fli\u003E\n\u003Cli\u003Eframework，每个 framework都有 \u003Ccode\u003E_DATA_CONST\u003C\u002Fcode\u003E 段，当 App 在运行时使用到了某个 framework，它所对应的 \u003Ccode\u003E_DATA_CONST\u003C\u002Fcode\u003E 的内存就会由 Clean 变为 Dirty。\u003C\u002Fli\u003E\n\u003Cli\u003Ememory-mapped files（已被加载到内存中的文件）\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E：指那些被写入过数据的内存，主要包括：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E所有堆区中的对象（Heap allocations）\u003C\u002Fli\u003E\n\u003Cli\u003E图像解码缓冲区（Decoded image buffers）\u003C\u002Fli\u003E\n\u003Cli\u003Eframeworks（framework中 \u003Ccode\u003E_DATA\u003C\u002Fcode\u003E 段和 \u003Ccode\u003E_DATA_DIRTY\u003C\u002Fcode\u003E 段）\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs bash\" lang=\"bash\"\u003E\t在使用 framework 的过程中会产生Dirty Memory，使用单例或者全局初始化方法是减少Dirty Memory；这是因为单例一旦创建就不会销毁，全局初始化方法会在 class 加载时执行。\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003ECompressed Memory\u003C\u002Fcode\u003E：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E在内存吃紧时，系统会将不使用的内存进行压缩(Compresses unaccessed pages)\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E在需要的时候，进行解压 （Decompresses pages upon access）\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E优势：减少了不活跃内存占用；减少磁盘IO带来的损耗；压缩\u002F解压十分迅速，能够尽可能减少 CPU 的时间开销；支持多核操作。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E举例\u003C\u002Fstrong\u003E：当我们使用 \u003Ccode\u003ENSDictionary\u003C\u002Fcode\u003E 去缓存数据的时候，假设现在已经使用了 3 页内存，当不访问的时候可能会被压缩为 1 页，再次使用到时候又会解压成 3 页。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E介绍\u003Ccode\u003EClear Memory\u003C\u002Fcode\u003E和 \u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E 的Code如下：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs objective-c\" lang=\"objective-c\"\u003E\u002F\u002F堆分配的内存 Dirty Memory\nNSString *str1 = [NSString stringWithString:@\"Welcome!\"]; \n\u002F\u002F常量字符串, 存放在一个只读数据段里面,这段内存释放后,还可以在读取重建 Clear Memory\nNSString *str2 = @\"Welcome!\"; \n\u002F\u002F分配100M虚拟内存,当没有用时没有建立映射,Clear Memory\nchar *buf = malloc(100 * 1024 *1024); 关系\nfor (int i = 0; i &lt; 3 * 1024 * 1024; ++i) {\n    \u002F\u002F写入数据了,Dirty Memory\n\t\tbuf[i] = rand();\t\t\t\t\t\t\t\t\t\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E说明\u003C\u002Fstrong\u003E：在内存吃紧的情况下，释放\u003Ccode\u003EClean Memory\u003C\u002Fcode\u003E，不能释放\u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E ，所以\u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E 的内存越多，App的稳定性越差。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E3、\u003Ccode\u003EJetsam\u003C\u002Fcode\u003E机制\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EJetsam机制是操作系统为了控制内存资源过度使用而采用的一种管理机制；Jetsam是一个独立运行的进程，会把一些\u003Cstrong\u003E优先级不高或者占用内存过大的\u003C\u002Fstrong\u003EApp杀掉；在杀掉App后会记录一些数据信息并保存到日志。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EApp优先级可以这么简单理解：前台App &gt; 后台App; 占用内存少 &gt; 占用内存多；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EJetsam产生的这些日志可以在\u003Cstrong\u003E手机设置-&gt;隐私-&gt;分析\u003C\u002Fstrong\u003E中找到，日志是以\u003Ccode\u003EJetsamEvent\u003C\u002Fcode\u003E开头，日志中有内存页大小(pageSize)，CPU时间(cpuTime)等字段。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E查看\u003Ccode\u003E设置-&gt;隐私-&gt;分析\u003C\u002Fcode\u003E中以JetsamEvent开头的系统日志，关注两个重要的信息；\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs python\" lang=\"python\"\u003E\u003Cspan class=\"hljs-string\"\u003E\"pageSize\"\u003C\u002Fspan\u003E : \u003Cspan class=\"hljs-number\"\u003E16384\u003C\u002Fspan\u003E,\n\u002F\u002F内存页达到上限\n\u003Cspan class=\"hljs-string\"\u003E\"rpages\"\u003C\u002Fspan\u003E : \u003Cspan class=\"hljs-number\"\u003E948\u003C\u002Fspan\u003E,      \u002F\u002FApp 占用的内存页数量\n\u003Cspan class=\"hljs-string\"\u003E\"reason\"\u003C\u002Fspan\u003E : \u003Cspan class=\"hljs-string\"\u003E\"per-process-limit\"\u003C\u002Fspan\u003E,  \u002F\u002FApp 占用的内存超过了系统对单个 App 的内存限制。\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E说明\u003C\u002Fstrong\u003E：该内存“上限”计算：pageSize \u003Cem\u003Erpages = 16384\u003C\u002Fem\u003E 948 \u002F1024\u002F1014 = 14.8MB，这个App应该是因优先级不高而被强杀，毕竟App内存使用上限不可能不到15MB。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E4、内存警告\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E内存警告（Memory Warning）三种通知方式:\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EUIApplicationDelegate\u003C\u002Fstrong\u003E的\u003Ccode\u003EapplicationDidReceiveMemoryWarning:\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E视图控制器\u003Cstrong\u003EUIViewController\u003C\u002Fstrong\u003E的\u003Ccode\u003EdidReceiveMemoryWarning\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EUIApplicationDidReceiveMemoryWarningNotification\u003C\u002Fstrong\u003E通知\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E出现OOM前不一定出现内存警告；有可能是瞬间申请了大量内存，而恰好此时主线程在忙于其他事情，导致可能没有经历过Memory Warning就发生了OOM；也可能即便出现了多次Memory Warning后，也不见得会在最后一次Memory Warning的几秒钟后出现OOM(可能是1-2分钟后)；\u003C\u002Fli\u003E\n\u003Cli\u003E并非所有内存警告都是由 App 造成的，例如在内存较小的设备上，当你接听电话的时候也有可能发生内存警告。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 class=\"heading\"\u003E四、常见的内存类问题\u003C\u002Fh3\u003E\n\u003Ch4 class=\"heading\"\u003E1、FOOM\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EFOOM（Foreground Out Of Memory），是指App\u003Cstrong\u003E在前台\u003C\u002Fstrong\u003E因消耗内存过多引起系统强杀。对用户而言，表现跟Crash一样。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EFacebook早在2015年8月提出FOOM检测办法，大致原理是排除各种情况后，剩余的情况是FOOM；Facebook如何判定上一次启动是否出现FOOM方法：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E1.App没有升级\u003C\u002Fli\u003E\n\u003Cli\u003E2.App没有调用exit()或abort()退出\u003C\u002Fli\u003E\n\u003Cli\u003E3.App没有出现Crash (依赖于自身CrashReport组件的Crash回调)\u003C\u002Fli\u003E\n\u003Cli\u003E4.用户没有强退App\u003C\u002Fli\u003E\n\u003Cli\u003E5.系统没有升级\u002F重启\u003C\u002Fli\u003E\n\u003Cli\u003E6.App当时没有后台运行（依赖于ApplicationState和前后台切换通知）\u003C\u002Fli\u003E\n\u003Cli\u003E7.App出现FOOM （依赖于ApplicationState和前后台切换通知）\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E排查法有误报的可能，因为有些被系统强杀case，但是我们捕获不到信息，也可能被归类到OOM；已知被系统强杀的case是：OOM和watchdog(Code 0x8badf00d)。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E发现FOOM问题的关键：监控App使用内存增长，在收到内存警告通知时，dump 内存信息，获取对象名称、对象个数、各对象的内存值，并在合适的时机上报到服务器；加强对大内存的分配监控。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E2、内存泄露\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E内存泄露(Memory Leak)：指申请的内存空间使用完毕之后\u003Cstrong\u003E未回收\u003C\u002Fstrong\u003E，内存泄露问题多的话，对App质量影响很大；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E目前引起内存泄露的主要原因是循环引用(堆内存中对象相互引用，彼此都得不到释放的机会)，目前，调试阶段使用Instrument的Leaks工具发现，线上利用MLeaksFinder发现后上报；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E如何避免内存泄露在后面有介绍\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E3、WKWebview白屏\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EWKWebview白屏问题，严格来说，是一种内存方面的问题；之前的UIWebview因为内存使用过大会Crash，而WKWebview不会Crash，会白屏；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EWKWebView是一个多进程组件，\u003Ccode\u003ENetwork Loading\u003C\u002Fcode\u003E以及\u003Ccode\u003EUI Rendering\u003C\u002Fcode\u003E在其它进程中执行，当WKWebView总体的内存占用比较大时，\u003Ccode\u003EWebContent Process\u003C\u002Fcode\u003E会Crash，从而出现白屏现象。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E解决办法\u003C\u002Fstrong\u003E：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EKVO监听URL, 当URL为nil，重新reload\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E在进程被终止回调中，重新reload\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs objective-c\" lang=\"objective-c\"\u003E\u002F\u002F 此方法适用iOS9.0以上 \n- (void)webViewWebContentProcessDidTerminate:(WKWebView *)webView NS_AVAILABLE(10_11, 9_0){\n\t\t\u002F\u002Freload\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E4、野指针问题\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E野指针\u003C\u002Fstrong\u003E：指向一个已删除的对象 或 受限内存区域的指针；目前此类问题很少了，主要来自两个方面\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EMRC时代 到 ARC时代，OC对象管理极大方便了，ARC解决大部分野指针问题\u003C\u002Fli\u003E\n\u003Cli\u003EiOS 9开始，系统库中部分遗留的被\u003Ccode\u003Eassign(unsafe_unretain)\u003C\u002Fcode\u003E修饰的 \u003Ccode\u003Edelegate\u003C\u002Fcode\u003E和\u003Ccode\u003Etarget-action\u003C\u002Fcode\u003E修改成了weak，内存被回收的时候，这些指针设为nil，这也大幅度减少了野指针的出现。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E目前绝大部分App都是iOS 9起步，野指针少了很多，但是工程中依然会有野指针问题，本质还是内存使用不当；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003EMach Exception\u003C\u002Fcode\u003E大多数都是野指针的问题，崩溃日志里最多见\u003Ccode\u003Eobjc_msgSend\u003C\u002Fcode\u003E和\u003Ccode\u003Eunrecognized selector sent to\u003C\u002Fcode\u003E等等。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E对于野指针问题，最好能复现，使用\u003Ccode\u003EZombie Object\u003C\u002Fcode\u003E 帮助调试，\u003Ccode\u003EZombie Object\u003C\u002Fcode\u003E 实现原理就是 hook 住了对象的\u003Ccode\u003Edealloc\u003C\u002Fcode\u003E方法，通过调用自己的\u003Ccode\u003E__dealloc_zombie\u003C\u002Fcode\u003E方法来把对象进行僵尸化，当这个对象再次收到消息,\u003Ccode\u003Eobjc_msgsend\u003C\u002Fcode\u003E的时候，调用abort()崩溃并打印出调用的方法。。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E\u003Cstrong\u003EiOS 9以后NSNotificationCenter不需要手动移除观察者\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E在iOS9之前，通知中心使用 \u003Cstrong\u003Eunsafe_unretained\u003C\u002Fstrong\u003E修饰引用观察者，如果观察者被回收时，若不手动移除，指针会指向被回收的内存区域，变为野指针，如果再发送消息会造成Crash；\u003C\u002Fli\u003E\n\u003Cli\u003E而iOS 9之后，通知中心使用\u003Cstrong\u003Eweak\u003C\u002Fstrong\u003E修饰引用观察者 ，即使不手动移除观察者，weak指针也会在观察者被回收后自动置nil。之后发送消息，是不会有问题的。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch4 class=\"heading\"\u003E5、iOS 10 nano_free Crash\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E在iOS 10.0 - 10.1，苹果bug引入nano_free Crash问题，这些Crash发生\u003Ccode\u003Elibsystem_malloc.dylib\u003C\u002Fcode\u003E中的 \u003Ccode\u003Enano zone\u003C\u002Fcode\u003E内的；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003Elibsystem_malloc.dylib\u003C\u002Fcode\u003E中，对内存的管理有两个实现：\u003Ccode\u003Enano zone\u003C\u002Fcode\u003E和\u003Ccode\u003Escalable zone\u003C\u002Fcode\u003E。他们分别管理不同大小的内存块：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E内存分配函数malloc和calloc等默认使用的是nano_zone，nao_zone是 256B 以下小内存的分配，\u003C\u002Fli\u003E\n\u003Cli\u003E大于 256B 的时候会使用 \u003Cstrong\u003Escalable_zone\u003C\u002Fstrong\u003E 来分配。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E当时微信团队提出的几种解决思路，最后给的解决方案是\u003Cstrong\u003E不使用nano zone\u003C\u002Fstrong\u003E，具体描述\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E创建一个自己的zone，命名为\u003Ccode\u003Eguard zone\u003C\u002Fcode\u003E。\u003C\u002Fli\u003E\n\u003Cli\u003E修改nano zone的函数指针，重定向到guard zone(通过\u003Ccode\u003Emalloc_zone_create\u003C\u002Fcode\u003E创建的)。\n\u003Cul\u003E\n\u003Cli\u003E对于没有传入指针的函数，直接重定向到guard zone\u003C\u002Fli\u003E\n\u003Cli\u003E对于有传入指针的函数，先用size判断所属的zone，再进行分发。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E更多见：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fcloud.tencent.com\u002Fdeveloper\u002Farticle\u002F1031006\"\u003E聊聊苹果的Bug - iOS 10 nano_free Crash\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fopensource.apple.com\u002Ftarballs\u002Flibmalloc\u002F\"\u003Elibsystem_malloc.dylib 源码\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E6、to be continued\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E内存类问题排查难度大，复杂。需要对内存有更深入的理解\u003C\u002Fli\u003E\n\u003Cli\u003E为了避免内存问题：根本上是优化内存使用，主要表现在：减少大块内存使用，降低内存峰值，避免内存泄露，处理内存警告;\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 class=\"heading\"\u003E五、优化内存使用\u003C\u002Fh3\u003E\n\u003Ch4 class=\"heading\"\u003E1、降低图片解码和渲染开销\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E将图片渲染显示在屏幕上，需要先将其解码成位图；而位图大小：\u003Cstrong\u003E像素高 * 像素宽 * 4字节\u003C\u002Fstrong\u003E(\u003Cem\u003E4字节对应一个像素点，4个通道的大小\u003C\u002Fem\u003E)；图片解码会造成内存使用上升，尤其是高分辨率图解码可能导致内存暴涨；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E代码优化建议\u003C\u002Fstrong\u003E：\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E善待\"大\"图（位图大小大于60MB）解码：将原图裁剪成多个小图，然后依次绘制到目标位图context中，具体可见SDWebImage中和关于**decodedAndScaledDownImageWithImage:**的实现；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E限制并发解码图片的个数；\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E图片大小调整和显示大小一样，以此避免重采样(重采样也很消耗资源，放大图像称为上采样\u002F插值（upsamping），缩小图像为小采样（downsampling));\u003C\u002Fli\u003E\n\u003Cli\u003E使用 ImageIO直接读取图像大小和元数据信息，减少内存开销。\u003C\u002Fli\u003E\n\u003Cli\u003EiOS10后使用 \u003Ccode\u003EUIGraphicsImageRenderer\u003C\u002Fcode\u003E 创建 image 上下文，而不是\u003Ccode\u003EUIGraphicsBeginImageContextWithOptions\u003C\u002Fcode\u003E，因为前者的性能更好、更高效，并且支持广色域；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E2、其他降低内存峰值办法\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E合理使用\u003Ccode\u003Eautorealsepool\u003C\u002Fcode\u003E，降低内存峰值，避免 OOM\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E基于引用计数,Pool执行drain方法会release所有该Pool中的autorelease对象\u003C\u002Fli\u003E\n\u003Cli\u003E可以嵌套多个AutoReleasePool\u003C\u002Fli\u003E\n\u003Cli\u003E每个线程并没有设置默认的AutoReleasePool,需要手动创建,避免内存泄露\u003C\u002Fli\u003E\n\u003Cli\u003E在一段内存分配频繁的代码中嵌套AutoReleasePool有利于降低整体内存峰值\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E复用大内存对象，如UITableViewCell对象；懒加载大的内存对象\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EimageNamed 和 imageWithContentOfFile 的选择\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EimageNamed使用系统缓存，适用于频繁使用的小图片\u003C\u002Fli\u003E\n\u003Cli\u003EimageWithContentOfFile不带缓存机制,适用于大图片,使用完就释放\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E建议NSData读取文件方式\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E建议使用\u003Ccode\u003E[NSData dataWithContentsOfFile:path options:NSDataReadingMappedIfSafe error:&amp;error]\u003C\u002Fcode\u003E;\u003C\u002Fli\u003E\n\u003Cli\u003E该API映射文件到虚拟内存, 只有读取操作的时候才会读取相应页的内容到物理内存页中；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E用 \u003Ccode\u003ENSCache\u003C\u002Fcode\u003E 代替 \u003Ccode\u003ENSMutableDictionary\u003C\u002Fcode\u003E， 因为 \u003Ccode\u003ENSCache\u003C\u002Fcode\u003E 可以自动清理内存，在内存吃紧的时候会更加合理。\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ENSCache有2种界限条件:totalCostLimt &amp; countLimit，超过这两种界限后系统会去释放一些旧的资源.\u003C\u002Fli\u003E\n\u003Cli\u003E监听到内存警告消息后移除所有Cache\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E使用 NSPurgableData 代替NSData，主要原因如下：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E当系统处于低内存的时候会自动移除\u003C\u002Fli\u003E\n\u003Cli\u003E适用于大数据\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E栈内存分配\u003C\u002Fstrong\u003E：\u003Ccode\u003Ealloca(size_t)\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E栈分配仅仅修改栈指针寄存器，比malloc遍历并修改空闲列表要快得多\u003C\u002Fli\u003E\n\u003Cli\u003E栈内存一般都已经在物理内存中，不用担心页错误\u003C\u002Fli\u003E\n\u003Cli\u003E函数返回的时候栈分配的空间都会自动释放\u003C\u002Fli\u003E\n\u003Cli\u003E但仅适合小空间的分配,并且函数嵌套不宜过深\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E堆内存分配\u003C\u002Fstrong\u003E：\u003Cstrong\u003Ecalloc\u003C\u002Fstrong\u003E \u003Cstrong\u003EVS\u003C\u002Fstrong\u003E \u003Cstrong\u003Emalloc + memset\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Ecalloc(size_t num,size_t size)\u003C\u002Fcode\u003E分配内存时是虚拟内存，只有在访问的时候才会发生物理页的映射关系；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Emalloc + memset\u003C\u002Fcode\u003E 会产生\u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Ecalloc\u003C\u002Fcode\u003E函数得到的内存空间是经过初始化的，其内容全为0，而\u003Ccode\u003Emalloc\u003C\u002Fcode\u003E函数得到的内存空间是未初始化的，必须使用memset函数来初始化；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E3、避免循环引用，减少内存泄露\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E代码优化建议\u003C\u002Fstrong\u003E\n\u003Cul\u003E\n\u003Cli\u003E申明代理(delegate)为weak；\u003C\u002Fli\u003E\n\u003Cli\u003E使用 \u003Ccode\u003Eweak strong dance\u003C\u002Fcode\u003E 来解决 block 中的循环引用问题；\u003C\u002Fli\u003E\n\u003Cli\u003E实现NSProxy(虚拟类)的子类，然后在子类中定义weak修饰的target，然后实现消息转发方法，使target处理业务逻辑；一般用于解决NSTimer、CADisplayLink的循环引用；\u003C\u002Fli\u003E\n\u003Cli\u003ECoreFoundation对象、CoreGraphics对象、还有C\u002FC++的内存分配需要管理好，有malloc就要有free\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E善用工具：\u003Cstrong\u003EMLeaksFinder + Instrument\u003C\u002Fstrong\u003E 或 \u003Cstrong\u003EFBMemoryProfiler + Instrument\u003C\u002Fstrong\u003E组合使用。通过MLeaksFinder\u002FFBMemoryProfiler发现后。然后使用Instrument再验证；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 class=\"heading\"\u003E4、处理内存警告\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003EMemory Warning时，尽可能释放多资源，尤其图片等占内存多的资源，等需要用的时候再重建；\u003C\u002Fli\u003E\n\u003Cli\u003EMemory Warning时，部分单例对象可考虑释放掉；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EMemory Warning时，不建议self.view = nil\u003C\u002Fstrong\u003E：iOS 6之后，系统发出 Memory Warning 时，\u003Cstrong\u003E系统会自动回收CALayer的CABackingStore对象(bitmap 内容)\u003C\u002Fstrong\u003E；虽然没有回收 UIView 和 CALayer 类，但是也回收了大部分内存，在需要 bitmap 类时，通过调用 UIView 的 drawRect: 方法重建。\u003C\u002Fli\u003E\n\u003Cli\u003E最佳的实践还是\u003Cstrong\u003E减少大块内存使用，降低内存峰值，避免内存泄露\u003C\u002Fstrong\u003E。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 class=\"heading\"\u003E历史文章\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Cstrong\u003E之前对内存问题一些整理\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"http:\u002F\u002Fnanhuacoder.top\u002F2018\u002F01\u002F30\u002FiOS-iOSMemory\"\u003EOC对象内存小记\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"http:\u002F\u002Fnanhuacoder.top\u002F2019\u002F04\u002F17\u002FiOS-OOM\u002F\"\u003EOOM问题小记\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003Cstrong\u003E之前对图片解码和图片优化一些总结\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002F728f71b9fe28\"\u003E篇1：SDWebImage源码看图片解码\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002Fa38a7c7bccbb\"\u003EiOS实录17：网络图片的优化显示\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"http:\u002F\u002Fnanhuacoder.top\u002F2019\u002F03\u002F13\u002FiOS-PicDecode\"\u003E图片解码小记\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 class=\"heading\"\u003E参考文章\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fblog.csdn.net\u002FTuGeLe\u002Farticle\u002Fdetails\u002F104004692\"\u003E深入了解iOS中的OOM(低内存崩溃)\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fjuejin.cn\u002Fpost\u002F6844903621276991502#heading-3\"\u003EWWDC 2018：iOS 内存深入研究\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fyq.aliyun.com\u002Farticles\u002F55820\"\u003Epage fault带来的性能问题\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fwetest.qq.com\u002Flab\u002Fview\u002F367.html\"\u003EiOS微信内存监控\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fjuejin.cn\u002Fpost\u002F6844903747538141191\"\u003EiOS野指针定位总结\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002F8e764d05275b\"\u003EiOS中的内存管理\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F49829766\"\u003EiOS 内存管理研究\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002Ff9b8c139c2ed\"\u003ELinux对内存的管理, 以及page fault的概念\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fyq.aliyun.com\u002Farticles\u002F3065\"\u003EiOS内存管理和malloc源码解读\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fturingh.github.io\u002F2016\u002F06\u002F28\u002Flibmalloc%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%88%9D%E5%A7%8B%E5%8C%96\u002F\"\u003Elibmalloc源码分析之初始化\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n",originalUrl:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F6844904119723884551",type:"post",collected:a,viewsCount:6956,username:"南华Coder",viewerHasLiked:a,draftId:"6845076719783641095",collectionCount:74},entryView:{},author:{id:"3016715633959592",self_description:void 0,followed:a,viewerIsFollowing:void 0,community:void 0,subscribedTagCount:d,wroteBookCount:d,boughtBookCount:d,isBindedPhone:a,level:4,user_id:"3016715633959592",user_name:"南华Coder",company:e,job_title:"程序猿",avatar_large:"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fgold-user-assets\u002F2018\u002F3\u002F29\u002F1627085161a3210c~tplv-t2oaga2asx-image.image",description:"于无声处听惊雷,于无色处见繁花",followee_count:35,follower_count:2962,post_article_count:31,digg_article_count:48,got_digg_count:642,got_view_count:124074,post_shortmsg_count:d,digg_shortmsg_count:l,isfollowed:a,favorable_author:d,power:3326,study_point:d,university:{university_id:f,name:e,logo:e},major:{major_id:f,parent_id:f,name:e},student_status:d,select_event_count:d,select_online_course_count:d,identity:d,is_select_annual:a,select_annual_rank:d,annual_list_type:d,extraMap:{},is_logout:d,annual_info:[],account_amount:d,user_growth_info:{user_id:3016715633959592,jpower:3326,jscore:287.6,jpower_level:4,jscore_level:4,jscore_title:"进阶掘友",author_achievement_list:[],vip_level:d,vip_title:e,jscore_next_level_score:500,jscore_this_level_mini_score:d},is_vip:a,become_author_days:d,collection_set_article_count:d,juejinPower:3326,jobTitle:"程序猿",roles:{isBookAuthor:a,isFavorableAuthor:a,isCobuilder:a,isAdmin:a},username:"南华Coder",blogAddress:void 0,selfDescription:"于无声处听惊雷,于无色处见繁花",beLikedCount:642,beReadCount:124074,followerCount:2962,followingCount:35,collectionCount:d,createdCollectionCount:d,followingCollectionCount:d,postedPostsCount:31,pinCount:d,likedArticleCount:48,likedPinCount:l,avatar:"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fgold-user-assets\u002F2018\u002F3\u002F29\u002F1627085161a3210c~tplv-t2oaga2asx-image.image",latestLoginedInAt:c,createdAt:c,updatedAt:c,phoneNumber:e,titleDescription:e,followeesCount:35,applyEventCount:d,need_lead:d,followTopicCnt:d},adEntryList:[],relatedEntryList:[],linkVotingList:[],userAnnuals:[],columnList:[],resultHtml:"\u003Cstyle\u003E.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;margin-bottom:5px}.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{font-size:20px}.markdown-body h2{padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre\u003Ecode{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:\"\"}.markdown-body blockquote\u003Ep{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}\u003C\u002Fstyle\u003E\u003Cp\u003E简单总结下iOS内存方面的一些知识\u003C\u002Fp\u003E\n\u003Ch3 data-id=\"heading-0\"\u003E一、内存基础概念\u003C\u002Fh3\u003E\n\u003Ch4 data-id=\"heading-1\"\u003E1、物理内存 &#x26; 虚拟内存\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E物理内存（Physical Memory）\u003C\u002Fstrong\u003E: 指通过物理内存条而获得的内存空间，和虚拟内存对应；主要作用是：设备运行时为操作系统和各种程序提供临时储存空间；iPhone 6 和 6 Plus 及之前都是1G 内存，目前比较新的iPhone XS和XS Max是4GB内存；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E虚拟内存(Virtual Memory)\u003C\u002Fstrong\u003E：是计算机系统内存管理的一种技术，为每一个进程提供了一个\u003Cstrong\u003E一致的、私有的地址空间\u003C\u002Fstrong\u003E；其主要作用是：保护了每个进程的地址空间不会被其他进程破坏，降低内存管理的复杂性；32位设备虚拟内存大小是4GB，64位设备（5s以后的设备）是 4GB * 4GB；\u003C\u002Fli\u003E\n\u003Cli\u003E虚拟内存是进程运行时所有内存空间的总和，并且可能有一部分不在物理内存中；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-2\"\u003E2、段页式存储\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E目前，大部分通用的计算机的内存管理使用\u003Cstrong\u003E段页式存储结构\u003C\u002Fstrong\u003E；用户程序先分段，每个段内再分页；而\u003Cstrong\u003E页是存储的最基本单位\u003C\u002Fstrong\u003E，iOS设备的arm64架构后，页大小是16KB；\u003C\u002Fli\u003E\n\u003Cli\u003E利用\u003Cstrong\u003E逻辑地址\u003C\u002Fstrong\u003E(段号 + 段内页号 + 页内地址) 进行地址变化，获得物理地址；这样的话，在段页式结构中，须\u003Cstrong\u003E三次访问\u003C\u002Fstrong\u003E内存才能获取数据或指令；\u003C\u002Fli\u003E\n\u003Cli\u003E当进程访问一个虚拟内存的页时，而对应的物理内存却不存在时，会触发一次\u003Cstrong\u003EPage Fault\u003C\u002Fstrong\u003E（\u003Cstrong\u003E缺页中断\u003C\u002Fstrong\u003E），将需要的数据 or 指令从磁盘加载到物理内存页中，建立映射关系，然后再恢复现场，程序本身是无感知的；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-3\"\u003E3、Swap In\u002FOut &#x26; Page In\u002FOut\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E磁盘内部有一个区域叫做\u003Cstrong\u003E交换空间\u003C\u002Fstrong\u003E(Swap Space)，MMU(内存管理单元) 会将\u003Cstrong\u003E暂时不用的内存块内容\u003C\u002Fstrong\u003E写在交互空间上(硬盘)，这就是\u003Cstrong\u003ESwap Out\u003C\u002Fstrong\u003E；当需要时候再从Swap Space中读取到内存中，这就是\u003Cstrong\u003ESwap In\u003C\u002Fstrong\u003E；Swap in和swap out的操作都是比较耗时的, 频繁的Swap in和Swap out操作非常影响系统性能；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003EPage In\u002FOut\u003C\u002Fstrong\u003E和 \u003Cstrong\u003ESwap In\u002FOut\u003C\u002Fstrong\u003E 概念类似，只不过Page In\u002FOut是将\u003Cstrong\u003E某些页\u003C\u002Fstrong\u003E的数据写到内存\u002F从内存写回磁盘交互区；而Swap In\u002FOut是将\u003Cstrong\u003E整个地址空间\u003C\u002Fstrong\u003E的数据写到内存\u002F从内存写回磁盘交互区；本质都是交互机制。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EmacOS支持这类交换机制，但是iOS不支持；主要有两方面考虑吧：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E移动设备的闪存读写次数有限，频繁写会降低寿命；\u003C\u002Fli\u003E\n\u003Cli\u003E相比PC机，移动设备闪存空间有限(15年6s最小存储空间16GB、最大128GB；19年XS Max最小64GB，最大521GB)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-4\"\u003E4、to be continued\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E通用的计算机（\u003Cem\u003E大型机和专用计算机不在此范围\u003C\u002Fem\u003E）的存储器一般设置为多层，从最靠近CPU的Cache一直到磁盘，速度越来越慢，价格也越来越便宜。\u003C\u002Fli\u003E\n\u003Cli\u003E为了充分利用好硬件资源，Cache和Swap机制应运而生，Cache机制是一种用空间换时间的机制；而Swap机制是使用时间换空间的；\u003C\u002Fli\u003E\n\u003Cli\u003E但是，iOS系统舍弃交换机制，取而代之的是\u003Cstrong\u003E压缩内存（Compressed memory）机制\u003C\u002Fstrong\u003E；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 data-id=\"heading-5\"\u003E二、iOS内存管理基础概念\u003C\u002Fh3\u003E\n\u003Ch4 data-id=\"heading-6\"\u003E1、iOS的内存分区\u003C\u002Fh4\u003E\n\u003Cp\u003E从高地址到低地址各区域如下：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E栈区(stack)\u003C\u002Fstrong\u003E： 由编译器⾃动分配，存放函数的参数值，局部变量的值等，作用域执行完毕之后，就会被系统收回；(栈区的地址从高到低分配)\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E堆区(heap)\u003C\u002Fstrong\u003E：一般由程序员分配和释放，用于存放程序运行中被动态分配的内存段；iOS中的Objective-C对象存放在这里，由ARC管理；（堆区的地址是从低到高分配）\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E全局区静态区\u003C\u002Fstrong\u003E：由编译器分配，主要是存放全局变量 和 静态变量，程序结束后由系统释放；主要分两个区：\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EBSS区\u003C\u002Fstrong\u003E：\u003Cstrong\u003E未初始化\u003C\u002Fstrong\u003E的全局变量 和 静态变量；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E数据区\u003C\u002Fstrong\u003E：\u003Cstrong\u003E已初始化\u003C\u002Fstrong\u003E的全局变量 和 静态变量；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E常量区：\u003C\u002Fstrong\u003E 存放的是常量，如常量字符串，程序结束后由系统释放；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E代码区\u003C\u002Fstrong\u003E：存放函数体的二进制代码，程序结束后由系统释放；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cfigure\u003E\u003Cimg alt=\"内存分区示意\" src=\"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fgold-user-assets\u002F2020\u002F4\u002F9\u002F1715e3aff4615a4d~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image\" loading=\"lazy\"\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\n\u003Ch4 data-id=\"heading-7\"\u003E2、内存页类型：Clean和Dirty\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E内存页按照各自的\u003Cstrong\u003E分配和使用\u003C\u002Fstrong\u003E状态，分为 \u003Ccode\u003EClean\u003C\u002Fcode\u003E 和 \u003Ccode\u003EDirty\u003C\u002Fcode\u003E 两类。其中\u003Ccode\u003EClean Page\u003C\u002Fcode\u003E是可以被回收的，\u003Ccode\u003EDirty Page\u003C\u002Fcode\u003E不能；\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode lang=\"c\" class=\"hljs language-c copyable\"\u003E\u003Cspan class=\"hljs-type\"\u003Eint\u003C\u002Fspan\u003E *\u003Cspan class=\"hljs-built_in\"\u003Earray\u003C\u002Fspan\u003E = \u003Cspan class=\"hljs-built_in\"\u003Emalloc\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-number\"\u003E20000\u003C\u002Fspan\u003E * \u003Cspan class=\"hljs-keyword\"\u003Esizeof\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-type\"\u003Eint\u003C\u002Fspan\u003E)); \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F 第1步\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-built_in\"\u003Earray\u003C\u002Fspan\u003E[\u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E] = \u003Cspan class=\"hljs-number\"\u003E32\u003C\u002Fspan\u003E                             \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F 第2步\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-built_in\"\u003Earray\u003C\u002Fspan\u003E[\u003Cspan class=\"hljs-number\"\u003E19999\u003C\u002Fspan\u003E] = \u003Cspan class=\"hljs-number\"\u003E64\u003C\u002Fspan\u003E                         \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F 第3步\u003C\u002Fspan\u003E\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E第一步，申请一块长度为80000 字节的内存空间，按照一页 16KB 来计算，就需要 6 页内存来存储。当这些内存页开辟出来的时候，它们都是 Clean 的；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E第二步，向处于第一页的内存写入数据时，第一页内存会变成 Dirty；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E第三步，当向处于最后一页的内存写入数据时，这一页也会变成 Dirty；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-8\"\u003E3、VM Region\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EiOS进程中所有内存就是由许许多多的\u003Ccode\u003EVM Region\u003C\u002Fcode\u003E组成的；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003EVM Region\u003C\u002Fcode\u003E指\u003Cstrong\u003E一段连续的内存页（在虚拟地址空间里）\u003C\u002Fstrong\u003E，\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fopensource.apple.com%2Fsource%2Fxnu%2Fxnu-792%2Fosfmk%2Fmach%2Fvm_region.h\" title=\"https:\u002F\u002Fopensource.apple.com\u002Fsource\u002Fxnu\u002Fxnu-792\u002Fosfmk\u002Fmach\u002Fvm_region.h\" ref=\"nofollow noopener noreferrer\"\u003EVM Region\u003C\u002Fa\u003E的结构如下\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode lang=\"arduino\" class=\"hljs language-arduino copyable\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Estruct\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title class_\"\u003Evm_region_submap_info_64\u003C\u002Fspan\u003E {\n\t\u003Cspan class=\"hljs-type\"\u003Evm_prot_t\u003C\u002Fspan\u003E\t\tprotection;     \u003Cspan class=\"hljs-comment\"\u003E\u002F* present access protection *\u002F\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"hljs-type\"\u003Evm_prot_t\u003C\u002Fspan\u003E\t\tmax_protection; \u003Cspan class=\"hljs-comment\"\u003E\u002F* max avail through vm_prot *\u002F\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"hljs-type\"\u003Evm_inherit_t\u003C\u002Fspan\u003E\t\tinheritance;\u003Cspan class=\"hljs-comment\"\u003E\u002F* behavior of map\u002Fobj on fork *\u002F\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"hljs-type\"\u003Ememory_object_offset_t\u003C\u002Fspan\u003E\toffset;\t\t\u003Cspan class=\"hljs-comment\"\u003E\u002F* offset into object\u002Fmap *\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-type\"\u003Eunsigned\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-type\"\u003Eint\u003C\u002Fspan\u003E            user_tag;\t\u003Cspan class=\"hljs-comment\"\u003E\u002F* user tag on map entry *\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-type\"\u003Eunsigned\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-type\"\u003Eint\u003C\u002Fspan\u003E            pages_resident;\t\u003Cspan class=\"hljs-comment\"\u003E\u002F* only valid for objects *\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-type\"\u003Eunsigned\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-type\"\u003Eint\u003C\u002Fspan\u003E            pages_shared_now_private; \u003Cspan class=\"hljs-comment\"\u003E\u002F* only for objects *\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-type\"\u003Eunsigned\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-type\"\u003Eint\u003C\u002Fspan\u003E            pages_swapped_out; \u003Cspan class=\"hljs-comment\"\u003E\u002F* only for objects *\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-type\"\u003Eunsigned\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-type\"\u003Eint\u003C\u002Fspan\u003E            pages_dirtied;   \u003Cspan class=\"hljs-comment\"\u003E\u002F* only for objects *\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-type\"\u003Eunsigned\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-type\"\u003Eint\u003C\u002Fspan\u003E            ref_count;\t \u003Cspan class=\"hljs-comment\"\u003E\u002F* obj\u002Fmap mappers, etc *\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-type\"\u003Eunsigned\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-type\"\u003Eshort\u003C\u002Fspan\u003E          shadow_depth; \t\u003Cspan class=\"hljs-comment\"\u003E\u002F* only for obj *\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-type\"\u003Eunsigned\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-type\"\u003Echar\u003C\u002Fspan\u003E           external_pager;  \u003Cspan class=\"hljs-comment\"\u003E\u002F* only for obj *\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-type\"\u003Eunsigned\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-type\"\u003Echar\u003C\u002Fspan\u003E           share_mode;\t\u003Cspan class=\"hljs-comment\"\u003E\u002F* see enumeration *\u002F\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"hljs-type\"\u003Eboolean_t\u003C\u002Fspan\u003E\t\tis_submap;\t\u003Cspan class=\"hljs-comment\"\u003E\u002F* submap vs obj *\u002F\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"hljs-type\"\u003Evm_behavior_t\u003C\u002Fspan\u003E\t\tbehavior;\t\u003Cspan class=\"hljs-comment\"\u003E\u002F* access behavior hint *\u002F\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"hljs-type\"\u003Evm_offset_t\u003C\u002Fspan\u003E\t\tobject_id;\t\u003Cspan class=\"hljs-comment\"\u003E\u002F* obj\u002Fmap name, not a handle *\u002F\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"hljs-type\"\u003Eunsigned\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-type\"\u003Eshort\u003C\u002Fspan\u003E\t\tuser_wired_count; \n};\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EVM Region包含的重要信息有：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003Epages_resident\u003C\u002Fstrong\u003E：在用的物理内存页数\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003Epages_dirtied\u003C\u002Fstrong\u003E：Dirty的内存页数\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003Epages_swapped_out\u003C\u002Fstrong\u003E：Swapped的内存页数（\u003Cstrong\u003E实际指的是被Compressed Memory页数\u003C\u002Fstrong\u003E）\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E可以通过了解\u003Cstrong\u003Epages_dirtied\u003C\u002Fstrong\u003E和\u003Cstrong\u003Epages_swapped_out\u003C\u002Fstrong\u003E来了解\u003Ccode\u003EVM Region\u003C\u002Fcode\u003E的真实物理内存使用。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 data-id=\"heading-9\"\u003E三、iOS内存管理机制\u003C\u002Fh3\u003E\n\u003Ch4 data-id=\"heading-10\"\u003E1、OC的内存管理\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003EObjective-C提供两种方式的内存管理方式：\u003Cstrong\u003EMRC\u003C\u002Fstrong\u003E（手动管理引用计数）和  \u003Cstrong\u003EARC\u003C\u002Fstrong\u003E（自动引用计数）\u003C\u002Fli\u003E\n\u003Cli\u003EObjective-C内存管理的基本原则：谁创建，谁释放，谁引用，谁管理；\u003C\u002Fli\u003E\n\u003Cli\u003EiOS 5之后提出的ARC被广泛接收，毕竟不需要管理引用计数是个很爽的事情；有了ARC，开开心心写OC；但是\u003Cstrong\u003EARC只管理Objective-C对象的内存\u003C\u002Fstrong\u003E，CoreFoundation对象、CoreGraphics对象、还有C\u002FC++的内存分配还是需要开发者自己管理。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cfigure\u003E\u003Cimg alt=\"OC的内存管理图\" src=\"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fgold-user-assets\u002F2020\u002F4\u002F9\u002F1715e39230e29f4a~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image\" loading=\"lazy\"\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\n\u003Ch4 data-id=\"heading-11\"\u003E2、系统内存分类\u003C\u002Fh4\u003E\n\u003Cp\u003E​\t从 iOS7 开始，系统开始采用\u003Ccode\u003ECompressed Memory\u003C\u002Fcode\u003E机制优化内存使用，内存类型可以分为三类：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003EClean Memory\u003C\u002Fcode\u003E：可以被释放或重建的，主要包括：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ECode\u003C\u002Fli\u003E\n\u003Cli\u003Eframework，每个 framework都有 \u003Ccode\u003E_DATA_CONST\u003C\u002Fcode\u003E 段，当 App 在运行时使用到了某个 framework，它所对应的 \u003Ccode\u003E_DATA_CONST\u003C\u002Fcode\u003E 的内存就会由 Clean 变为 Dirty。\u003C\u002Fli\u003E\n\u003Cli\u003Ememory-mapped files（已被加载到内存中的文件）\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E：指那些被写入过数据的内存，主要包括：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E所有堆区中的对象（Heap allocations）\u003C\u002Fli\u003E\n\u003Cli\u003E图像解码缓冲区（Decoded image buffers）\u003C\u002Fli\u003E\n\u003Cli\u003Eframeworks（framework中 \u003Ccode\u003E_DATA\u003C\u002Fcode\u003E 段和 \u003Ccode\u003E_DATA_DIRTY\u003C\u002Fcode\u003E 段）\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre\u003E\u003Ccode lang=\"arduino\" class=\"hljs language-arduino copyable\"\u003E\t在使用 framework 的过程中会产生Dirty Memory，使用单例或者全局初始化方法是减少Dirty Memory；这是因为单例一旦创建就不会销毁，全局初始化方法会在 \u003Cspan class=\"hljs-keyword\"\u003Eclass\u003C\u002Fspan\u003E 加载时执行。\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003ECompressed Memory\u003C\u002Fcode\u003E：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E在内存吃紧时，系统会将不使用的内存进行压缩(Compresses unaccessed pages)\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E在需要的时候，进行解压 （Decompresses pages upon access）\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E优势：减少了不活跃内存占用；减少磁盘IO带来的损耗；压缩\u002F解压十分迅速，能够尽可能减少 CPU 的时间开销；支持多核操作。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E举例\u003C\u002Fstrong\u003E：当我们使用 \u003Ccode\u003ENSDictionary\u003C\u002Fcode\u003E 去缓存数据的时候，假设现在已经使用了 3 页内存，当不访问的时候可能会被压缩为 1 页，再次使用到时候又会解压成 3 页。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E介绍\u003Ccode\u003EClear Memory\u003C\u002Fcode\u003E和 \u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E 的Code如下：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode lang=\"ini\" class=\"hljs language-ini copyable\"\u003E\u002F\u002F堆分配的内存 Dirty Memory\nNSString *\u003Cspan class=\"hljs-attr\"\u003Estr1\u003C\u002Fspan\u003E = [NSString stringWithString:@\u003Cspan class=\"hljs-string\"\u003E\"Welcome!\"\u003C\u002Fspan\u003E]\u003Cspan class=\"hljs-comment\"\u003E; \u003C\u002Fspan\u003E\n\u002F\u002F常量字符串, 存放在一个只读数据段里面,这段内存释放后,还可以在读取重建 Clear Memory\nNSString *\u003Cspan class=\"hljs-attr\"\u003Estr2\u003C\u002Fspan\u003E = @\u003Cspan class=\"hljs-string\"\u003E\"Welcome!\"\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-comment\"\u003E; \u003C\u002Fspan\u003E\n\u002F\u002F分配100M虚拟内存,当没有用时没有建立映射,Clear Memory\nchar *\u003Cspan class=\"hljs-attr\"\u003Ebuf\u003C\u002Fspan\u003E = malloc(\u003Cspan class=\"hljs-number\"\u003E100\u003C\u002Fspan\u003E * \u003Cspan class=\"hljs-number\"\u003E1024\u003C\u002Fspan\u003E *\u003Cspan class=\"hljs-number\"\u003E1024\u003C\u002Fspan\u003E)\u003Cspan class=\"hljs-comment\"\u003E; 关系\u003C\u002Fspan\u003E\nfor (int \u003Cspan class=\"hljs-attr\"\u003Ei\u003C\u002Fspan\u003E = \u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-comment\"\u003E; i &#x3C; 3 * 1024 * 1024; ++i) {\u003C\u002Fspan\u003E\n    \u002F\u002F写入数据了,Dirty Memory\n\t\tbuf\u003Cspan class=\"hljs-section\"\u003E[i]\u003C\u002Fspan\u003E = rand()\u003Cspan class=\"hljs-comment\"\u003E;\t\t\t\t\t\t\t\t\t\u003C\u002Fspan\u003E\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E说明\u003C\u002Fstrong\u003E：在内存吃紧的情况下，释放\u003Ccode\u003EClean Memory\u003C\u002Fcode\u003E，不能释放\u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E ，所以\u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E 的内存越多，App的稳定性越差。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-12\"\u003E3、\u003Ccode\u003EJetsam\u003C\u002Fcode\u003E机制\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EJetsam机制是操作系统为了控制内存资源过度使用而采用的一种管理机制；Jetsam是一个独立运行的进程，会把一些\u003Cstrong\u003E优先级不高或者占用内存过大的\u003C\u002Fstrong\u003EApp杀掉；在杀掉App后会记录一些数据信息并保存到日志。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EApp优先级可以这么简单理解：前台App \u003E 后台App; 占用内存少 \u003E 占用内存多；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EJetsam产生的这些日志可以在\u003Cstrong\u003E手机设置-\u003E隐私-\u003E分析\u003C\u002Fstrong\u003E中找到，日志是以\u003Ccode\u003EJetsamEvent\u003C\u002Fcode\u003E开头，日志中有内存页大小(pageSize)，CPU时间(cpuTime)等字段。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E查看\u003Ccode\u003E设置-\u003E隐私-\u003E分析\u003C\u002Fcode\u003E中以JetsamEvent开头的系统日志，关注两个重要的信息；\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode lang=\"json\" class=\"hljs language-json copyable\"\u003E\u003Cspan class=\"hljs-attr\"\u003E\"pageSize\"\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-number\"\u003E16384\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-punctuation\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F内存页达到上限\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-attr\"\u003E\"rpages\"\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-number\"\u003E948\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-punctuation\"\u003E,\u003C\u002Fspan\u003E      \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002FApp 占用的内存页数量\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-attr\"\u003E\"reason\"\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E\"per-process-limit\"\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-punctuation\"\u003E,\u003C\u002Fspan\u003E  \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002FApp 占用的内存超过了系统对单个 App 的内存限制。\u003C\u002Fspan\u003E\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E说明\u003C\u002Fstrong\u003E：该内存“上限”计算：pageSize \u003Cem\u003Erpages = 16384\u003C\u002Fem\u003E 948 \u002F1024\u002F1014 = 14.8MB，这个App应该是因优先级不高而被强杀，毕竟App内存使用上限不可能不到15MB。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-13\"\u003E4、内存警告\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E内存警告（Memory Warning）三种通知方式:\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EUIApplicationDelegate\u003C\u002Fstrong\u003E的\u003Ccode\u003EapplicationDidReceiveMemoryWarning:\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E视图控制器\u003Cstrong\u003EUIViewController\u003C\u002Fstrong\u003E的\u003Ccode\u003EdidReceiveMemoryWarning\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EUIApplicationDidReceiveMemoryWarningNotification\u003C\u002Fstrong\u003E通知\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E出现OOM前不一定出现内存警告；有可能是瞬间申请了大量内存，而恰好此时主线程在忙于其他事情，导致可能没有经历过Memory Warning就发生了OOM；也可能即便出现了多次Memory Warning后，也不见得会在最后一次Memory Warning的几秒钟后出现OOM(可能是1-2分钟后)；\u003C\u002Fli\u003E\n\u003Cli\u003E并非所有内存警告都是由 App 造成的，例如在内存较小的设备上，当你接听电话的时候也有可能发生内存警告。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 data-id=\"heading-14\"\u003E四、常见的内存类问题\u003C\u002Fh3\u003E\n\u003Ch4 data-id=\"heading-15\"\u003E1、FOOM\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EFOOM（Foreground Out Of Memory），是指App\u003Cstrong\u003E在前台\u003C\u002Fstrong\u003E因消耗内存过多引起系统强杀。对用户而言，表现跟Crash一样。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EFacebook早在2015年8月提出FOOM检测办法，大致原理是排除各种情况后，剩余的情况是FOOM；Facebook如何判定上一次启动是否出现FOOM方法：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E1.App没有升级\u003C\u002Fli\u003E\n\u003Cli\u003E2.App没有调用exit()或abort()退出\u003C\u002Fli\u003E\n\u003Cli\u003E3.App没有出现Crash (依赖于自身CrashReport组件的Crash回调)\u003C\u002Fli\u003E\n\u003Cli\u003E4.用户没有强退App\u003C\u002Fli\u003E\n\u003Cli\u003E5.系统没有升级\u002F重启\u003C\u002Fli\u003E\n\u003Cli\u003E6.App当时没有后台运行（依赖于ApplicationState和前后台切换通知）\u003C\u002Fli\u003E\n\u003Cli\u003E7.App出现FOOM （依赖于ApplicationState和前后台切换通知）\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E排查法有误报的可能，因为有些被系统强杀case，但是我们捕获不到信息，也可能被归类到OOM；已知被系统强杀的case是：OOM和watchdog(Code 0x8badf00d)。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E发现FOOM问题的关键：监控App使用内存增长，在收到内存警告通知时，dump 内存信息，获取对象名称、对象个数、各对象的内存值，并在合适的时机上报到服务器；加强对大内存的分配监控。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-16\"\u003E2、内存泄露\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E内存泄露(Memory Leak)：指申请的内存空间使用完毕之后\u003Cstrong\u003E未回收\u003C\u002Fstrong\u003E，内存泄露问题多的话，对App质量影响很大；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E目前引起内存泄露的主要原因是循环引用(堆内存中对象相互引用，彼此都得不到释放的机会)，目前，调试阶段使用Instrument的Leaks工具发现，线上利用MLeaksFinder发现后上报；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E如何避免内存泄露在后面有介绍\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-17\"\u003E3、WKWebview白屏\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EWKWebview白屏问题，严格来说，是一种内存方面的问题；之前的UIWebview因为内存使用过大会Crash，而WKWebview不会Crash，会白屏；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EWKWebView是一个多进程组件，\u003Ccode\u003ENetwork Loading\u003C\u002Fcode\u003E以及\u003Ccode\u003EUI Rendering\u003C\u002Fcode\u003E在其它进程中执行，当WKWebView总体的内存占用比较大时，\u003Ccode\u003EWebContent Process\u003C\u002Fcode\u003E会Crash，从而出现白屏现象。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E解决办法\u003C\u002Fstrong\u003E：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003EKVO监听URL, 当URL为nil，重新reload\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E在进程被终止回调中，重新reload\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode lang=\"javascript\" class=\"hljs language-javascript copyable\"\u003E\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F 此方法适用iOS9.0以上 \u003C\u002Fspan\u003E\n- (\u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E)\u003Cspan class=\"hljs-attr\"\u003EwebViewWebContentProcessDidTerminate\u003C\u002Fspan\u003E:(\u003Cspan class=\"hljs-title class_\"\u003EWKWebView\u003C\u002Fspan\u003E *)webView \u003Cspan class=\"hljs-title function_\"\u003ENS_AVAILABLE\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003E\u003Cspan class=\"hljs-number\"\u003E10_11\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E9_0\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E){\n\t\t\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002Freload\u003C\u002Fspan\u003E\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-18\"\u003E4、野指针问题\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E野指针\u003C\u002Fstrong\u003E：指向一个已删除的对象 或 受限内存区域的指针；目前此类问题很少了，主要来自两个方面\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EMRC时代 到 ARC时代，OC对象管理极大方便了，ARC解决大部分野指针问题\u003C\u002Fli\u003E\n\u003Cli\u003EiOS 9开始，系统库中部分遗留的被\u003Ccode\u003Eassign(unsafe_unretain)\u003C\u002Fcode\u003E修饰的 \u003Ccode\u003Edelegate\u003C\u002Fcode\u003E和\u003Ccode\u003Etarget-action\u003C\u002Fcode\u003E修改成了weak，内存被回收的时候，这些指针设为nil，这也大幅度减少了野指针的出现。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E目前绝大部分App都是iOS 9起步，野指针少了很多，但是工程中依然会有野指针问题，本质还是内存使用不当；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003EMach Exception\u003C\u002Fcode\u003E大多数都是野指针的问题，崩溃日志里最多见\u003Ccode\u003Eobjc_msgSend\u003C\u002Fcode\u003E和\u003Ccode\u003Eunrecognized selector sent to\u003C\u002Fcode\u003E等等。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E对于野指针问题，最好能复现，使用\u003Ccode\u003EZombie Object\u003C\u002Fcode\u003E 帮助调试，\u003Ccode\u003EZombie Object\u003C\u002Fcode\u003E 实现原理就是 hook 住了对象的\u003Ccode\u003Edealloc\u003C\u002Fcode\u003E方法，通过调用自己的\u003Ccode\u003E__dealloc_zombie\u003C\u002Fcode\u003E方法来把对象进行僵尸化，当这个对象再次收到消息,\u003Ccode\u003Eobjc_msgsend\u003C\u002Fcode\u003E的时候，调用abort()崩溃并打印出调用的方法。。\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E\u003Cstrong\u003EiOS 9以后NSNotificationCenter不需要手动移除观察者\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E在iOS9之前，通知中心使用 \u003Cstrong\u003Eunsafe_unretained\u003C\u002Fstrong\u003E修饰引用观察者，如果观察者被回收时，若不手动移除，指针会指向被回收的内存区域，变为野指针，如果再发送消息会造成Crash；\u003C\u002Fli\u003E\n\u003Cli\u003E而iOS 9之后，通知中心使用\u003Cstrong\u003Eweak\u003C\u002Fstrong\u003E修饰引用观察者 ，即使不手动移除观察者，weak指针也会在观察者被回收后自动置nil。之后发送消息，是不会有问题的。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch4 data-id=\"heading-19\"\u003E5、iOS 10 nano_free Crash\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E在iOS 10.0 - 10.1，苹果bug引入nano_free Crash问题，这些Crash发生\u003Ccode\u003Elibsystem_malloc.dylib\u003C\u002Fcode\u003E中的 \u003Ccode\u003Enano zone\u003C\u002Fcode\u003E内的；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ccode\u003Elibsystem_malloc.dylib\u003C\u002Fcode\u003E中，对内存的管理有两个实现：\u003Ccode\u003Enano zone\u003C\u002Fcode\u003E和\u003Ccode\u003Escalable zone\u003C\u002Fcode\u003E。他们分别管理不同大小的内存块：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E内存分配函数malloc和calloc等默认使用的是nano_zone，nao_zone是 256B 以下小内存的分配，\u003C\u002Fli\u003E\n\u003Cli\u003E大于 256B 的时候会使用 \u003Cstrong\u003Escalable_zone\u003C\u002Fstrong\u003E 来分配。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E当时微信团队提出的几种解决思路，最后给的解决方案是\u003Cstrong\u003E不使用nano zone\u003C\u002Fstrong\u003E，具体描述\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E创建一个自己的zone，命名为\u003Ccode\u003Eguard zone\u003C\u002Fcode\u003E。\u003C\u002Fli\u003E\n\u003Cli\u003E修改nano zone的函数指针，重定向到guard zone(通过\u003Ccode\u003Emalloc_zone_create\u003C\u002Fcode\u003E创建的)。\n\u003Cul\u003E\n\u003Cli\u003E对于没有传入指针的函数，直接重定向到guard zone\u003C\u002Fli\u003E\n\u003Cli\u003E对于有传入指针的函数，先用size判断所属的zone，再进行分发。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E更多见：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fcloud.tencent.com%2Fdeveloper%2Farticle%2F1031006\" title=\"https:\u002F\u002Fcloud.tencent.com\u002Fdeveloper\u002Farticle\u002F1031006\" ref=\"nofollow noopener noreferrer\"\u003E聊聊苹果的Bug - iOS 10 nano_free Crash\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fopensource.apple.com%2Ftarballs%2Flibmalloc%2F\" title=\"https:\u002F\u002Fopensource.apple.com\u002Ftarballs\u002Flibmalloc\u002F\" ref=\"nofollow noopener noreferrer\"\u003Elibsystem_malloc.dylib 源码\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-20\"\u003E6、to be continued\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E内存类问题排查难度大，复杂。需要对内存有更深入的理解\u003C\u002Fli\u003E\n\u003Cli\u003E为了避免内存问题：根本上是优化内存使用，主要表现在：减少大块内存使用，降低内存峰值，避免内存泄露，处理内存警告;\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 data-id=\"heading-21\"\u003E五、优化内存使用\u003C\u002Fh3\u003E\n\u003Ch4 data-id=\"heading-22\"\u003E1、降低图片解码和渲染开销\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E将图片渲染显示在屏幕上，需要先将其解码成位图；而位图大小：\u003Cstrong\u003E像素高 * 像素宽 * 4字节\u003C\u002Fstrong\u003E(\u003Cem\u003E4字节对应一个像素点，4个通道的大小\u003C\u002Fem\u003E)；图片解码会造成内存使用上升，尤其是高分辨率图解码可能导致内存暴涨；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003E代码优化建议\u003C\u002Fstrong\u003E：\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E善待\"大\"图（位图大小大于60MB）解码：将原图裁剪成多个小图，然后依次绘制到目标位图context中，具体可见SDWebImage中和关于**decodedAndScaledDownImageWithImage:**的实现；\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E限制并发解码图片的个数；\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E图片大小调整和显示大小一样，以此避免重采样(重采样也很消耗资源，放大图像称为上采样\u002F插值（upsamping），缩小图像为小采样（downsampling));\u003C\u002Fli\u003E\n\u003Cli\u003E使用 ImageIO直接读取图像大小和元数据信息，减少内存开销。\u003C\u002Fli\u003E\n\u003Cli\u003EiOS10后使用 \u003Ccode\u003EUIGraphicsImageRenderer\u003C\u002Fcode\u003E 创建 image 上下文，而不是\u003Ccode\u003EUIGraphicsBeginImageContextWithOptions\u003C\u002Fcode\u003E，因为前者的性能更好、更高效，并且支持广色域；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-23\"\u003E2、其他降低内存峰值办法\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E合理使用\u003Ccode\u003Eautorealsepool\u003C\u002Fcode\u003E，降低内存峰值，避免 OOM\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E基于引用计数,Pool执行drain方法会release所有该Pool中的autorelease对象\u003C\u002Fli\u003E\n\u003Cli\u003E可以嵌套多个AutoReleasePool\u003C\u002Fli\u003E\n\u003Cli\u003E每个线程并没有设置默认的AutoReleasePool,需要手动创建,避免内存泄露\u003C\u002Fli\u003E\n\u003Cli\u003E在一段内存分配频繁的代码中嵌套AutoReleasePool有利于降低整体内存峰值\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E复用大内存对象，如UITableViewCell对象；懒加载大的内存对象\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003EimageNamed 和 imageWithContentOfFile 的选择\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EimageNamed使用系统缓存，适用于频繁使用的小图片\u003C\u002Fli\u003E\n\u003Cli\u003EimageWithContentOfFile不带缓存机制,适用于大图片,使用完就释放\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E建议NSData读取文件方式\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E建议使用\u003Ccode\u003E[NSData dataWithContentsOfFile:path options:NSDataReadingMappedIfSafe error:&#x26;error]\u003C\u002Fcode\u003E;\u003C\u002Fli\u003E\n\u003Cli\u003E该API映射文件到虚拟内存, 只有读取操作的时候才会读取相应页的内容到物理内存页中；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E用 \u003Ccode\u003ENSCache\u003C\u002Fcode\u003E 代替 \u003Ccode\u003ENSMutableDictionary\u003C\u002Fcode\u003E， 因为 \u003Ccode\u003ENSCache\u003C\u002Fcode\u003E 可以自动清理内存，在内存吃紧的时候会更加合理。\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ENSCache有2种界限条件:totalCostLimt &#x26; countLimit，超过这两种界限后系统会去释放一些旧的资源.\u003C\u002Fli\u003E\n\u003Cli\u003E监听到内存警告消息后移除所有Cache\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E使用 NSPurgableData 代替NSData，主要原因如下：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E当系统处于低内存的时候会自动移除\u003C\u002Fli\u003E\n\u003Cli\u003E适用于大数据\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E栈内存分配\u003C\u002Fstrong\u003E：\u003Ccode\u003Ealloca(size_t)\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E栈分配仅仅修改栈指针寄存器，比malloc遍历并修改空闲列表要快得多\u003C\u002Fli\u003E\n\u003Cli\u003E栈内存一般都已经在物理内存中，不用担心页错误\u003C\u002Fli\u003E\n\u003Cli\u003E函数返回的时候栈分配的空间都会自动释放\u003C\u002Fli\u003E\n\u003Cli\u003E但仅适合小空间的分配,并且函数嵌套不宜过深\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Cstrong\u003E堆内存分配\u003C\u002Fstrong\u003E：\u003Cstrong\u003Ecalloc\u003C\u002Fstrong\u003E \u003Cstrong\u003EVS\u003C\u002Fstrong\u003E \u003Cstrong\u003Emalloc + memset\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Ecalloc(size_t num,size_t size)\u003C\u002Fcode\u003E分配内存时是虚拟内存，只有在访问的时候才会发生物理页的映射关系；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Emalloc + memset\u003C\u002Fcode\u003E 会产生\u003Ccode\u003EDirty Memory\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Ecalloc\u003C\u002Fcode\u003E函数得到的内存空间是经过初始化的，其内容全为0，而\u003Ccode\u003Emalloc\u003C\u002Fcode\u003E函数得到的内存空间是未初始化的，必须使用memset函数来初始化；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-24\"\u003E3、避免循环引用，减少内存泄露\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E代码优化建议\u003C\u002Fstrong\u003E\n\u003Cul\u003E\n\u003Cli\u003E申明代理(delegate)为weak；\u003C\u002Fli\u003E\n\u003Cli\u003E使用 \u003Ccode\u003Eweak strong dance\u003C\u002Fcode\u003E 来解决 block 中的循环引用问题；\u003C\u002Fli\u003E\n\u003Cli\u003E实现NSProxy(虚拟类)的子类，然后在子类中定义weak修饰的target，然后实现消息转发方法，使target处理业务逻辑；一般用于解决NSTimer、CADisplayLink的循环引用；\u003C\u002Fli\u003E\n\u003Cli\u003ECoreFoundation对象、CoreGraphics对象、还有C\u002FC++的内存分配需要管理好，有malloc就要有free\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E善用工具：\u003Cstrong\u003EMLeaksFinder + Instrument\u003C\u002Fstrong\u003E 或 \u003Cstrong\u003EFBMemoryProfiler + Instrument\u003C\u002Fstrong\u003E组合使用。通过MLeaksFinder\u002FFBMemoryProfiler发现后。然后使用Instrument再验证；\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 data-id=\"heading-25\"\u003E4、处理内存警告\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003EMemory Warning时，尽可能释放多资源，尤其图片等占内存多的资源，等需要用的时候再重建；\u003C\u002Fli\u003E\n\u003Cli\u003EMemory Warning时，部分单例对象可考虑释放掉；\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EMemory Warning时，不建议self.view = nil\u003C\u002Fstrong\u003E：iOS 6之后，系统发出 Memory Warning 时，\u003Cstrong\u003E系统会自动回收CALayer的CABackingStore对象(bitmap 内容)\u003C\u002Fstrong\u003E；虽然没有回收 UIView 和 CALayer 类，但是也回收了大部分内存，在需要 bitmap 类时，通过调用 UIView 的 drawRect: 方法重建。\u003C\u002Fli\u003E\n\u003Cli\u003E最佳的实践还是\u003Cstrong\u003E减少大块内存使用，降低内存峰值，避免内存泄露\u003C\u002Fstrong\u003E。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 data-id=\"heading-26\"\u003E历史文章\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Cstrong\u003E之前对内存问题一些整理\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=http%3A%2F%2Fnanhuacoder.top%2F2018%2F01%2F30%2FiOS-iOSMemory\" title=\"http:\u002F\u002Fnanhuacoder.top\u002F2018\u002F01\u002F30\u002FiOS-iOSMemory\" ref=\"nofollow noopener noreferrer\"\u003EOC对象内存小记\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=http%3A%2F%2Fnanhuacoder.top%2F2019%2F04%2F17%2FiOS-OOM%2F\" title=\"http:\u002F\u002Fnanhuacoder.top\u002F2019\u002F04\u002F17\u002FiOS-OOM\u002F\" ref=\"nofollow noopener noreferrer\"\u003EOOM问题小记\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003Cstrong\u003E之前对图片解码和图片优化一些总结\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2F728f71b9fe28\" title=\"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002F728f71b9fe28\" ref=\"nofollow noopener noreferrer\"\u003E篇1：SDWebImage源码看图片解码\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2Fa38a7c7bccbb\" title=\"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002Fa38a7c7bccbb\" ref=\"nofollow noopener noreferrer\"\u003EiOS实录17：网络图片的优化显示\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=http%3A%2F%2Fnanhuacoder.top%2F2019%2F03%2F13%2FiOS-PicDecode\" title=\"http:\u002F\u002Fnanhuacoder.top\u002F2019\u002F03\u002F13\u002FiOS-PicDecode\" ref=\"nofollow noopener noreferrer\"\u003E图片解码小记\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 data-id=\"heading-27\"\u003E参考文章\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2FTuGeLe%2Farticle%2Fdetails%2F104004692\" title=\"https:\u002F\u002Fblog.csdn.net\u002FTuGeLe\u002Farticle\u002Fdetails\u002F104004692\" ref=\"nofollow noopener noreferrer\"\u003E深入了解iOS中的OOM(低内存崩溃)\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fjuejin.cn\u002Fpost\u002F6844903621276991502#heading-3\" title=\"https:\u002F\u002Fjuejin.cn\u002Fpost\u002F6844903621276991502#heading-3\"\u003EWWDC 2018：iOS 内存深入研究\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fyq.aliyun.com%2Farticles%2F55820\" title=\"https:\u002F\u002Fyq.aliyun.com\u002Farticles\u002F55820\" ref=\"nofollow noopener noreferrer\"\u003Epage fault带来的性能问题\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fwetest.qq.com%2Flab%2Fview%2F367.html\" title=\"https:\u002F\u002Fwetest.qq.com\u002Flab\u002Fview\u002F367.html\" ref=\"nofollow noopener noreferrer\"\u003EiOS微信内存监控\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Fjuejin.cn\u002Fpost\u002F6844903747538141191\" title=\"https:\u002F\u002Fjuejin.cn\u002Fpost\u002F6844903747538141191\"\u003EiOS野指针定位总结\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2F8e764d05275b\" title=\"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002F8e764d05275b\" ref=\"nofollow noopener noreferrer\"\u003EiOS中的内存管理\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F49829766\" title=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F49829766\" ref=\"nofollow noopener noreferrer\"\u003EiOS 内存管理研究\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2Ff9b8c139c2ed\" title=\"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002Ff9b8c139c2ed\" ref=\"nofollow noopener noreferrer\"\u003ELinux对内存的管理, 以及page fault的概念\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fyq.aliyun.com%2Farticles%2F3065\" title=\"https:\u002F\u002Fyq.aliyun.com\u002Farticles\u002F3065\" ref=\"nofollow noopener noreferrer\"\u003EiOS内存管理和malloc源码解读\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fturingh.github.io%2F2016%2F06%2F28%2Flibmalloc%25E6%25BA%2590%25E7%25A0%2581%25E5%2588%2586%25E6%259E%2590%25E4%25B9%258B%25E5%2588%259D%25E5%25A7%258B%25E5%258C%2596%2F\" title=\"https:\u002F\u002Fturingh.github.io\u002F2016\u002F06\u002F28\u002Flibmalloc%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%88%9D%E5%A7%8B%E5%8C%96\u002F\" ref=\"nofollow noopener noreferrer\"\u003Elibmalloc源码分析之初始化\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n",hitArticleCache:b,showSidebar:a,actionType:{FETCH:"view\u002Fcolumn\u002FFETCH",FETCH_ADDITIONAL:"view\u002Fcolumn\u002FFETCH_ADDITIONAL",FETCH_SIDEBAR_ADENTRY:"view\u002Fcolumn\u002FFETCH_SIDEBAR_ADENTRY",FETCH_AUTHOR_EXTRA:"view\u002Fcolumn\u002FFETCH_AUTHOR_EXTRA",RESET:"view\u002Fcolumn\u002FRESET"},recommendedArticleList:{list:[],cursor:f,loading:a,skeleton:a,hasMore:a,articleId:e,actionType:{UPDATE_STATE:"view\u002Fcolumn\u002Frecommend-List\u002FUPDATE_STATE",FETCH_MORE:"view\u002Fcolumn\u002Frecommend-List\u002FFETCH_MORE",FETCH:"view\u002Fcolumn\u002Frecommend-List\u002FFETCH",RESET:"view\u002Fcolumn\u002Frecommend-List\u002FRESET"}}},collection:{collection:{author:{}},actionType:{FETCH:"@\u002Fview\u002Fcollection\u002FFETCH",REFRESH:"@\u002Fview\u002Fcollection\u002FREFRESH",RESET:"@\u002Fview\u002Fcollection\u002FRESET"},list:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fcollection\u002Flist\u002FUPDATE",FETCH:"@\u002Fview\u002Fcollection\u002Flist\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fcollection\u002Flist\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fcollection\u002Flist\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fcollection\u002Flist\u002FRESET"},id:e,sort:n}},gettingStarted:{category:{},actionType:{UPDATE_STATE:"@\u002Fview\u002FgettingStarted\u002FUPDATE_STATE",FOLLOW:"@\u002Fview\u002FgettingStarted\u002FFOLLOW",RESET:"@\u002Fview\u002FgettingStarted\u002FRESET",UPDATE_CATEGORY:"@\u002Fview\u002FgettingStarted\u002FUPDATE_CATEGORY"}},pin:{pin:{user:{},imageUrlList:[]},pinList:[],actionType:{FETCH:"@\u002Fview\u002Fpin\u002FFETCH",RESET:"@\u002Fview\u002Fpin\u002FRESET"},sidebar:{list:[],after:e,loading:a,isRecommend:a,hasNextPage:b,actionType:{UPDATE_STATE:"@\u002Fview\u002Fpin\u002Fsidebar\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fpin\u002Fsidebar\u002FFETCH_MORE",FETCH:"@\u002Fview\u002Fpin\u002Fsidebar\u002FFETCH",RESET:"@\u002Fview\u002Fpin\u002Fsidebar\u002FRESET"}},commentList:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fpin\u002FcommentList\u002FUPDATE",FETCH:"@\u002Fview\u002Fpin\u002FcommentList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fpin\u002FcommentList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fpin\u002FcommentList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fpin\u002FcommentList\u002FRESET"},pinId:c},subCommentList:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FUPDATE",FETCH:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FRESET"},commentId:c}},topic:{topic:e,followedTopicList:[],actionType:{FETCH:"@\u002Fview\u002Ftopic\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Ftopic\u002FUPDATE_STATE",RESET:"@\u002Fview\u002Ftopic\u002FRESET"},allTopicList:{pageSize:x,page:d,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FUPDATE",FETCH:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FRESET"},sortType:m},pinlist:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Ftopic\u002FpinList\u002FUPDATE",FETCH:"@\u002Fview\u002Ftopic\u002FpinList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Ftopic\u002FpinList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Ftopic\u002FpinList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Ftopic\u002FpinList\u002FRESET"},sortType:p},sidebar:{actionType:{RESET:"@\u002Fview\u002Ftopic\u002Fsidebar\u002FRESET",UPDATE_STATE:"@\u002Fview\u002Ftopic\u002Fsidebar\u002FUPDATE_STATE"},attender:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FUPDATE",FETCH:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FFETCH_MORE",RESET:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FRESET"},topicId:c}},followedList:{pageSize:x,page:d,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FUPDATE",FETCH:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FRESET"},after:d}},recommendationIndex:{actionType:{FETCH_USER:"@\u002Fview\u002Frecommendation\u002FFETCH_USER",FETCH_MORE:"@\u002Fview\u002Frecommendation\u002FFETCH_MORE",RESET:"@\u002Fview\u002Frecommendation\u002FRESET",FETCH:"@\u002Fview\u002Frecommendation\u002FFETCH"},cursor:e,hasMore:e,userList:[],loading:a,skeleton:b,category:k,categoryNavList:[],serverRenderUserList:a},event:{event:{},loading:a,user:{},actionType:{FETCH:"view\u002Fevent\u002FFETCH",RESET:"view\u002Fevent\u002FRESET"}},academyIndex:{academy:{},bannerList:[],qualitiedList:[],latestList:[],offlineList:[],loading:a,user:{},actionType:{FETCH:"view\u002Facademy\u002FFETCH",RESET:"view\u002Facademy\u002FRESET"}},coursesIndex:{loading:a,list:[],sort:"online",actionType:{FETCH:"view\u002Fcourses\u002FFETCH",RESET:"view\u002Fcourses\u002FRESET",FETCH_MORE:"view\u002Fcourses\u002FFETCH_MORE"}},team:{team:{},loading:b,actionType:{FETCH:"@\u002Fview\u002Fteam\u002FFETCH",RESET:"@\u002Fview\u002Fteam\u002FRESET",UPDATE:"@\u002Fview\u002Fteam\u002FUPDATE",FOLLOW:"@\u002Fview\u002Fteam\u002FFOLLOW"},detailList:{actionType:{RESET:"@\u002Fview\u002Fteam\u002FdetailList\u002FRESET"},posts:{list:[],hasMore:a,skeleton:a,loading:a,sort:n,actionType:{FETCH:"@\u002Fview\u002Fteam\u002FdetailList\u002Fposts\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fteam\u002FdetailList\u002Fposts\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fteam\u002FdetailList\u002Fposts\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fteam\u002FdetailList\u002Fposts\u002FRESET"}},pins:{list:[],hasMore:a,loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fteam\u002FdetailList\u002Fpins\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fteam\u002FdetailList\u002Fpins\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fteam\u002FdetailList\u002Fpins\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fteam\u002FdetailList\u002Fpins\u002FRESET"}},hire:{list:[],hasMore:a,cursor:f,loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fteam\u002FdetailList\u002Fhire\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fteam\u002FdetailList\u002Fhire\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fteam\u002FdetailList\u002Fhire\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fteam\u002FdetailList\u002Fhire\u002FRESET"}}}},couponList:{list:{"0":q,"1":q,"2":q}},payment:{selectedDiscount:{},bookletDetail:{},coupons:{availables:[],unavailables:[]},discountList:[]},activityVip:{selectedVipSku:{}}},component:{indexAside:{bannerList:[],userList:[],actionType:{FETCH_BANNER:"@\u002Fcomponent\u002Faside\u002FFETCH_BANNER",FETCH_USER:"@\u002Fcomponent\u002Faside\u002FFETCH_USER",CLOSE_BANNER:"@\u002Fcomponent\u002Faside\u002FCLOSE_BANNER"}}},ore:{oreCount:d},avatarMenuInfo:{},common:{theme:"light"},env:{ua:"Mozilla\u002F5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F110.0.0.0 Safari\u002F537.36",serverEnv:"production"},auth:{user:{id:"2894327269039357",self_description:void 0,followed:a,viewerIsFollowing:void 0,community:void 0,subscribedTagCount:12,wroteBookCount:d,boughtBookCount:d,isBindedPhone:g,level:d,user_id:"2894327269039357",user_name:"Leon0206",company:"网易云音乐",job_title:"iOS开发工程师",avatar_large:"https:\u002F\u002Fp6-passport.byteacctimg.com\u002Fimg\u002Fmosaic-legacy\u002F3795\u002F3044413937~300x300.image",power:d,phone:"17*****0590",email:e,allow_notification:a,rank_index:d,wallet_total_bill:d,description:e,blog_address:e,is_black:a,editor_type:e,register_time:1627475051,update_time:-62135596800,administrator:d,builder:d,favorable_author:d,book_author:d,phone_verified:g,wechat_verified:d,weibo_verified:d,github_verified:d,followee_count:4,follower_count:d,post_article_count:d,digg_article_count:g,view_article_count:91,subscribe_tag_count:12,got_digg_count:d,got_view_count:d,comment_count:d,collect_set_count:g,booklet_count:d,buy_booklet_count:d,post_shortmsg_count:d,comment_shortmsg_count:d,digg_shortmsg_count:d,ltime:d,isfollowed:a,forbidden_words:d,create_collect_set_count:g,follow_collect_set_count:d,weibo_nickname:e,wechat_nickname:e,github_nickname:e,apply_logout:d,is_logout:d,weibo_id:e,is_new:a,study_point:d,university:{university_id:f,name:e,logo:e},major:{major_id:f,parent_id:f,name:e},student_status:d,select_event_count:d,select_online_course_count:d,identity:d,graduated_at:-62135596800,blog_move_priority:a,tech_team:{org_id:f,org_name:e,org_icon:e,role:d},job_count:d,is_select_annual:a,select_annual_rank:d,annual_list_type:d,digg_news_count:d,news_privilege:d,digg_toutiao_count:d,follow_column_cnt:g,can_tag_cnt:g,need_lead:d,follow_topic_count:d,badges:{wear_badges:c,obtain_badges:c,obtain_count:d,show_badge:a,link_url:e},is_collect_fast:a,user_growth_info:{user_id:2894327269039357,jpower:d,jscore:36,jpower_level:d,jscore_level:3,jscore_title:"新星掘友",author_achievement_list:[],vip_level:d,vip_title:e,jscore_next_level_score:150,jscore_this_level_mini_score:30},is_vip:a,collection_set_article_count:d,juejinPower:d,jobTitle:"iOS开发工程师",roles:{isBookAuthor:a,isFavorableAuthor:a,isCobuilder:a,isAdmin:a},username:"Leon0206",blogAddress:e,selfDescription:e,beLikedCount:d,beReadCount:d,followerCount:d,followingCount:4,collectionCount:g,createdCollectionCount:g,followingCollectionCount:d,postedPostsCount:d,pinCount:d,likedArticleCount:g,likedPinCount:d,avatar:"https:\u002F\u002Fp6-passport.byteacctimg.com\u002Fimg\u002Fmosaic-legacy\u002F3795\u002F3044413937~300x300.image",latestLoginedInAt:c,createdAt:new Date(1627475051000),updatedAt:c,phoneNumber:"17*****0590",titleDescription:e,followeesCount:4,applyEventCount:d,followTopicCnt:d},clientId:e,token:e,qrCode:c,qrCodeStatus:c,qrCodeToken:c},tag:{subscribedTagList:[]},entry:{isLikeLoading:a},collection:{},comment:{},bookComment:{},repoComment:{},category:{list:[]},user:{subscribedTagList:[]},notification:{unreadCount:{user:d,system:d,total:d}},follow:{subscribedTagList:[]},error:{location:c,errorView:c,statusCode:200,needRiskModal:a,riskAppealUrl:e},abTest:{info:{}},suspensionPanel:{needSuspension:b},pinComment:{},pin:{deleteDialogVisible:a,reportDialogVisible:a,targetPin:c,isOnFocus:a},topic:{visible:a},activity:{"2020":{},offer:{is_show:d,start_time:d},voteData:{err_no:d,err_msg:"success",data:{face:{title:e,activity_id:"5",start_time:y,end_time:1675699200,status:l,image:"https:\u002F\u002Fp6-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002Fd9c6d6b34c8045e993f2f607a660dd43~tplv-k3u1fbpfcp-zoom-1.image",close_image:"https:\u002F\u002Fp3-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002F882fc263e36347ffbf6d598de520870e~tplv-k3u1fbpfcp-image.image",url:"https:\u002F\u002Fjuejin.cn\u002Fpin\u002F7195849498253770808?utm_source=popup&utm_medium=jjapp&utm_campaign=xcyxj",is_show:d},top:{title:r,activity_id:j,start_time:s,end_time:t,status:g,image:"https:\u002F\u002Fp3-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002F9563d620af3b48a791f77019c948f064~tplv-k3u1fbpfcp-zoom-1.image",close_image:"https:\u002F\u002Fp3-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002Ff49fe994db7b4af7846259d97610bec0~tplv-k3u1fbpfcp-zoom-1.image",url:"https:\u002F\u002Fjuejin.cn\u002Fvip?utm_source=app_top",is_show:g},web_top:{title:r,activity_id:j,start_time:s,end_time:t,status:g,image:z,close_image:"https:\u002F\u002Fp3-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002F19e7f58eecbd497c92397344e1d489a6~tplv-k3u1fbpfcp-zoom-1.image",url:"https:\u002F\u002Fjuejin.cn\u002Fvip?utm_source=web_nav",is_show:g},plugin_top:{title:r,activity_id:j,start_time:s,end_time:t,status:g,image:z,close_image:u,url:"https:\u002F\u002Fjuejin.cn\u002Fvip?utm_source=gold_browser_extension",is_show:g},search_top:{title:A,activity_id:j,start_time:B,end_time:1675612799,status:l,image:C,close_image:D,url:E,is_show:d},web_search:{title:A,activity_id:j,start_time:B,end_time:y,status:l,image:C,close_image:D,url:E,is_show:d},jcode_top:{title:"码上掘金编程挑战赛",activity_id:j,start_time:1670846400,end_time:1671983999,status:l,image:u,close_image:u,url:"https:\u002F\u002Fjuejin.cn\u002Fchallenge?utm_source=code_nav",is_show:d},offer:{title:e,activity_id:"2020",start_time:1617638400,end_time:1618934400,status:l,image:"https:\u002F\u002Fp9-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002F2879410508de459c91ae8b7509ca75f8~tplv-k3u1fbpfcp-zoom-1.image",close_image:"https:\u002F\u002Fp9-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002Fa38d640009e14c87a7d29cd95dee27dd~tplv-k3u1fbpfcp-zoom-1.image",url:"https:\u002F\u002Fjuejin-activity.bytedance.net\u002Frank",is_show:d}}}},header:{leadStep:d,isPopupZlink:a},tcc:{tccConfig:c},route:{name:"column",path:v,hash:e,query:{},params:{id:w},fullPath:v,meta:{},from:{name:c,path:F,hash:e,query:{},params:{},fullPath:F,meta:{}}}},serverRendered:b,routePath:v,config:{API_HOST:"api.juejin.cn",CAPTCHA_HOST:"verify.snssdk.com",PLATFORM_APPID:{wechat:1277,weibo:1276,github:1045,wechatApp:1070},SCM_VERSION:"1.0.0.6544",http:{}},globalRefs:{}}}(false,true,null,0,"","0",1,20,"topic","2022","recommended",2,"hot","newest","following","popular",{},"掘金会员",1673020800,1680278400,"https:\u002F\u002Fp6-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002F759e2aa805c0461b840e0f0f09ed05fa~tplv-k3u1fbpfcp-zoom-1.image?","\u002Fpost\u002F6844904119723884551","6844904119723884551",100,1675612800,"https:\u002F\u002Fp3-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002F7482b3ad2cd14edda31f05399c2ae759~tplv-k3u1fbpfcp-zoom-1.image","开启我的2022年度报告",1672797600,"https:\u002F\u002Fp1-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002F8a41831fce8b4c838f1807b2c86aea06~tplv-k3u1fbpfcp-zoom-1.image","https:\u002F\u002Fp9-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002Fe5199830276c4a85bc7c8cb8edecd54d~tplv-k3u1fbpfcp-image.image","https:\u002F\u002Fjuejin.cn\u002Freport2022\u002Fmobile?utm_source=search","\u002F"));</script><script src="./iOS内存二三事 - 掘金_files/6ccc1bf.js" defer=""></script><script src="./iOS内存二三事 - 掘金_files/c68ae6a.js" defer=""></script><script src="./iOS内存二三事 - 掘金_files/607e9aa.js" defer=""></script><script src="./iOS内存二三事 - 掘金_files/fe8610f.js" defer=""></script><script src="./iOS内存二三事 - 掘金_files/37aab1f.js" defer=""></script><script src="./iOS内存二三事 - 掘金_files/83d184c.js" defer=""></script><script src="./iOS内存二三事 - 掘金_files/6a0af43.js" defer=""></script><script src="./iOS内存二三事 - 掘金_files/6e787e2.js" defer=""></script>
  

<link href="./iOS内存二三事 - 掘金_files/52.39cb9d6.css" rel="stylesheet" type="text/css"><link href="./iOS内存二三事 - 掘金_files/4.4ebc7e8.css" rel="stylesheet" type="text/css"><link href="./iOS内存二三事 - 掘金_files/default.c3d25dd.css" rel="stylesheet" type="text/css"><div data-v-47b82694="" data-v-1b688d7c="" data-transfer="true" class="collection-list-modal byte-modal v-transfer-dom"><div class="byte-modal__mask" style="z-index: 1000; display: none;"></div><div class="byte-modal__wrapper" style="z-index: 1000; display: none;"><div class="byte-modal__content" style="width: 520px;"><!----><div class="byte-modal__body"></div><!----></div></div></div><div data-v-47b82694="" data-v-fe76cb40="" data-transfer="true" class="collection-list-modal byte-modal v-transfer-dom"><div class="byte-modal__mask" style="z-index: 1001; display: none;"></div><div class="byte-modal__wrapper" style="z-index: 1001; display: none;"><div class="byte-modal__content" style="width: 520px;"><!----><div class="byte-modal__body"></div><!----></div></div></div><link href="./iOS内存二三事 - 掘金_files/198.adcadde.css" rel="stylesheet" type="text/css"><div data-transfer="true" class="risk-modal byte-modal v-transfer-dom" align-center=""><div class="byte-modal__mask" style="z-index: 1002; display: none;"></div><div class="byte-modal__wrapper" style="z-index: 1002; display: none;"><div class="byte-modal__content" style="width: 350px;"><!----><div class="byte-modal__body"><div class="risk-modal-inner"><div class="risk-modal-title">温馨提示</div> <div>当前操作失败，如有疑问，可点击申诉</div> <div class="risk-modal-footer"><button type="button" class="cancel-button risk-button byte-btn byte-btn--default byte-btn--large"><!----><!----><span><span>前往申诉</span></span></button> <button type="button" class="risk-button byte-btn byte-btn--primary byte-btn--large"><!----><!----><span><span>我知道了</span></span></button></div></div></div><!----></div></div></div><link href="./iOS内存二三事 - 掘金_files/139.9ccface.css" rel="stylesheet" type="text/css"><link href="./iOS内存二三事 - 掘金_files/181.1b801b1.css" rel="stylesheet" type="text/css"><link href="./iOS内存二三事 - 掘金_files/192.1dc0908.css" rel="stylesheet" type="text/css"><link href="./iOS内存二三事 - 掘金_files/158.cb7fed2.css" rel="stylesheet" type="text/css"><div data-v-41eefe39="" data-transfer="true" class="lead byte-modal v-transfer-dom"><div class="byte-modal__mask" style="z-index: 1003; display: none;"></div><div class="byte-modal__wrapper" style="z-index: 1003; display: none;"><div class="byte-modal__content" style="width: 500px;"><div class="byte-modal__header"><img data-v-41eefe39="" src="./iOS内存二三事 - 掘金_files/MaskGroup.13dfc4f.png" alt="" loading="lazy" class="header-bgc"> <span data-v-41eefe39="" class="header-title">选择你感兴趣的技术方向</span><span aria-label="Close" class="byte-modal__headerbtn"><i class="byte-icon byte-icon--close"><svg t="1561638608887" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="441911" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M512 448l288-288c6.4-6.4 19.2-6.4 32 0l25.6 32c6.4 6.4 6.4 19.2 0 32L569.6 505.6l288 288c6.4 6.4 6.4 19.2 0 32l-32 32c-6.4 6.4-19.2 6.4-32 0L512 569.6l-288 288c-6.4 6.4-19.2 6.4-32 0l-32-32c-6.4-6.4-6.4-19.2 0-32L448 505.6 160 224c-6.4-12.8-6.4-25.6 0-32l32-32c6.4-6.4 19.2-6.4 32 0L512 448z" p-id="441912"></path><path d="M512 448l288-288c6.4-6.4 19.2-6.4 32 0l25.6 32c6.4 6.4 6.4 19.2 0 32L569.6 505.6l288 288c6.4 6.4 6.4 19.2 0 32l-32 32c-6.4 6.4-19.2 6.4-32 0L512 569.6l-288 288c-6.4 6.4-19.2 6.4-32 0l-32-32c-6.4-6.4-6.4-19.2 0-32L448 505.6 160 224c-6.4-12.8-6.4-25.6 0-32l32-32c6.4-6.4 19.2-6.4 32 0L512 448z" p-id="441913"></path></svg></i></span></div><div class="byte-modal__body"> <div data-v-41eefe39="" class="classify-box"><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><path data-v-41eefe39="" id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M2 2.5C1.44772 2.5 1 2.94772 1 3.5V11.5C1 12.0523 1.44772 12.5 2 12.5H14C14.5523 12.5 15 12.0523 15 11.5V3.5C15 2.94772 14.5523 2.5 14 2.5H2ZM4.5 7.5C4.22386 7.5 4 7.72386 4 8V10C4 10.2761 4.22386 10.5 4.5 10.5H5C5.27614 10.5 5.5 10.2761 5.5 10V8C5.5 7.72386 5.27614 7.5 5 7.5H4.5ZM7 5.5C7 5.22386 7.22386 5 7.5 5H8C8.27614 5 8.5 5.22386 8.5 5.5V10C8.5 10.2761 8.27614 10.5 8 10.5H7.5C7.22386 10.5 7 10.2761 7 10V5.5ZM10.5 6.5C10.2239 6.5 10 6.72386 10 7V10C10 10.2761 10.2239 10.5 10.5 10.5H11C11.2761 10.5 11.5 10.2761 11.5 10V7C11.5 6.72386 11.2761 6.5 11 6.5H10.5Z" fill="#86909C"></path><rect data-v-41eefe39="" id="Rectangle 282" x="3" y="13.5" width="10" height="1.3" rx="0.5" fill="#86909C"></rect></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              后端
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><path data-v-41eefe39="" id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M2 2.5C1.44772 2.5 1 2.94772 1 3.5V6.5H15V3.5C15 2.94772 14.5523 2.5 14 2.5H2ZM15 7.8H1V13.5C1 14.0523 1.44772 14.5 2 14.5H14C14.5523 14.5 15 14.0523 15 13.5V7.8ZM8.65811 8.52566C8.92009 8.61298 9.06167 8.89614 8.97434 9.15811L7.97434 12.1581C7.88702 12.4201 7.60386 12.5617 7.34189 12.4743C7.07991 12.387 6.93833 12.1039 7.02566 11.8419L8.02566 8.84189C8.11298 8.57991 8.39614 8.43833 8.65811 8.52566ZM3.5 5.5C3.77614 5.5 4 5.27614 4 5C4 4.72386 3.77614 4.5 3.5 4.5C3.22386 4.5 3 4.72386 3 5C3 5.27614 3.22386 5.5 3.5 5.5ZM5.5 5C5.5 5.27614 5.27614 5.5 5 5.5C4.72386 5.5 4.5 5.27614 4.5 5C4.5 4.72386 4.72386 4.5 5 4.5C5.27614 4.5 5.5 4.72386 5.5 5ZM6.5 5.5C6.77614 5.5 7 5.27614 7 5C7 4.72386 6.77614 4.5 6.5 4.5C6.22386 4.5 6 4.72386 6 5C6 5.27614 6.22386 5.5 6.5 5.5ZM6.44721 9.27639C6.57071 9.52338 6.4706 9.82372 6.22361 9.94721L5.11803 10.5L6.22361 11.0528C6.4706 11.1763 6.57071 11.4766 6.44721 11.7236C6.32372 11.9706 6.02338 12.0707 5.77639 11.9472L3.77639 10.9472C3.607 10.8625 3.5 10.6894 3.5 10.5C3.5 10.3106 3.607 10.1375 3.77639 10.0528L5.77639 9.05279C6.02338 8.92929 6.32372 9.0294 6.44721 9.27639ZM9.77639 9.94721C9.5294 9.82372 9.42929 9.52338 9.55279 9.27639C9.67628 9.0294 9.97662 8.92929 10.2236 9.05279L12.2236 10.0528C12.393 10.1375 12.5 10.3106 12.5 10.5C12.5 10.6894 12.393 10.8625 12.2236 10.9472L10.2236 11.9472C9.97662 12.0707 9.67628 11.9706 9.55279 11.7236C9.42929 11.4766 9.5294 11.1763 9.77639 11.0528L10.882 10.5L9.77639 9.94721Z" fill="#86909C"></path></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              前端
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><rect data-v-41eefe39="" id="Rectangle 287" x="5.7002" y="12.5" width="1.3" height="3" rx="0.5" fill="#86909C"></rect><rect data-v-41eefe39="" id="Rectangle 289" x="1" y="6.5" width="1.3" height="6" rx="0.5" fill="#86909C"></rect><rect data-v-41eefe39="" id="Rectangle 290" x="13.7002" y="6.5" width="1.3" height="6" rx="0.5" fill="#86909C"></rect><rect data-v-41eefe39="" id="Rectangle 288" x="9" y="12.5" width="1.3" height="3" rx="0.5" fill="#86909C"></rect><path data-v-41eefe39="" id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M13 5.86364V12.5C13 13.0523 12.5523 13.5 12 13.5H4C3.44772 13.5 3 13.0523 3 12.5V5.86364V5.77273C3 5.74067 3.00151 5.70897 3.00446 5.67768C3.11608 3.35397 5.30996 1.5 8 1.5C10.69 1.5 12.8839 3.35397 12.9955 5.67768C12.9985 5.70897 13 5.74067 13 5.77273V5.86364ZM7 6.25C7 6.66421 6.66421 7 6.25 7C5.83579 7 5.5 6.66421 5.5 6.25C5.5 5.83579 5.83579 5.5 6.25 5.5C6.66421 5.5 7 5.83579 7 6.25ZM9.75 7C10.1642 7 10.5 6.66421 10.5 6.25C10.5 5.83579 10.1642 5.5 9.75 5.5C9.33579 5.5 9 5.83579 9 6.25C9 6.66421 9.33579 7 9.75 7Z" fill="#86909C"></path></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              Android
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39=""><g data-v-41eefe39="" id="pingguo-2 1"><path data-v-41eefe39="" id="Vector" d="M11.821 8.9388C11.8035 7.16562 13.267 6.31556 13.3322 6.27312C12.5097 5.06956 11.2287 4.90506 10.7724 4.88581C9.6821 4.77556 8.64523 5.52763 8.09179 5.52763C7.5401 5.52763 6.6861 4.902 5.78179 4.91863C4.59354 4.93613 3.49761 5.60944 2.88598 6.67387C1.65136 8.8163 2.56967 11.9899 3.77323 13.7277C4.36123 14.5782 5.06254 15.5332 5.98304 15.4991C6.86942 15.4637 7.20498 14.9255 8.27642 14.9255C9.34785 14.9255 9.64929 15.4991 10.5877 15.4816C11.5415 15.4637 12.1461 14.6149 12.7302 13.7618C13.4052 12.7752 13.6835 11.8197 13.6997 11.7707C13.6787 11.7611 11.8394 11.0567 11.821 8.9388ZM10.0584 3.73563C10.547 3.14281 10.8769 2.32031 10.7868 1.5C10.0829 1.52888 9.22973 1.969 8.72485 2.56006C8.2716 3.08463 7.87523 3.922 7.98154 4.72613C8.76729 4.78737 9.56923 4.32669 10.0584 3.73563Z" fill="#86909C"></path></g></g><defs data-v-41eefe39=""></defs></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              iOS
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><rect data-v-41eefe39="" id="Rectangle 289" x="1" y="8.5" width="1.3" height="5" rx="0.5" fill="#86909C"></rect><rect data-v-41eefe39="" id="Rectangle 292" x="14" y="8.5" width="1.3" height="5" rx="0.5" fill="#86909C"></rect><rect data-v-41eefe39="" id="Rectangle 293" x="7.5" y="4.5" width="1" height="3" rx="0.5" fill="#86909C"></rect><circle data-v-41eefe39="" id="Ellipse 25" cx="8" cy="2.5" r="1" fill="#86909C"></circle><path data-v-41eefe39="" id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M3 7.5C3 6.94772 3.44772 6.5 4 6.5H12C12.5523 6.5 13 6.94772 13 7.5V14.5C13 15.0523 12.5523 15.5 12 15.5H4C3.44772 15.5 3 15.0523 3 14.5V7.5ZM7 11.25C7 11.6642 6.66421 12 6.25 12C5.83579 12 5.5 11.6642 5.5 11.25C5.5 10.8358 5.83579 10.5 6.25 10.5C6.66421 10.5 7 10.8358 7 11.25ZM9.75 12C10.1642 12 10.5 11.6642 10.5 11.25C10.5 10.8358 10.1642 10.5 9.75 10.5C9.33579 10.5 9 10.8358 9 11.25C9 11.6642 9.33579 12 9.75 12Z" fill="#86909C"></path></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              人工智能
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><g data-v-41eefe39="" id="kaifagongjuicon-hui 1"><path data-v-41eefe39="" id="Vector" d="M14.212 5.04986L13.497 5.76886C13.3158 5.95088 13.1005 6.09531 12.8633 6.19386C12.6261 6.29242 12.3718 6.34315 12.115 6.34315C11.8582 6.34315 11.6039 6.29242 11.3667 6.19386C11.1295 6.09531 10.9142 5.95088 10.733 5.76886C10.3664 5.39915 10.1606 4.89955 10.1606 4.37886C10.1606 3.85817 10.3664 3.35857 10.733 2.98886L11.448 2.26986C11.843 1.87286 11.579 1.40486 10.868 1.51686C10.028 1.64786 9.262 2.07586 8.709 2.72286C8.005 3.41786 7.682 4.66486 7.922 5.81786L1.927 11.8469C1.56096 12.2165 1.35562 12.7157 1.35562 13.2359C1.35562 13.7561 1.56096 14.2552 1.927 14.6249C2.10804 14.807 2.32329 14.9515 2.56038 15.0501C2.79747 15.1487 3.05172 15.1995 3.3085 15.1995C3.56528 15.1995 3.81953 15.1487 4.05662 15.0501C4.29371 14.9515 4.50896 14.807 4.69 14.6249L10.686 8.59486C11.2693 8.7189 11.8745 8.69473 12.446 8.52459C13.0176 8.35444 13.5375 8.04373 13.958 7.62086C14.5581 7.01861 14.9243 6.22244 14.991 5.37486C15.071 4.91886 14.607 4.65286 14.212 5.04986ZM3.768 13.6979C3.67659 13.7885 3.56041 13.85 3.4341 13.8747C3.30779 13.8994 3.17699 13.8861 3.05819 13.8366C2.93939 13.7871 2.8379 13.7036 2.76651 13.5965C2.69511 13.4894 2.65701 13.3636 2.657 13.2349C2.65647 13.0618 2.72462 12.8957 2.84649 12.7729C2.96836 12.6501 3.13399 12.5807 3.307 12.5799C3.487 12.5799 3.651 12.6529 3.768 12.7719C3.888 12.8889 3.96 13.0539 3.96 13.2349C3.9604 13.3209 3.94363 13.4062 3.91066 13.4857C3.87769 13.5652 3.82919 13.6373 3.768 13.6979ZM3.118 5.16786L5.377 7.43986L6.297 6.51286L4.04 4.24286L3.535 3.27086L1.92 2.11186L1 3.03986L2.151 4.66086L3.118 5.16786ZM10.672 9.98586C10.642 9.95526 10.6062 9.93095 10.5667 9.91436C10.5272 9.89776 10.4848 9.88921 10.442 9.88921C10.3992 9.88921 10.3568 9.89776 10.3173 9.91436C10.2778 9.93095 10.242 9.95526 10.212 9.98586L8.83 11.3759C8.79955 11.4062 8.7754 11.4423 8.75891 11.482C8.74243 11.5218 8.73395 11.5644 8.73395 11.6074C8.73395 11.6504 8.74243 11.693 8.75891 11.7327C8.7754 11.7724 8.79955 11.8085 8.83 11.8389L12.09 15.1169C12.2106 15.2383 12.3541 15.3348 12.5122 15.4006C12.6703 15.4663 12.8398 15.5002 13.011 15.5002C13.1822 15.5002 13.3517 15.4663 13.5098 15.4006C13.6679 15.3348 13.8114 15.2383 13.932 15.1169C14.442 14.6049 14.442 13.7769 13.932 13.2639L10.672 9.98586Z" fill="#86909C"></path></g></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              开发工具
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><path data-v-41eefe39="" id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M1 2.5C1 1.94772 1.44772 1.5 2 1.5H14C14.5523 1.5 15 1.94772 15 2.5V14.5C15 15.0523 14.5523 15.5 14 15.5H2C1.44772 15.5 1 15.0523 1 14.5V2.5ZM3 5C3 4.72386 3.22386 4.5 3.5 4.5H12.5C12.7761 4.5 13 4.72386 13 5V5.3C13 5.57614 12.7761 5.8 12.5 5.8H3.5C3.22386 5.8 3 5.57614 3 5.3V5ZM3.5 7.5C3.22386 7.5 3 7.72386 3 8V8.3C3 8.57614 3.22386 8.8 3.5 8.8H4.5C4.77614 8.8 5 8.57614 5 8.3V8C5 7.72386 4.77614 7.5 4.5 7.5H3.5ZM7 8C7 7.72386 7.22386 7.5 7.5 7.5H8.5C8.77614 7.5 9 7.72386 9 8V8.3C9 8.57614 8.77614 8.8 8.5 8.8H7.5C7.22386 8.8 7 8.57614 7 8.3V8ZM11.5 7.5C11.2239 7.5 11 7.72386 11 8V8.3C11 8.57614 11.2239 8.8 11.5 8.8H12.5C12.7761 8.8 13 8.57614 13 8.3V8C13 7.72386 12.7761 7.5 12.5 7.5H11.5ZM3 11C3 10.7239 3.22386 10.5 3.5 10.5H7.5C7.77614 10.5 8 10.7239 8 11V11.3C8 11.5761 7.77614 11.8 7.5 11.8H3.5C3.22386 11.8 3 11.5761 3 11.3V11ZM10.5 10.5C10.2239 10.5 10 10.7239 10 11V11.3C10 11.5761 10.2239 11.8 10.5 11.8H12.5C12.7761 11.8 13 11.5761 13 11.3V11C13 10.7239 12.7761 10.5 12.5 10.5H10.5Z" fill="#86909C"></path></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              代码人生
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><path data-v-41eefe39="" id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M14.9187 7.03385C15.0999 7.26744 14.9466 7.7 14.651 7.7H6.32905V4.5H5.02905V7.7H3.6C2.16406 7.7 1 6.53594 1 5.1C1 3.66406 2.16406 2.5 3.6 2.5H14.651C14.9466 2.5 15.0999 2.93257 14.9188 3.16616C14.5064 3.69779 14.2602 4.36959 14.2602 5.10001C14.2602 5.83043 14.5064 6.50222 14.9187 7.03385Z" fill="#86909C"></path><path data-v-41eefe39="" id="Subtract_2" fill-rule="evenodd" clip-rule="evenodd" d="M1.34902 14.5008C1.0534 14.5008 0.900077 14.0682 1.08126 13.8346C1.49363 13.303 1.7398 12.6312 1.7398 11.9008C1.7398 11.1704 1.49362 10.4986 1.08125 9.96694C0.900064 9.73335 1.05339 9.30078 1.34901 9.30078H12.4C13.8359 9.30078 15 10.4648 15 11.9008C15 13.3367 13.8359 14.5008 12.4 14.5008H1.34902Z" fill="#86909C"></path></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              阅读
            </span></div></div></div></div> <!----></div><div class="byte-modal__footer"><div data-v-41eefe39="" class="left">跳过</div> <div data-v-41eefe39="" class="mid" style="display: none;">上一步</div> <div data-v-41eefe39="" class="right">
      至少选择1个分类
    </div></div></div></div></div><div data-v-8bb78912="" data-transfer="true" class="upgrade-new-modal byte-modal v-transfer-dom"><div class="byte-modal__mask" style="z-index: 1004; display: none;"></div><div class="byte-modal__wrapper" style="z-index: 1004; display: none;"><div class="byte-modal__content" style="width: 311px;"><div class="byte-modal__header"><span class="byte-modal__title"></span><!----></div><div class="byte-modal__body"> <!----> <div data-v-8bb78912="" class="close-icon"><img data-v-8bb78912="" src="./iOS内存二三事 - 掘金_files/8867e249c23a7c0ea596c139befc04d7.svg" alt=""></div></div><!----></div></div></div><link href="./iOS内存二三事 - 掘金_files/100.b5554a0.css" rel="stylesheet" type="text/css"><div class="byte-tooltip byte-tooltip--dark" style="display: none; position: absolute; max-width: none; will-change: transform; z-index: 1005; top: 0px; left: 0px; transform: translate3d(87px, 725px, 0px);" x-placement="top">
        沉浸阅读
      <div x-arrow="" class="popper__arrow" style="left: 0px;"></div></div><link href="./iOS内存二三事 - 掘金_files/155.cc4a86e.css" rel="stylesheet" type="text/css"><link href="./iOS内存二三事 - 掘金_files/9.b3ecb8a.css" rel="stylesheet" type="text/css"><link href="./iOS内存二三事 - 掘金_files/88.9843b4c.css" rel="stylesheet" type="text/css"></body><grammarly-desktop-integration data-grammarly-shadow-root="true"></grammarly-desktop-integration></html>